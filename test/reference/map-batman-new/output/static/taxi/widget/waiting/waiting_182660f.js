define("taxi:widget/waiting/waiting.js",function(t,e,i){"use strict";var a=t("taxi:static/js/storage.js"),n=t("common:widget/stat/stat.js"),o=t("taxi:widget/common/radar/radar.js"),e={create:function(){var t=$(".taxi-widget-waiting"),e=t.find(".taxi-info .count"),i=this.options;e.text(i.taxi_num),this.$el=t},countDown:function(){var t,e,i,n=this,o=this.options,s=Math.min(parseInt(o.limit,10),parseInt(o.taxi_num,10)),r=this.$el,d=r.find(".pushed-car .count"),u=r.find(".second"),h=parseInt(a.get("orderStartTime"),10),c=function(){t=parseInt(d.text(),10),e=parseInt(u.text(),10),t=Math.min(t+2,s),e-=1,d.text(t),u.text(e),0>=e?(n.destroy(),LoadManager.loadPage("resubmit",o)):n.timeout.push(setTimeout(c,1e3))};"number"!=typeof h||isNaN(h)||(i=120-Math.ceil((Date.now()-h)/1e3),0>i?(this.destroy(),LoadManager.loadPage("resubmit",o)):u.text(i)),this.timeout.push(setTimeout(c,1e3))},getCarReply:function(){var t,e=this,i=this.options,a=i.order_id;t=setInterval(function(){LoadManager.request({data:{qt:"driverreply",order_id:a},success:function(i){i.info&&(clearInterval(t),t=null,e.destroy(),LoadManager.loadPage("response",i.info),n.addStat(STAT_CODE.TAXI_DRIVERREPLY))}})},5e3),this.interval.push(t)},destroy:function(){var t,e,i=this.interval,a=this.timeout;for(t=0,e=i.length;e>t;t++)clearInterval(i[t]);for(t=0,e=a.length;e>t;t++)clearTimeout(a[t]);o.destroy()},init:function(){var t=this.options=LoadManager.getPageOptions();t||(this.destroy(),LoadManager.loadPage("home")),this.timeout=[],this.interval=[],this.create(),this.countDown(),this.getCarReply()}};i.exports=e});