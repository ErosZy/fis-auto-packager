!function(e,t,a){"use strict";var i=require("taxi:widget/common/popup/popup.js"),r=require("common:static/js/util.js"),s=require("taxi:static/js/storage.js"),o={pageControllerMap:{home:require("taxi:widget/home/home.js"),waiting:require("taxi:widget/waiting/waiting.js"),resubmit:require("taxi:widget/resubmit/resubmit.js"),response:require("taxi:widget/response/response.js"),verify:require("taxi:widget/verify/verify.js"),settings:require("taxi:widget/settings/settings.js"),about:require("taxi:widget/about/about.js"),"vip/home":require("taxi:widget/vip/home/home.js"),"vip/verify":require("taxi:widget/vip/verify/verify.js"),"vip/orderlist":require("taxi:widget/vip/orderlist/orderlist.js")},getPageOptions:function(e){var t=r.urlToJSON(s.get("pageOptions"));return e?t[e]:t},setPageOptions:function(e,t){var a;"string"==typeof e?(a=this.getPageOptions(),a[e]=t,this.setPageOptions(a)):"object"==typeof e&&s.set("pageOptions",r.jsonToQuery(e))},request:function(e){$.ajax({type:"POST",dataType:"json",url:"/mobile/webapp/taxi/api/"+r.jsonToQuery($.extend({},e.data,{api:2,os:"webapp"})),success:function(t){t&&0===t.errno?e.success&&$.isFunction(e.success)&&e.success(t):e.error&&$.isFunction(e.error)&&(t?e.error(t):i.open({text:"网络数据异常！"}))},error:function(t){$.isFunction(e.error)&&t&&t.errno>0&&e.error()},complete:e.complete})},loadPage:function(e,a){var o,n,g,u=this,p=$("#wrapper");e=e||u.getPageState("lastPage")||"home",a&&("object"==typeof a&&(a=r.jsonToQuery(a)),s.set("pageOptions",a)),o="taxi-pagelet-"+this.slash2dash(e),t.asyncLoad({id:o},a,function(){i.close(),$("<div/>").attr({id:o}).appendTo(p.html("")),u.getPageState("lastPage")!==e&&(n=u.getPageState("lastPage"),g=u.pageControllerMap[n],g&&g.destroy&&$.isFunction(g.destroy)&&g.destroy(),u.setPageState("lastPage",e))})},route:function(){var e,t=this;e=s.get("orderId"),e?this.request({data:{qt:"orderstatus",order_id:e},success:function(e){var a=e.info&&e.info.status;switch(a){case-1:t.loadPage("resubmit");break;case 2:t.loadPage("response");break;case 1:t.loadPage("waiting");break;case 3:case-2:case 3:case 4:s.remove("pageState"),t.loadPage("home");break;default:s.remove("pageState"),t.loadPage("home")}t.setPageState("status",a),t.setPageState("existTime",e.info.exist_time)},error:function(){s.remove("pageState"),t.loadPage("home")}}):this.loadPage(this.getPageState("lastPage"))},routeThird:function(){s.get("thirdPhone")?this.loadPage(this.getPageState("lastPage")||"vip/home"):this.loadPage("vip/verify")},getPageState:function(e){var t=r.urlToJSON(s.get("pageState"));return t&&t[e]},setPageState:function(e,t){var a=r.urlToJSON(s.get("pageState"));a[e]=t,s.set("pageState",r.jsonToQuery(a))},removePageState:function(e){this.setPageState(e,a)},slash2dash:function(e){return e.replace("/","-")},init:function(e){return 0!==s.set("baiduTaxiLocalStorageTest",1)?(i.open({text:"检测到您的浏览器不支持缓存，您可能开启了无痕浏览模式，将无法使用本产品功能，请关闭后再试。",layer:!0,autoCloseTime:0}),!1):(i.open({text:"正在加载...",layer:!0,autoCloseTime:0}),s.remove("baiduTaxiLocalStorageTest"),e&&"vip"===e.version?this.routeThird():this.route(),void 0)}};e.LoadManager=o}(window,TaxiBigPipe);