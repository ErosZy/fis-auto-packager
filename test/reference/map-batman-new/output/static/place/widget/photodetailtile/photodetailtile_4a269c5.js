define("place:widget/photodetailtile/photodetailtile.js",function(i,t,e){var r=i("common:widget/url/url.js");e.exports={config:{iService:"",iServiceTpl:"height=$h$&width=$w$&quality=70&src=$src$",iThreshold:12},imgItemTpl:'<div class="tile-arena-item" style="width:$w$px;height:$h$px"><img data-idx="$i$" src="$url$" alt="加载中……"/></div>',$el:null,tile:null,photos:null,end:0,init:function(i){"use strict";var t=this;t.end=0,t.$el=$("#phototile"),t.tile=t.$el.find(".tile-arena"),t.showFooter=t.$el.find(".tile-footer"),t.showBtn=t.showFooter.find("a"),t.photos=i.photos,t.config.iService=i.thumbnailURL+t.config.iServiceTpl,t.bindEvent(),t.displayTile()},displayTile:function(){"use strict";for(var i=this,t=i.end,e=i.end+i.config.iThreshold>=i.photos.length,r=e?i.photos.length:i.end+i.config.iThreshold,n=[],o=i._getDim(),l=i.config.iService.replace("$h$",o.tHeight).replace("$w$",o.tWidth);r>t;t++){var h=l.replace("$src$",encodeURIComponent(i.photos[t].imgUrl));n.push(i.imgItemTpl.replace("$i$",t).replace("$url$",h).replace("$h$",o.tHeight).replace("$w$",o.tWidth))}var s=$(n.join(""));$("#photos-detail .place-loading").remove(),i.tile.append(s),i.initImgLoading(s),e?i.showFooter.hide():i.showFooter.show(),i.end=r},bindEvent:function(){"use strict";var i=this;return i.$el.on("click",i._clickEl=$.proxy(i.clickHandler,i)),$(window).on("resize orientationchange",i._resizeFun=$.proxy(i.resize,i)),this},unbindEvent:function(){"use strict";var i=this;return i._clickEl&&(i.$el.off("click",i._clickEl)||(i._clickEl=null)),i._resizeFun&&($(window).off("resize orientationchange",i._resizeFun)||(i._resizeFun=null)),this},clickHandler:function(i){"use strict";var t=this,e=$(i.target);"photo-tile-more-imgs"===e.attr("id")?t.displayTile():"tile-arena-item"===e.parent().attr("class")&&t.displayImgSlider(e)},getClientSize:function(){"use strict";var i=window;return{width:i.innerWidth,height:i.innerHeight}},_getDim:function(){"use strict";var i=this.getClientSize(),t=(i.width-46)/3,e=.75*t,r=.9*i.width,n=.9*(i.height-51-40),o=i.height-51;return{pHeight:o,tWidth:Math.floor(t),tHeight:Math.floor(e),sWidth:Math.floor(r),sHeight:Math.floor(n),cs:i}},resize:function(){"use strict";var i=this,t=i._getDim();return i.$el.find(".tile-arena-item").css({width:t.tWidth,height:t.tHeight}),i},displayImgSlider:function(i){"use strict";var t=i.data("idx"),e=r.get();e.pageState.detail_part="photoslider",e.pageState.idx=t,r.update(e)},initImgLoading:function(i){"use strict";i.find("img").on("error",$.proxy(this._handleImgError,this))},_handleImgError:function(i){"use strict";$(i.currentTarget).attr("src","/widget/photodetailtile/images/no_img.png")}}});