define("common:widget/stat/metrics-stat.js",function(n,t,e){function r(n,t){if(!n)return!1;f(n,N.suspend,1);var e={};if(e.type="ms0",e.target=n,e.ts=Date.now(),g[n]=e,t){var r=t.expire;r>0&&i(n,r);var u=t.callback;u&&u instanceof Function&&(b[n]=u)}return!0}function i(n,t){x[n]=setTimeout(function(){s(n)},1e3*t)}function u(n,t,e,r){if(!n||!t)return!1;e||(e=1);var i=g[n];if(!i)return!1;if($.isPlainObject(e)){for(var u in e){var o=t+"_"+u;i[o]=e[u]}i[t]=a(i[t],1,r)}else i[t]=a(i[t],e,r);return!0}function a(n,t,e){return e?isNaN(n)?t:isNaN(t)?t:n+t:t}function o(n){return f(n,N.success,1)}function s(n){return f(n,N.expire,1)}function c(){if(!p(g))for(var n in g)f(n,N.suspend,1)}function f(n,t,e){if(!n)return!1;var r=g[n];if(!r)return!1;r.status=t;var i=v(T,r);l(i,e),r.url=i,delete g[n];var u=x[n];u&&(delete x[n],clearTimeout(u));var a=b[n];return a&&a instanceof Function&&(d(a,r,50),delete b[n]),!0}function d(n,t,e){setTimeout(function(){n(t)},e)}function v(n,t){var e=n.split("?"),r=e[0],i=e[1];i?i+="&":i="",i+=$.param(t);var u=r+"?"+i;return u}function l(n){(new Image).src=n}function p(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function m(n){return n?g[n]:void 0}function w(n,t){var e={t:Date.now(),code:n};$.extend(e,t);var r=v(T,e);l(r,1)}var g={},b={},x={},N={success:0,expire:1,suspend:2},T="/mobile/img/transparent.gif?newmap=1";$.each(["blur","pagehide","beforeunload","unload"],function(n,t){var e="on"+t;void 0!==window[e]&&$(window).bind(t,c)}),e.exports={start:r,addStat:u,submit:o,getTarget:m,sendOldStat:w}});