define("index:widget/historycity/historycity.js",function(t,i,n){"use strict";var e=t("common:widget/setcity/setcity.js");n.exports={init:function(){this.render(),this.bind()},render:function(){var t=$(".history-content"),i=this._localStorage();if(void 0!==i&&""!==i){$(".index-widget-historycity").show(),i=i.split(encodeURIComponent(","));for(var n=$('<ul class="historycity-list"></ul>'),e=0;e<i.length;e++){var o=i[e].split("-"),a=o[0],c=o[1],r=o[2],l=$('<span class="historycity-item"></span>');l.attr("data-cityid",c),l.attr("data-city",a),l.attr("data-cityeng",r);var s=$("<li ></li>");if(l.html(a),s.append(l),n.append(s),e==i.length-1){var d=$("<br style='clear:both'>");n.append(d)}}t.append(n)}},bind:function(){var t=this;$(".index-widget-allcity"),$(".historycity-item").on("click",t._onClickCity),$(".history-clean").on("click",$.proxy(this._onCleanHistory,this))},_onCleanHistory:function(){this._localStorage(null),$(".index-widget-historycity").hide()},_onClickCity:function(t){var i=$(t.target),n=$.trim(i.data("city")),o=i.data("cityid"),a=i.data("cityeng");e.setAndRedirect(n,o,a)},_localStorage:function(t){var i,n,e,o,a="historyCity";try{if(null===t)window.localStorage[a]="";else if(void 0!==t){n=window.localStorage[a],e=n?n.split(encodeURIComponent(",")):[];var c=t.cityName+"-"+t.cityId+"-"+t.cityeng;~$.inArray(c,e)&&(o=e.indexOf(c),e.splice(o,1)),e.unshift(c),e.length>5&&e.splice(5,1),window.localStorage[a]=e.join(encodeURIComponent(","))}i=window.localStorage[a]}catch(r){}return i}}});