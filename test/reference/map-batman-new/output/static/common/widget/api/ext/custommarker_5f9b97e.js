define("common:widget/api/ext/custommarker.js",function(t,i,o){function n(t,i,o){this._point=i,this._icon=t,this._div=null,this._container=null,this.drawCount=0,this.draggable=!1,this._config={click:null,isAnimation:!1},this.setConfig(o)}var e=(t("common:static/js/util.js"),t("common:widget/api/api.js"));n.prototype=new e.Overlay,n.prototype.setConfig=function(t){t=t||{};for(var i in t)this._config[i]=t[i]},n.prototype.initialize=function(t){var i=this;i._map=t,i._div=i.getDiv();var o=i._container=$(i._div);return o.on("touchend",function(t){void 0==i._config.notstop&&(window.dtCon0&&dtCon0.isOn||"function"==typeof i._config.click&&i._config.click(),t.stopPropagation())}),o.on("touchstart",function(t){if(t.stopPropagation(),t.preventDefault(),i._ontouch(t),i.draggable){var n=function(t){i._map.disableDragging(),i._ontouch(t)};o.on("touchmove",n),o.on("touchend",function(t){i._map.enableDragging(),i._ontouch(t),o.off("touchmove",n)})}}),o.on("click",function(t){t.stopPropagation()}),t.getPanes().labelPane.appendChild(this._div),i._div},n.prototype._ontouch=function(){var t,i={},o=function(t){for(var i=[],o=null,n=0,e=t.touches.length;e>n;n++)o=t.touches[n],i.push({x:o.pageX,y:o.pageY});return i},n={},e={},a=null,s=[];return function(r){function c(){return a?(setTimeout(c,30),void 0):(p._map.centerAndZoom(p._point,p._map.getZoom()),p.dispatchEvent("dragend"),void 0)}if(!this.draggable)return!1;var p=this;switch(r.preventDefault(),r.stopPropagation(),r.type){case"touchstart":i.start=o(r),n=p._map.pointToOverlayPixel(p._point),p.dispatchEvent("dragstart");break;case"touchmove":i.move=o(r);var h=i.move[0].x-i.start[0].x,g=i.move[0].y-i.start[0].y;e.x=n.x+h,e.y=n.y+g,s.push(e),a||(a=setInterval(function(){var i=s.shift();return i?(t=p._map.overlayPixelToPoint({x:i.x,y:i.y}),p.setPoint(t),p.dispatchEvent("draging"),void 0):(clearInterval(a),a=null,void 0)},25));break;case"touchend":c()}}}(),n.prototype.draw=function(){var t=this;t._draw()},n.prototype._draw=function(){var t=this,i=t._map,o=t._icon.anchor,n=i.pointToOverlayPixel(t._point),e=t._div.style;e.left=n.x-o.width+"px",e.top=n.y-o.height+"px",navigator.userAgent.indexOf("iPhone OS 5_")>-1&&(e.WebkitBackfaceVisibility="hidden"),t._config&&t._config.className&&""!=t._config.className&&t._container.addClass(t._config.className)},n.prototype.setIcon=function(t){var i=this._icon=t;$.extend(this._div.style,{position:"absolute",height:i.size.height+"px",width:i.size.width+"px",backgroundImage:"url("+i.imageUrl+")",backgroundRepeat:"no-repeat",backgroundPosition:0-i.imageOffset.width+"px "+(0-i.imageOffset.height)+"px"}),this.draw()},n.prototype.setClassName=function(t){this._container.removeClass(this._config.className),this._config.className=t,this._container.addClass(this._config.className)},n.prototype.getDiv=function(){var t=this._icon,i=document.createElement("div");return $.extend(i.style,{position:"absolute",height:t.size.height+"px",width:t.size.width+"px",backgroundImage:"url("+t.imageUrl+")",backgroundRepeat:"no-repeat",zIndex:"200",backgroundPosition:0-t.imageOffset.width+"px "+(0-t.imageOffset.height)+"px"}),this._config.isAnimation&&(i.className="mkr_trans"),i},n.prototype.getContainer=function(){return this._div},n.prototype.setPoint=function(t){this._point=t,this.draw()},n.prototype.setDraggingEnabled=function(t){this.draggable=!!t},n.prototype.setZIndex=function(t){this._div.style.zIndex=t},n._className_="CustomMarker",o.exports=n});