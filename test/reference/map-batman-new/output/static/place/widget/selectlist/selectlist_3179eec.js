define("place:widget/selectlist/selectlist.js",function(e,t,n){var a=e("common:widget/geolocation/location.js"),i=e("common:widget/url/url.js"),c=e("common:static/js/util.js"),o=e("common:widget/setcity/setcity.js"),r="_refer_query",d="_refer_pagestate";n.exports.init=function(e){y(e),s()};var l,u="     ",y=function(e){l=e},s=function(){$list=$(".place-widget-selectlist"),$list.on("click","li",p)},p=function(){var e=$(this),t=+e.data("i")-1;m(t)},m=function(e){if("undefined"!=typeof e){var t=l.list[e],n=i.get(),a=n.pageState,c=f(t),u=a.refer_pagestate||window.localStorage.getItem(d),y=a.refer_query||window.localStorage.getItem(r);y&&"undefined"!=y?(_(c,!1),g(t,{referQuery:y,referPageState:u})):(_(c),c.isExactPoi||3===c.addr.cityType?i.toIndex({cache:!1}):o.setAndRedirect(c.addr.city,c.addr.cityCode))}},g=function(e,t){var n,a,o=i.get(),y=t||{},s=(o.pageState||{},c.urlToJSON(y.referQuery)||{}),p=c.urlToJSON(y.referPageState)||{},m="wm"===s.qt||"takeout"===p.search,g=l.city;window.localStorage.removeItem(r),window.localStorage.removeItem(d),s.wd&&s.wd.split(u)[1]&&(s.wd=s.wd.split(u)[1]),s.c=g.code,a=x(),n=m?S(e,s):v(e,s),p=$.extend(p,{center_name:e.name||""}),delete p.i,i.update({module:n.module,action:n.action,query:n.query,pageState:p},{queryReplace:!0,pageStateReplace:!0})},f=function(e){if(e){x(),l.city;var t,n=c.geoToPoint(e.geo),a=w(e);return t={addr:a,isExactPoi:a.isExactPoi,point:{x:n.lng,y:n.lat}}}},_=function(e){e&&(e.isSaveLocInCookie=!0,a.setAddress(e))},w=function(e){var t,n,a=l.city;cityName=a.name,e.cname?(name=e.pcname?e.pcname+e.cname:e.cname,n=!1):(name=e.name,n=!0);var i=null;return 3===e.city_type&&(i=a.up_cityid),t={address:name,city:cityName,cityCode:e.code?e.code:a.code,isExactPoi:n,cityType:e.city_type?e.city_type:a.type,upCityCode:e.pccode?e.pccode:i}},x=function(){return l.type},S=function(e,t){var n,a=x();return 2!=a?(n=c.geoToPoint(e.geo),t.pointX1=n.lng,t.pointY1=n.lat,t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1,t.m="searchXY"):(t.m="searchBrands",delete t.pointX1,delete t.pointY1,delete t.center_rank,delete t.nb_x,delete t.nb_y),t=$.extend(t,{cityId:e.addr.cityCode,directId:e.addr.cityCode,pageNum:1,pageSize:10}),{query:t,module:"place",action:"takeout"}},v=function(e,t){var n,a=x();return 2!=a?(n=c.geoToPoint(e.geo),t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1):(delete t.nb_x,delete t.nb_y,delete t.center_rank,delete t.pointX1,delete t.pointY1),t=$.extend(t,{c:e.addr.cityCode,center_rank:1,pn:0}),{query:t,module:"search",action:"search"}}});