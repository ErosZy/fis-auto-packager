define("common:static/js/util.js",function(n,t,e){"use strict";Date.prototype.format=function(n){var t,e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(t in e)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,1===RegExp.$1.length?e[t]:("00"+e[t]).substr((""+e[t]).length)));return n},String.prototype.format=function(){var n=[];n=Array.apply(n,arguments);var t=this.replace(/\{([0-9]+)\}/g,function(t,e){var o=n[parseInt(e,10)];return"undefined"==typeof o?"":o});return t};var o={encodeHTML:function(n){return String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;").replace(/'/g,"&#39;")},urlToJSON:function(n){if(!n)return{};var t,e,o,i={},a=n.split("&");for(t=0,o=a.length;o>t;t++)e=a[t].split("="),i[e[0]]=decodeURIComponent(e[1]);return i},jsonToUrl:function(n){if(!n)return"";var t,e=[];for(t in n)n.hasOwnProperty(t)&&e.push(t+"="+encodeURIComponent(n[t]));return e.join("&")},isAndroid:function(){return/android/i.test(navigator.userAgent)},isIOS:function(){return/iphone|ipad|ipod/i.test(navigator.userAgent)},isIPhone:function(){return/iphone/i.test(navigator.userAgent)},isIPad:function(){return/ipad/i.test(navigator.userAgent)},isIPod:function(){return/ipod/i.test(navigator.userAgent)},getIosVersion:function(){return/OS 7_\d[_\d]* like Mac OS X/i.test(navigator.userAgent)},geoToPoint:function(n){if("string"==typeof n){var t,e,o=n.split("|");return 1===parseInt(o[0],10)?(t=o[1].split(","),e={lng:parseFloat(t[0]),lat:parseFloat(t[1])}):void 0}},jsonToQuery:function(n,t){var e,o,i=[];t=t||function(n){return n};for(e in n)n.hasOwnProperty(e)&&(o=n[e],o&&i.push(e+"="+t(o)));return i.join("&")},need2ShowTraffic:function(){for(var t=n("common:widget/geolocation/location.js"),e=n("common:widget/url/url.js"),o=e.get().query,i=i||o&&o.code||t.getCityCode(),a=[131,289,257,340,348,75,167,92,178,53,132,315,163,218,180,150,300,333,58,317,244,179,332,158,194,134,119,138,140,187,236,261,104,224,233,288],r=0;r<a.length;r++)if(i==a[r])return!0;return!1},ifSupportSubway:function(n){var t={131:"beijing,北京,131",289:"shanghai,上海,289",257:"guangzhou,广州,257",340:"shenzhen,深圳,340",2912:"hongkong,香港,2912",75:"chengdu,成都,75",53:"changchun,长春,53",132:"chongqing,重庆,132",167:"dalian,大连,167",138:"foshan,佛山,138",179:"hangzhou,杭州,179",104:"kunming,昆明,104",315:"nanjing,南京,315",58:"shenyang,沈阳,58",224:"suzhou,苏州,224",332:"tianjin,天津,332",218:"wuhan,武汉,218",233:"xian,西安,233",48:"haerbin,哈尔滨,48",beijing:"beijing,北京,131",shanghai:"shanghai,上海,289",guangzhou:"guangzhou,广州,257",shenzhen:"shenzhen,深圳,340",hongkong:"hongkong,香港,2912",chengdu:"chengdu,成都,75",changchun:"changchun,长春,53",chongqing:"chongqing,重庆,132",dalian:"dalian,大连,167",foshan:"foshan,佛山,138",hangzhou:"hangzhou,杭州,179",kunming:"kunming,昆明,104",nanjing:"nanjing,南京,315",shenyang:"shenyang,沈阳,58",suzhou:"suzhou,苏州,224",tianjin:"tianjin,天津,332",wuhan:"wuhan,武汉,218",xian:"xian,西安,233",haerbin:"haerbin,哈尔滨,48"},e=navigator.userAgent,o=/android((\s)*|\/)(1\.\d|2\.[12])/i,i=/FlyFlow/i,a=!(o.test(e)||i.test(e));return a?t[n]:!1},showLoading:function(n){var t=this;t.$pageLoading=o.LoadingBox,t.$pageLoading.show(n);var e=n.css("position");"static"==e&&n.css("position","relative")},hideLoading:function(n,t){var e=function(){n?n.children(".page-loading").length>0&&n.children(".page-loading").remove():$(".page-loading").remove()},o=parseInt(t,10);o&&o>-1?setTimeout(function(){e()},o):e()},create:function(n,t){var e=document.createElement(n);t=t||{};for(var o in t)if("style"!==o){if(t[o])if(e.setAttribute)e.setAttribute(o,t[o]);else try{e[o]=t[o]}catch(e){}}else e.style.cssText=t[o];return e},nativeInfo:{},getNativeInfo:function(n,t,e){var o="http://127.0.0.1:6259/getpackageinfo?packagename="+n,i=this;"object"==typeof i.nativeInfo[n]?t&&t(i.nativeInfo[n]):"number"==typeof i.nativeInfo[n]&&i.nativeInfo[n]>=2?e&&e():$.ajax({url:o,dataType:"jsonp",success:function(e){i.nativeInfo[n]=e,t&&t(e)},error:function(){i.nativeInfo[n]=i.nativeInfo[n]||0,i.nativeInfo[n]++,e&&e()}})},isInstalledClient:function(n,t,e){var o=this;o.getNativeInfo("com.baidu.BaiduMap",function(i){var a=0==i.error;a?$.isFunction(n)&&n(o.getClientUrl("open",e)):$.isFunction(t)&&t(o.getClientUrl("download",e))},function(){$.isFunction(t)&&t(o.getClientUrl("download",e))})},getClientUrl:function(n,t){var e=this,o="";if(e.os=e.isAndroid()?"android":e.isIPhone()?"iphone":e.isIPad()?"ipad":"unknown","download"===n)o="http://mo.baidu.com/map/code/?from=gw10015";else if(n="open")switch(e.os){case"android":o=t?"bdapp://map/place/detail?uid="+t+"&src=baidu|lbswebapp":"bdapp://map/";break;case"iphone":o=t?"baidumap://map/place/detail?uid="+t+"&src=baidu|lbswebapp":"baidumap://map/";break;case"ipad":o=t?"baidumap://map/place/detail?uid="+t+"&src=baidu|lbswebapp":"baidumap://map/";break;case"unknown":o=t?"bdapp://map/place/detail?uid="+t+"&src=baidu|lbswebapp":"bdapp://map/";default:o="http://mo.baidu.com/map"}return o},setHrefStat:function(n,t,e){return n&&t?(e?n.attr("href",t).attr("data-log","{code:"+e+"}"):n.attr("href",t),n):void 0},bindHrefStat:function(n,t){var e=function(e){e.stopPropagation(),e.preventDefault(),t&&t(),setTimeout(function(){window.navigator.standalone?window.open(n.attr("data")):n.attr("data")&&(window.location.href=n.attr("data"))},200)};n.bind("click",e)}};o.TelBox={bindEvent:function(){$("#telBox").on("click .ok-telbox",function(){$("#telBox").off(),$("#telBox").remove()}),$("#telBox").on("click .cancel-telbox",function(){$("#telBox").off(),$("#telBox").remove()})},showTb:function(n){if(n){$("#telBox")[0]&&$("#telBox").remove();var t=[];t.push('<div id="telBox" class="telbox">'),t.push('<div class="t"></div>'),t.push('<div  class="c">'),t.push('<div class="t1">拨打电话</div><div>'),t.push('<button class="bt qx cancel-telbox" >取消</button>'),t.push('<a href="wtai://wp/mc;'+$.trim(n)+'"><button class="bt qd ok-telbox" >确定</button></a>'),t.push("</div></div></div>"),$("body").append(t.join("")),this.bindEvent()}}},o.DownBox={bindEvent:function(){var t=$("#downBox button").eq(1),e=$("#downBox button").eq(0);t.on("click",function(){n("common:widget/stat/stat.js").addCookieStat(COM_STAT_CODE.TOP_BANNER_APP_ERROR_DOWN),$("#downBox").remove()}),e.on("click",function(){n("common:widget/stat/stat.js").addCookieStat(COM_STAT_CODE.TOP_BANNER_APP_ERROR_CANCEL),$("#downBox").remove()})},showTb:function(){$("#downBox")[0]&&$("#downBox").remove();var n=[];n.push('<div id="downBox" class="downbox">'),n.push('<div class="t"></div>'),n.push('<div  class="c">'),n.push('<div class="t1">您还未安装百度地图客户端，立即前往下载</div><div>'),n.push('<button class="bt qx cancel-downbox" >继续使用网页版</button>'),n.push('<a href="http://itunes.apple.com/cn/app/id452186370?ls=1&mt=8"><button class="bt qd cancel-downbox" >去下载</button></a>'),n.push("</div></div></div>"),$("body").append(n.join("")),this.bindEvent()}},o.LoadingBox={show:function(n){if(n.children(".page-loading").length>0)return n.children(".page-loading");var t=o.create("div",{"class":"mappic-loading page-loading slide in",id:"loadingbox"}),e='<div>                           <span class="dot-1"></span>                           <span class="dot-2"></span>                           <span class="dot-3"></span>                           <span class="dot-4"></span>                           <span class="dot-5"></span>                           <span class="dot-6"></span>                           <span class="dot-7"></span>                           <span class="dot-8"></span>                      </div>';return $(t).html(e),n&&n.append($(t)),$(t).show(),$(t)}};var i=["=",".","-","*"],a=1<<23;$.extend(o,{decode_geo_diff:function(n){for(var t=this._decode_type(n.charAt(0)),e=n.substr(1),o=0,a=e.length,r=[],s=[],d=[];a>o;)if(e.charAt(o)===i[0]){if(13>a-o)return 0;if(d=this._decode_6byte_(e.substr(o,13),r),0>d)return 0;o+=13}else if(";"===e.charAt(o))s.push(r.slice(0)),r.length=0,++o;else{if(8>a-o)return 0;if(d=this._decode_4byte_(e.substr(o,8),r),0>d)return 0;o+=8}for(var u=0,c=s.length;c>u;u++)for(var p=0,l=s[u].length;l>p;p++)s[u][p]/=100;return{geoType:t,geo:s}},_decode_type:function(n){var t=-1;return n===i[1]?t=2:n===i[2]?t=1:n===i[3]&&(t=0),t},_decode_6byte_:function(n,t){for(var e=0,o=0,i=0,a=0;6>a;a++){if(i=this._char2num_(n.substr(1+a,1)),0>i)return-1-a;if(e+=i<<6*a,i=this._char2num_(n.substr(7+a,1)),0>i)return-7-a;o+=i<<6*a}return t.push(e),t.push(o),0},_decode_4byte_:function(n,t){var e=t.length;if(2>e)return-1;for(var o=0,i=0,r=0,s=0;4>s;s++){if(r=this._char2num_(n.substr(s,1)),0>r)return-1-s;if(o+=r<<6*s,r=this._char2num_(n.substr(4+s,1)),0>r)return-5-s;i+=r<<6*s}return o>a&&(o=a-o),i>a&&(i=a-i),t.push(t[e-2]+o),t.push(t[e-1]+i),0},_char2num_:function(n){var t=n.charCodeAt(0);return n>="A"&&"Z">=n?t-"A".charCodeAt(0):n>="a"&&"z">=n?26+t-"a".charCodeAt(0):n>="0"&&"9">=n?52+t-"0".charCodeAt(0):"+"===n?62:"/"===n?63:-1},getPoiPoint:function(n){var t=[],e=null;if("Point"===n.toString())e=n;else{if("string"==typeof n){if(t=$.trim(n).split(","),t.length<2)return;t[0]=parseFloat($.trim(t[0])),t[1]=parseFloat($.trim(t[1]))}else if(t=n.slice(0),t.length<2)return;e=new BMap.Point(t[0],t[1])}return e},parseGeo:function(n){if("string"==typeof n){var t=n.split("|"),e=parseInt(t[0]),o=t[1],i=t[2],a=i.split(";"),r=[];switch(e){case 1:r.push(a[0]);break;case 2:case 3:for(var s=0;s<a.length-1;s++){var d=a[s];if(d.length>100)d=d.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),r.push(d);else{for(var u=[],c=d.split(","),p=0;p<c.length;p+=2){var l=c[p],h=c[p+1];u.push(l+","+h)}r.push(u.join(";"))}}}return r.length<=1&&(r=r.toString()),{type:e,bound:o,points:r}}},parse2Geo:function(n,t){t?.25>t?t=0:t>.25&&1>t?t=1:t>32&&(t=32):t=0;var e=n.split("|");if(1===e.length){var o=this.decode_geo_diff(e[0]);return{type:o.type,bound:"",points:o.geo.join(",")}}if(e.length>1){for(var i=n.split(";.="),a=[],r=[],s=0,d=i.length,u=0;d>u;u++){var c=i[u];d>1&&(0===u&&(c+=";"),u>0&&d-1>u&&(c=".="+c+";"),u===d-1&&(c=".="+c));var p=c.split("|"),l=this.decode_geo_diff(p[0]),h=this.decode_geo_diff(p[1]);a.push(l.geo.join(",")),a.push(h.geo.join(","));var o=this.decode_geo_diff(p[2]);s=o.type;var g=o.geo.join(",");if(g=g.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;"),t>0){var f=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+t+"}","ig");g=g.replace(f,"$1")}r.push(g)}return 1>=d&&(r=r.join(";")),{type:s,bound:a.join(";"),points:r}}},getPointByStr:function(t){var e=n("common:widget/map/map.js").getBMap();if("string"==typeof t){var o=t.split(",");if(!(o.length<2))return e?new e.Point(o[0],o[1]):{lng:parseFloat(o[0]),lat:parseFloat(o[1])}}},getBPoints:function(n){if(n&&0!==n.length){for(var t=[],e=0;e<n.length;e++)if(n[e])for(var i=n[e].split(";"),a=0;a<i.length;a++){var r=o.getPointByStr(i[a]);t.push(r)}return t}}}),e.exports=o});