define("place:static/js/broadcastname.js",function(e,t,a){a.exports={DATEPICKER_DATE_CHANGE:"datepickerdatechange",HOTELBOOK_OR_THIRDSRCOTA_SHOW:"hotelbookorthirdsrcotashow"}});
;define("place:widget/hotelthirdsrc/hotelthirdsrc.js",function(t,e,o){function i(t){var e;t.uid&&(e={st:t.st,et:t.et,uid:t.uid},s=t.st,n=t.et,a=t.uid,$("#place-pagelet-hotelthirdsrc").html('<div class="hotel-loading"><span></span><span>正在获取实时精准报价数据...</span></div>'),BigPipe.asyncLoad({id:"place-pagelet-hotelthirdsrc"},r.jsonToUrl(e)+"&pageletGroup=third"))}var a,s,n,r=t("common:static/js/util.js"),d=t("common:widget/url/url.js"),l=t("common:widget/stat/stat.js"),h=_APP_HASH.action;listener.on("place.datepicker","datechange",function(t,e){i(e)}),o.exports={init:function(t){this.firstShowNum=4,this.options=t||{},this.$el=$("#place-pagelet-hotelthirdsrc"),l.addStat(STAT_CODE.PLACE_HOTEL_BOOKABLE_DETAIL_VIEW,{type:t.hotelType,from_page:h}),this.bind()},fetchThirdsrc:i,bind:function(){listener.trigger("place.datepicker","showcalendar"),this.$el.find(".room-more").on("click",$.proxy(this._showAllRooms,this)),this.$el.find(".hotel-head").on("click",$.proxy(this._hideAllRooms,this)),this.$el.find(".bookbtn-normal").on("click",$.proxy(this._addParams,this))},_showAllRooms:function(){var t=this.$el.find(".room-more-icon");this.$el.find(".room-item").slice(this.firstShowNum).toggle(),t.toggleClass("arrow-down"),this.$el.find(".room-more-text").html(t.hasClass("arrow-down")?"收起全部房型":"展开全部房型")},_hideAllRooms:function(){$(".hotel-roomlist-thirdsrc").toggle()},_addParams:function(t){var e,o=$(t.target),i=(new Date).format("yyyy-MM-dd"),r=new Date((new Date).getTime()+864e5).format("yyyy-MM-dd"),c=this.options,p=o.data("url"),m=parseInt(o.data("price"),10),u=parseInt(o.data("bonus"),10)||0,g=c.kehuduan?"/kehuduan=1":"";e={from_page:h,checkin_date:s||i,checkout_date:n||r,price:m,book_price:m-u,simple:1,type:c.hotelType,uid:a||"",kehuduan:c.kehuduan||0},l.addCookieStat(STAT_CODE.PLACE_HOTEL_THIRDSRC_BOOK_CLICK,e),d.navigate("/mobile/webapp/place/order/"+p+g)}}});
;define("place:widget/hotelthirdota/hotelthirdota.js",function(t,o,i){"use strict";function s(t){var o;t.uid&&(o={st:t.st,et:t.et,uid:t.uid},a=o,$("#place-pagelet-hotelthirdota").html('<div class="hotel-loading"><span></span><span>正在获取实时精准报价数据...</span></div>'),BigPipe.asyncLoad({id:"place-pagelet-hotelthirdota"},e.jsonToUrl(o)+"&pageletGroup=third"))}var a,e=t("common:static/js/util.js"),h=t("common:widget/geolocation/location.js"),n=t("common:widget/popup/popup.js"),l=t("common:widget/stat/stat.js");listener.on("place.datepicker","datechange",function(t,o){s(o)}),i.exports={create:function(){var t=this.$el=$("#place-pagelet-hotelthirdota");this.serverAddr="http://"+location.host+"/mobile/webapp/place/hotelbook/async=1&qt=",this.$showAllRoom=t.find(".show-all-room"),this.$showAllOta=t.find(".show-all-ota"),this.$hbMain=t.find(".main"),this.$roomsWp=t.find(".rooms"),this.$rooms=t.find(".room-list > .room-item"),this.$roomsHide=t.find(".room-list > .room-item").slice(3),this.$otasHide=t.find(".ota-list > li").slice(3),this.$otaResult=t.find(".ota-result"),this.$fetchFailed=t.find(".ota-failed"),this.$otaItem=t.find(".ota-item"),this.uid=$("#uid").html(),this.isShowAllRoom=!1,this.isShowAllOta=!1,this.lastIndex="0",this.currentIndex="0",listener.trigger("place.datepicker","showcalendar"),this.addStatParam(this.$otaResult,".ota-normal")},fetchThirdota:s,bindEvents:function(){this.bindRoomListEvents()},bindRoomListEvents:function(){this.$showAllRoom.on("click",$.proxy(this.showAllRoom,this)),this.$showAllOta.on("click",$.proxy(this.showAllOta,this)),this.$rooms.on("click",$.proxy(this.fetchOtas,this)),this.$otaItem.on("click",$.proxy(this.goToBook,this))},unbindEvents:function(){this.unbindRoomListEvents()},unbindRoomListEvents:function(){this.$showAllRoom.off("click",$.proxy(this.showAllRoom,this)),this.$showAllOta.off("click",$.proxy(this.showAllOta,this)),this.$rooms.off("click",$.proxy(this.fetchOtas,this)),this.$otaItem.off("click",$.proxy(this.goToBook,this))},showAllRoom:function(t){var o=this.$showAllRoom;o.hasClass("show-all-room-open")?(o.find("span").eq(0).html("查看其他房型"),this.$roomsHide.hide(),this.$roomsHide.find(".arrow-icon").removeClass("arrow-icon-open"),this.$roomsHide.next(".ota-result").hide()):(o.find("span").eq(0).html("收起其他房型"),this.$roomsHide.show()),l.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_MOREROOM_CLICK,{uid:this.uid,type:"thirdota",from_page:_APP_HASH.action}),this.$showAllRoom.toggleClass("show-all-room-open"),t.stopPropagation(),t.stopImmediatePropagation()},showAllOta:function(t){var o=$(t.target).closest(".show-all-ota");o.hasClass("show-all-ota-open")?o.find("span").eq(0).html("展开其他报价"):o.find("span").eq(0).html("收起其他报价"),o.closest(".ota-result").find(".ota-item").slice(3).toggleClass("hide"),o.toggleClass("show-all-ota-open"),l.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_MOREPRICE_CLICK,{uid:this.uid,type:"thirdota",from_page:_APP_HASH.action}),t.stopPropagation(),t.stopImmediatePropagation()},fetchOtas:function(t){var o,i,s,a,e,h=(this.$el,_APP_HASH.action),n=$(t.target).closest(".room-item").find("span").eq(1).text(),r={};l.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_ROOM_CLICK,{uid:this.uid,room_type:n,from_page:h}),this.$targetRoom=$(t.target).closest(".room-item"),this.currentIndex=this.$targetRoom.attr("index"),i=this.$targetRoom.next(),s=i.hasClass("ota-result")&&i||i.children(".ota-result").length&&i.children(".ota-result"),a=this.$targetRoom.find("span").eq(0),s&&s.length?(s.toggle(),a.toggleClass("arrow-icon-open")):this.isloading||(a.toggleClass("arrow-icon-open"),e='<div class="ota-fetching"><span></span><span>正在获取实时精准报价数据...</span></div>',this.$targetRoom.after(e),this.isloading=!0,o=this.$targetRoom.attr("ota_price_url"),r={type:"POST",url:this.serverAddr+"fetchotas",data:{uid:this.uid,otaPriceUrl:o},dataType:"html"},this.fetchData(r,$.proxy(this.doFetchOtaSuccess,this),$.proxy(this.doFetchOtaError,this))),t.stopPropagation(),t.stopImmediatePropagation()},fetchData:function(t,o,i){$.ajax({type:t.type,url:t.url,data:t.data,dataType:t.dataType,success:function(t){o(t)},error:function(t,o){i(t,o)}})},doFetchOtaSuccess:function(t){this.$targetRoom.next().remove(),this.$showAllOta.off("click",$.proxy(this.showAllOta,this)),this.$targetRoom.after(t),this.$showAllOta=this.$el.find(".show-all-ota"),this.$otasHide=this.$el.find(".ota-list > li").slice(3),this.$otaItem=this.$el.find(".ota-bookbtn"),this.addStatParam(this.$targetRoom.next(),".ota-bookbtn"),this.bindEvents(),this.isloading=!1},doFetchOtaError:function(){this.bindEvents(),this.isloading=!1},doFetchRoomSuccess:function(t){var o=this.$el;this.unbindRoomListEvents(),this.$hbMain.append(t),this.$showAllRoom=o.find(".show-all-room"),this.$showAllOta=o.find(".show-all-ota"),this.$rooms=o.find(".room-list > .room-item"),this.$roomsHide=o.find(".room-list > .room-item").slice(3),this.$otasHide=o.find(".ota-list > li").slice(3),this.$roomsWp=o.find(".rooms"),this.$otaItem=o.find(".ota-item"),this.bindEvents(),this.isShowAllRoom=!1,this.isShowOta=!0,this.isShowAllOta=!1},doFetchRoomError:function(){this.bindEvents()},goToBook:function(t){var o=$(t.currentTarget),i=_APP_HASH.action,s=o.find(".ota-type").text(),a=o.find(".ota-name").text();o.hasClass("ota-web")?(l.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_BOOKBTN_PC_CLICK,{uid:this.uid,type:s,ota:a,from_page:i}),n.open({text:"您好，此酒店报价需要在电脑端登陆：map.baidu.com，在酒店版块中进行搜索预订",autoCloseTime:3e3})):o.hasClass("ota-tel")&&l.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_BOOKBTN_TEL_CLICK,{uid:this.uid,type:s,ota:a,from_page:i})},addStatParam:function(t,o){var i,s={from_page:_APP_HASH.action,checkin_date:a.st,checkout_date:a.et,c:h.getCityCode(),simple:1};t&&t.length&&t.find(o).each(function(){i=$(this),this.href&&(this.href=this.href+"&"+e.jsonToUrl(s))})},init:function(){var t=_APP_HASH.action;this.create(),l.addStat(STAT_CODE.PLACE_HOTEL_BOOKABLE_DETAIL_VIEW,{uid:this.uid,type:"thirdota",from_page:t}),this.bindEvents()}}});
;define("place:static/js/hotel.js",function(t,e,a){var i=t("common:widget/stat/stat.js");a.exports={init:function(t){var e=this;e.$navs=$(".hotelext-nav li"),e.$conts=$(".hotelext-cont > div"),e.sendHotelbookAsync(t),e.sendExtAsync(t),e.lastTabIndex=-1,e.switchTab(0),e.bind()},bind:function(){this.$navs.on("click",$.proxy(this._clickTab,this))},sendHotelbookAsync:function(e){var a=(new Date).format("yyyy-MM-dd"),i=new Date((new Date).getTime()+864e5).format("yyyy-MM-dd");t("place:widget/hotelthirdsrc/hotelthirdsrc.js").fetchThirdsrc({st:a,et:i,uid:e.uid}),t("place:widget/hotelthirdota/hotelthirdota.js").fetchThirdota({st:a,et:i,uid:e.uid})},sendExtAsync:function(t){BigPipe.asyncLoad([{id:"place-pagelet-hotelextimg"},{id:"place-pagelet-hotelextphone"},{id:"place-pagelet-hotelextcomment"},{id:"place-pagelet-hotelextshop"},{id:"place-pagelet-hotelexttuan"},{id:"place-pagelet-hotelextpre"},{id:"place-pagelet-hotelsitelink"}],"uid="+t.uid+"&pageletGroup=ext")},_clickTab:function(t){var e,a=$(t.currentTarget);~(e=this.$navs.index(a))&&(this.switchTab(e),i.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_TAB_CLICK,{type:e}))},switchTab:function(t){var e=this.$navs,a=this.$conts,i=this.lastTabIndex;~i&&(e.eq(i).removeClass("active"),a.eq(i).removeClass("active")),e.eq(t).addClass("active"),a.eq(t).addClass("active"),this.lastTabIndex=t}}});
;define("place:static/js/identityValidate.js",function(r,e,t){function a(r){return!!c.city[parseInt(r.substr(0,2))]}function n(r){if(15==r.length){if(null==c.pattern.exec(r))return!1;var e=parseInt("19"+r.substr(6,2)),t=r.substr(8,2),a=parseInt(r.substr(10,2)),n=(new Date).getYear();switch(t){case"01":case"03":case"05":case"07":case"08":case"10":case"12":if(a>31)return!1;break;case"04":case"06":case"09":case"11":if(a>30)return!1;break;case"02":if(0==e%4&&0!=e%100||0==e%400){if(a>29)return!1}else if(a>28)return!1;break;default:return!1}if(n-parseInt(e)<15||n-parseInt(e)>100)return!1}return!0}function s(r){for(var e=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1),t=0,a=0,n=0;17>n;++n){if(r.charAt(n)<"0"||r.charAt(n)>"9")return!1;a=r.charAt(n)-"0",t+=a*e[n]}if("X"==r.charAt(17)||"x"==r.charAt(17))t+=10*e[17];else{if(r.charAt(17)<"0"||r.charAt(17)>"9")return!1;t+=(r.charAt(17)-"0")*e[17]}return 1==t%11?!0:!1}var c={city:{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},pattern:/^\d{15}$/};t.exports={validate:function(r){return a(r)&&n(r)&&s(r)}}});
;define("place:static/js/vcode.js",function(e,t,n){var c,o;o={},c=function(e){var t=this;t.option=$.extend({},o,e),t.el=$(t.option.el),t.render(),t.refreshVcode()},c.Const={},c.Const.U_GET_VCODE="http://map.baidu.com/maps/services/captcha?cb=?",c.Const.U_GET_IMAGE="http://map.baidu.com/maps/services/captcha/image",c.Const.T_VCODE='<input type="hidden" name="vcode" value="" /><img title="点击更换验证码" width="100" height="30"  id="VerifyCodeImg" class="codeimg"  src="http://map.baidu.com/img/transparent.gif" /><a id="changeVerifyCode" href="javascript:void(0);" class="changecode">换一张</a>',$.extend(c.prototype,{render:function(){var e=this;e.el.prepend($(c.Const.T_VCODE)),e.el.find("#changeVerifyCode").click(function(){e.refreshVcode()})},setVcode:function(e){var t=this;t.el.find("input[name=vcode]").val(e),t.vcode=e},refreshVcode:function(){var e=this;e.el.find(".vcode-img").prop("src","http://map.baidu.com/img/transparent.gif"),$.ajax({url:c.Const.U_GET_VCODE+"&t="+ +new Date,dataType:"jsonp",jsonp:"cb",success:function(t){var n;(n=t.content.vcode)&&(e.setVcode(n),e.getImage(n))}})},getImage:function(e){this.el.find(".codeimg").prop("src",c.Const.U_GET_IMAGE+"?vcode="+e)},getData:function(){var e=this;return{vcode:e.vcode,code:e.el.find("input[name=code]").val()}}}),n.exports=c});
;define("place:static/lib/mapresize.js",function(e,i,n){var t=e("common:static/js/util.js"),r={h:0,w:0,tm:1e3,interval:null,ua:navigator.userAgent.toLowerCase(),init:function(){this.startMgr()},startMgr:function(){"undefined"!=typeof window.onorientationchange?window.addEventListener("orientationchange",this.resize,!1):window.addEventListener("resize",this.resize,!1),t.isAndroid()&&window.addEventListener("resize",this.resize,!1)},endMgr:function(){clearInterval(this.interval),this.interval=null},resize:function(){}};n.exports=r});
;define("place:static/lib/template.js",function(){window.baidu=window.baidu||{},baidu.template=baidu.template||{},baidu.template._encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},baidu.template._encodeEventHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\\\\/g,"\\").replace(/\\\//g,"/").replace(/\\n/g,"\n").replace(/\\r/g,"\r")}});
;define("place:static/lib/underscore.js",function(n,t,r){(function(){var n=this,e=n._,u={},i=Array.prototype,a=Object.prototype,o=Function.prototype,c=i.push,l=i.slice,f=i.concat,s=a.toString,p=a.hasOwnProperty,v=i.forEach,h=i.map,d=i.reduce,g=i.reduceRight,m=i.filter,y=i.every,b=i.some,_=i.indexOf,w=i.lastIndexOf,x=Array.isArray,j=Object.keys,A=o.bind,E=function(n){return n instanceof E?n:this instanceof E?(this._wrapped=n,void 0):new E(n)};"undefined"!=typeof t?("undefined"!=typeof r&&r.exports&&(t=r.exports=E),t._=E):n._=E,E.VERSION="1.5.1";var O=E.each=E.forEach=function(n,t,r){if(null!=n)if(v&&n.forEach===v)n.forEach(t,r);else if(n.length===+n.length){for(var e=0,i=n.length;i>e;e++)if(t.call(r,n[e],e,n)===u)return}else for(var a in n)if(E.has(n,a)&&t.call(r,n[a],a,n)===u)return};E.map=E.collect=function(n,t,r){var e=[];return null==n?e:h&&n.map===h?n.map(t,r):(O(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var F="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),d&&n.reduce===d)return e&&(t=E.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(O(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(F);return r},E.reduceRight=E.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),g&&n.reduceRight===g)return e&&(t=E.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=E.keys(n);i=a.length}if(O(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(F);return r},E.find=E.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},E.filter=E.select=function(n,t,r){var e=[];return null==n?e:m&&n.filter===m?n.filter(t,r):(O(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},E.reject=function(n,t,r){return E.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},E.every=E.all=function(n,t,r){t||(t=E.identity);var e=!0;return null==n?e:y&&n.every===y?n.every(t,r):(O(n,function(n,i,a){return(e=e&&t.call(r,n,i,a))?void 0:u}),!!e)};var k=E.some=E.any=function(n,t,r){t||(t=E.identity);var e=!1;return null==n?e:b&&n.some===b?n.some(t,r):(O(n,function(n,i,a){return e||(e=t.call(r,n,i,a))?u:void 0}),!!e)};E.contains=E.include=function(n,t){return null==n?!1:_&&n.indexOf===_?-1!=n.indexOf(t):k(n,function(n){return n===t})},E.invoke=function(n,t){var r=l.call(arguments,2),e=E.isFunction(t);return E.map(n,function(n){return(e?t:n[t]).apply(n,r)})},E.pluck=function(n,t){return E.map(n,function(n){return n[t]})},E.where=function(n,t,r){return E.isEmpty(t)?r?void 0:[]:E[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},E.findWhere=function(n,t){return E.where(n,t,!0)},E.max=function(n,t,r){if(!t&&E.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&E.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return O(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},E.min=function(n,t,r){if(!t&&E.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&E.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return O(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},E.shuffle=function(n){var t,r=0,e=[];return O(n,function(n){t=E.random(r++),e[r-1]=e[t],e[t]=n}),e};var R=function(n){return E.isFunction(n)?n:function(t){return t[n]}};E.sortBy=function(n,t,r){var e=R(t);return E.pluck(E.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var M=function(n,t,r,e){var u={},i=R(null==t?E.identity:t);return O(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};E.groupBy=function(n,t,r){return M(n,t,r,function(n,t,r){(E.has(n,t)?n[t]:n[t]=[]).push(r)})},E.countBy=function(n,t,r){return M(n,t,r,function(n,t){E.has(n,t)||(n[t]=0),n[t]++})},E.sortedIndex=function(n,t,r,e){r=null==r?E.identity:R(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},E.toArray=function(n){return n?E.isArray(n)?l.call(n):n.length===+n.length?E.map(n,E.identity):E.values(n):[]},E.size=function(n){return null==n?0:n.length===+n.length?n.length:E.keys(n).length},E.first=E.head=E.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:l.call(n,0,t)},E.initial=function(n,t,r){return l.call(n,0,n.length-(null==t||r?1:t))},E.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:l.call(n,Math.max(n.length-t,0))},E.rest=E.tail=E.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},E.compact=function(n){return E.filter(n,E.identity)};var S=function(n,t,r){return t&&E.every(n,E.isArray)?f.apply(r,n):(O(n,function(n){E.isArray(n)||E.isArguments(n)?t?c.apply(r,n):S(n,t,r):r.push(n)}),r)};E.flatten=function(n,t){return S(n,t,[])},E.without=function(n){return E.difference(n,l.call(arguments,1))},E.uniq=E.unique=function(n,t,r,e){E.isFunction(t)&&(e=r,r=t,t=!1);var u=r?E.map(n,r,e):n,i=[],a=[];return O(u,function(r,e){(t?e&&a[a.length-1]===r:E.contains(a,r))||(a.push(r),i.push(n[e]))}),i},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=function(n){var t=l.call(arguments,1);return E.filter(E.uniq(n),function(n){return E.every(t,function(t){return E.indexOf(t,n)>=0})})},E.difference=function(n){var t=f.apply(i,l.call(arguments,1));return E.filter(n,function(n){return!E.contains(t,n)})},E.zip=function(){for(var n=E.max(E.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=E.pluck(arguments,""+r);return t},E.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},E.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=E.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(_&&n.indexOf===_)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},E.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(w&&n.lastIndexOf===w)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},E.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var I=function(){};E.bind=function(n,t){var r,e;if(A&&n.bind===A)return A.apply(n,l.call(arguments,1));if(!E.isFunction(n))throw new TypeError;return r=l.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(l.call(arguments)));I.prototype=n.prototype;var u=new I;I.prototype=null;var i=n.apply(u,r.concat(l.call(arguments)));return Object(i)===i?i:u}},E.partial=function(n){var t=l.call(arguments,1);return function(){return n.apply(this,t.concat(l.call(arguments)))}},E.bindAll=function(n){var t=l.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return O(t,function(t){n[t]=E.bind(n[t],n)}),n},E.memoize=function(n,t){var r={};return t||(t=E.identity),function(){var e=t.apply(this,arguments);return E.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},E.delay=function(n,t){var r=l.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},E.defer=function(n){return E.delay.apply(E,[n,1].concat(l.call(arguments,1)))},E.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},E.debounce=function(n,t,r){var e,u=null;return function(){var i=this,a=arguments,o=function(){u=null,r||(e=n.apply(i,a))},c=r&&!u;return clearTimeout(u),u=setTimeout(o,t),c&&(e=n.apply(i,a)),e}},E.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},E.wrap=function(n,t){return function(){var r=[n];return c.apply(r,arguments),t.apply(this,r)}},E.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},E.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},E.keys=j||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)E.has(n,r)&&t.push(r);return t},E.values=function(n){var t=[];for(var r in n)E.has(n,r)&&t.push(n[r]);return t},E.pairs=function(n){var t=[];for(var r in n)E.has(n,r)&&t.push([r,n[r]]);return t},E.invert=function(n){var t={};for(var r in n)E.has(n,r)&&(t[n[r]]=r);return t},E.functions=E.methods=function(n){var t=[];for(var r in n)E.isFunction(n[r])&&t.push(r);return t.sort()},E.extend=function(n){return O(l.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},E.pick=function(n){var t={},r=f.apply(i,l.call(arguments,1));return O(r,function(r){r in n&&(t[r]=n[r])}),t},E.omit=function(n){var t={},r=f.apply(i,l.call(arguments,1));for(var e in n)E.contains(r,e)||(t[e]=n[e]);return t},E.defaults=function(n){return O(l.call(arguments,1),function(t){if(t)for(var r in t)void 0===n[r]&&(n[r]=t[r])}),n},E.clone=function(n){return E.isObject(n)?E.isArray(n)?n.slice():E.extend({},n):n},E.tap=function(n,t){return t(n),n};var T=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof E&&(n=n._wrapped),t instanceof E&&(t=t._wrapped);var u=s.call(n);if(u!=s.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(E.isFunction(a)&&a instanceof a&&E.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,l=!0;if("[object Array]"==u){if(c=n.length,l=c==t.length)for(;c--&&(l=T(n[c],t[c],r,e)););}else{for(var f in n)if(E.has(n,f)&&(c++,!(l=E.has(t,f)&&T(n[f],t[f],r,e))))break;if(l){for(f in t)if(E.has(t,f)&&!c--)break;l=!c}}return r.pop(),e.pop(),l};E.isEqual=function(n,t){return T(n,t,[],[])},E.isEmpty=function(n){if(null==n)return!0;if(E.isArray(n)||E.isString(n))return 0===n.length;for(var t in n)if(E.has(n,t))return!1;return!0},E.isElement=function(n){return!(!n||1!==n.nodeType)},E.isArray=x||function(n){return"[object Array]"==s.call(n)},E.isObject=function(n){return n===Object(n)},O(["Arguments","Function","String","Number","Date","RegExp"],function(n){E["is"+n]=function(t){return s.call(t)=="[object "+n+"]"}}),E.isArguments(arguments)||(E.isArguments=function(n){return!(!n||!E.has(n,"callee"))}),"function"!=typeof/./&&(E.isFunction=function(n){return"function"==typeof n}),E.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},E.isNaN=function(n){return E.isNumber(n)&&n!=+n},E.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==s.call(n)},E.isNull=function(n){return null===n},E.isUndefined=function(n){return void 0===n},E.has=function(n,t){return p.call(n,t)},E.noConflict=function(){return n._=e,this},E.identity=function(n){return n},E.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},E.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=E.invert(N.escape);var q={escape:new RegExp("["+E.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(N.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(n){E[n]=function(t){return null==t?"":(""+t).replace(q[n],function(t){return N[n][t]})}}),E.result=function(n,t){if(null==n)return void 0;var r=n[t];return E.isFunction(r)?r.call(n):r},E.mixin=function(n){O(E.functions(n),function(t){var r=E[t]=n[t];E.prototype[t]=function(){var n=[this._wrapped];return c.apply(n,arguments),P.call(this,r.apply(E,n))}})};var B=0;E.uniqueId=function(n){var t=++B+"";return n?n+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},C=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(n,t,r){var e;r=E.defaults({},r,E.templateSettings);var u=new RegExp([(r.escape||D).source,(r.interpolate||D).source,(r.evaluate||D).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(C,function(n){return"\\"+z[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,E);var c=function(n){return e.call(this,n,E)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},E.chain=function(n){return E(n).chain()};var P=function(n){return this._chain?E(n).chain():n};E.mixin(E),O(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=i[n];E.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],P.call(this,r)}}),O(["concat","join","slice"],function(n){var t=i[n];E.prototype[n]=function(){return P.call(this,t.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(window)});
;define("place:widget/bdcomment/bdcomment.js",function(e,t,o){var n=e("common:static/js/util.js");o.exports={startIndex:0,init:function(){var e=this,t=$("#J_commentSelect");t.on("change",$.proxy(e.loadMore,e)),$(".comment-loadmore").on("click",function(){e.loadMore(!0)})},loadMore:function(e){var t,o=this,a=$("#J_commentSelect"),c=0,d=5;e&&(c=++o.startIndex,d=10),t=n.jsonToUrl({uid:a.data("uid"),startIndex:c,maxResults:d,orderBy:a.val()}),BigPipe.asyncLoad({id:"place-pagelet-bdcomment"},t)}}});
;define("place:widget/bookphone/bookphone.js",function(t,o,i){function a(){"use strict";var t=$(".place-widget-bookphone");t.on("click",e)}function e(t){var o=$(t.target).closest("a");n.isAndroid()&&(o.attr("href","javascript:void(0)"),n.TelBox.showTb(o.attr("data-tel"))),t.stopPropagation(),t.stopImmediatePropagation()}var n=t("common:static/js/util.js");i.exports={init:function(){"use strict";a()}}});
;define("place:widget/caterorderdetail/caterorderdetail.js",function(require,exports,module){require("place:static/lib/template.js");var url=require("common:widget/url/url.js"),util=require("common:static/js/util.js"),popup=require("common:widget/popup/popup.js"),DEFAULT_ERROR_MSG="网络连接失败",DATA_TYPE="json",HOST="",ORDER_LIST_URL="/mobile/webapp/place/cater/qt=orderlist{{kehuduan}}?mobile=",ORDER_SEARCH_URL="/mobile/webapp/place/cater/qt=searchorder{{kehuduan}}",CANCEL_AJAX_URL=HOST+"/detail?qt=cater_ordercancel",DETAIL_AJAX_URL=HOST+"/detail?qt=cater_orderdetail",STATUS_MSG={1:"等待确认",2:"下单成功",3:"订单已取消",4:"预订失败"},getStatusDesc=function(e){var t=Math.floor(e/100);return STATUS_MSG[t]||""},getRoomLabel=function(e,t){var a="大厅";return"1"===e&&(t=parseInt(t,10)||0,a="包间"+(t?"（"+t+"人间）":"")),a},defError=function(e){e=e||{},popup.open(e.errorMsg||DEFAULT_ERROR_MSG)},CaterOrderDetail=function(){var urlData=util.urlToJSON(window.location.search.replace("?",""));this.template=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(""),"undefined"!=typeof order_id?(_template_fun_array.push('    <div class="orderinfo">        <p>订单状态：<span data-node="statusDesc">',"undefined"==typeof status_desc?"":baidu.template._encodeHTML(status_desc),"</span></p>        <p>订单号：","undefined"==typeof order_id?"":baidu.template._encodeHTML(order_id),'</p>    </div>    <div class="item shopinfo">        <h4>',"undefined"==typeof shop_name?"":baidu.template._encodeHTML(shop_name),"</h4>        <p>            ","undefined"==typeof room?"":baidu.template._encodeHTML(room),"        "),"undefined"!=typeof min_cost&&min_cost&&_template_fun_array.push("            最低消费：","undefined"==typeof min_cost?"":baidu.template._encodeHTML(min_cost),"元        "),_template_fun_array.push("        </p>        <p>入店时间：","undefined"==typeof order_time?"":baidu.template._encodeHTML(order_time),"</p>        <p>最晚到店时间：","undefined"==typeof keep_time?"":baidu.template._encodeHTML(keep_time),"</p>        <p>地址：","undefined"==typeof address?"":baidu.template._encodeHTML(address),'</p>    </div>    <div class="item">        <p class="userinfo">            <span class="username">联系人信息：                '),"undefined"!=typeof gender&&"0"==gender?_template_fun_array.push("                    ","undefined"==typeof user_name?"":baidu.template._encodeHTML(user_name),"先生                "):_template_fun_array.push("                    ","undefined"==typeof user_name?"":baidu.template._encodeHTML(user_name),"女士                "),_template_fun_array.push('            </span>            <span class="tel">电话：',"undefined"==typeof mobile?"":baidu.template._encodeHTML(mobile),"</span>        </p>        "),Math.floor(status/100)>2&&_template_fun_array.push('            <div class="help">                <p class="label">其他帮助</p>                <div class="info">                    <p class="help-tel">                        <span>百度客服电话：</span>                        <a href="tel:(400-0998-998)">                            <b class="tel-icon-b"></b>                            400-0998-998                        </a>                    </p>                </div>            </div>        '),_template_fun_array.push("    </div>    "),"1"==can_cancel&&_template_fun_array.push('        <div class="cancel">            <div class="btn" data-action="cancelOrder">取消订单</div>        </div>    '),_template_fun_array.push("")):_template_fun_array.push('    <div class="error">订单错误</div>'),_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],this.mobile=urlData.mobile,this.orderId=urlData.orderid,this.$el=$("#place-widget-caterorderdetail"),this.init()};CaterOrderDetail.prototype={init:function(){this.bindEvent(),this.getOrderDetail()},formatRS:function(e){e=e||{};var t=1e3*parseInt(e.order_time||0,10),a=parseInt(e.keep_time||0,10);return e.status_desc=getStatusDesc(e.status),e.room=getRoomLabel(e.need_room,e.room_size),e.order_time=new Date(t).format("yyyy-MM-dd hh:mm"),e.keep_time=new Date(t+1e3*60*a).format("hh:mm"),e},render:function(e){var t=e.data||[];this.$el.html(this.template(this.formatRS(t[0]))),this.$statusDesc=this.$el.find('[data-node="statusDesc"]')},getOrderDetail:function(){$.ajax({url:DETAIL_AJAX_URL,type:"GET",dataType:DATA_TYPE,context:this,data:{orderId:this.orderId,mobile:this.mobile},cache:!1,success:function(e){e&&0===e.errorNo||(8e3===e.errorNo?url.navigate(ORDER_SEARCH_URL):url.navigate(ORDER_LIST_URL+this.mobile)),this.render(e)},error:defError})},onCancelOrderClick:function(e){var t=$(e.currentTarget);$.ajax({url:CANCEL_AJAX_URL,type:"POST",dataType:DATA_TYPE,data:{orderId:this.orderId,mobile:this.mobile},context:this,success:function(e){return 0!==e.errorNo?defError(e):(t.remove(),this.$statusDesc.html(STATUS_MSG["3"]),void 0)},error:defError})},bindEvent:function(){this.onCancelOrderClickHandle=$.proxy(this.onCancelOrderClick,this),this.$el.delegate("[data-action=cancelOrder]","click",this.onCancelOrderClickHandle)},unbindEvent:function(){this.$el.undelegate("[data-action=cancelOrder]","click",this.onCancelOrderClickHandle)},destroy:function(){this.unbindEvent()}},exports.init=function(e){return e=e||{},ORDER_LIST_URL=ORDER_LIST_URL.replace("{{kehuduan}}",e.kehuduan?"&kehuduan=1":""),ORDER_SEARCH_URL=ORDER_SEARCH_URL.replace("{{kehuduan}}",e.kehuduan?"&kehuduan=1":""),new CaterOrderDetail}});
;define("place:widget/caterorderlist/caterorderlist.js",function(require,exports,module){require("place:static/lib/template.js");var url=require("common:widget/url/url.js"),util=require("common:static/js/util.js"),popup=require("common:widget/popup/popup.js"),DEF_NUM=10,DISABLED="disabled",DEF_HREF="javascript:;",DEFAULT_ERROR_MSG="网络连接失败",DEF_SEARCH_URL="/mobile/webapp/place/cater/qt=searchorder{{kehuduan}}",DEF_ORDER_LIST_URL="/mobile/webapp/place/cater/qt=orderlist{{kehuduan}}?",DEF_ORDER_DELTAIL_URL="/mobile/webapp/place/cater/qt=orderdetail{{kehuduan}}?",HOST="",DATA_TYPE="json",LIST_AJAX_URL=HOST+"/detail?qt=cater_orderlist",STATUS_MSG={1:"等待确认",2:"下单成功",3:"订单已取消",4:"预订失败"},getStatusDesc=function(e){var t=Math.floor(e/100);return STATUS_MSG[t]||""},getRoomLabel=function(e,t){var a="大厅";return"1"===e&&(t=parseInt(t,10)||0,a="包间"+(t?"（"+t+"人间）":"")),a},defError=function(e){e=e||{},popup.open(e.errorMsg||DEFAULT_ERROR_MSG),8e3===e.errorNo&&url.navigate(DEF_SEARCH_URL,{replace:!0})},CaterOrderList=function(){var urlData=util.urlToJSON(window.location.search.replace("?",""));this.itemTemp=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<li data-oid="',"undefined"==typeof order_id?"":baidu.template._encodeHTML(order_id),'" data-href="',"undefined"==typeof order_url?"":baidu.template._encodeHTML(order_url),'">    <div class="item">        <h4> ',"undefined"==typeof shop_name?"":baidu.template._encodeHTML(shop_name),' </h4>        <span class="room right">',"undefined"==typeof room?"":baidu.template._encodeHTML(room),'</span>    </div>    <div class="person">        就餐人数：',"undefined"==typeof person_num?"":baidu.template._encodeHTML(person_num),'位    </div>    <div class="item">        <span>预约入店时间：',"undefined"==typeof order_time?"":baidu.template._encodeHTML(order_time),'</span>        <span class="right">',"undefined"==typeof status_desc?"":baidu.template._encodeHTML(status_desc),'</span>    </div>    <em class="list-arrow"></em></li>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],this.curPage=parseInt(urlData.page,10)||1,this.mobile=urlData.mobile,this.$el=$("#place-widget-caterorderlist"),this.$mobile=this.$el.find('[data-node="mobile"]'),this.$list=this.$el.find('[data-node="list"]'),this.$pageNav=this.$el.find('[data-node="pageNav"]'),this.$preBtn=this.$el.find('[data-node="pre"]'),this.$nextBtn=this.$el.find('[data-node="next"]'),this.init()};CaterOrderList.prototype={init:function(){this.getOrderList(),this.bindEvent()},bindEvent:function(){this.onListClickHandle=$.proxy(this.onListClick,this),this.$el.on("click","li",this.onListClickHandle)},unbindEvent:function(){this.$el.off("click","li",this.onListClickHandle)},onListClick:function(e){var t=$(e.currentTarget),a=t.data("href");url.navigate(a),e.stopPropagation(),e.stopImmediatePropagation()},getOrderList:function(){$.ajax({url:LIST_AJAX_URL,type:"GET",dataType:DATA_TYPE,context:this,cache:!1,data:{mobile:this.mobile,page:this.curPage,num:DEF_NUM},success:function(e){return e&&0===e.errorNo?(this.render(e),void 0):defError(e)},error:defError})},formatRs:function(e){var t=e||{},a=parseInt(t.order_time,10);return t.order_time=new Date(1e3*a).format("yyyy-MM-dd hh:mm"),t.status_desc=getStatusDesc(t.status),t.room=getRoomLabel(t.need_room,t.room_size),t},formatPage:function(e,t){var a=1>=t?"hide":"show",r=t>e,i=e>1;this.$pageNav[a](),this.$preBtn[i?"removeClass":"addClass"](DISABLED),this.$nextBtn[r?"removeClass":"addClass"](DISABLED),this.$preBtn.attr("href",i?DEF_ORDER_LIST_URL+util.jsonToUrl({mobile:this.mobile,page:e-1,num:DEF_NUM}):DEF_HREF),this.$nextBtn.attr("href",r?DEF_ORDER_LIST_URL+util.jsonToUrl({mobile:this.mobile,page:e+1,num:DEF_NUM}):DEF_HREF)},render:function(e){this.$mobile.html(this.mobile),this.formatPage(this.curPage,Math.ceil(e.total/DEF_NUM));for(var t,a="",r=e.data||[],i=0;i<r.length;i++)t=this.formatRs(r[i]),t.order_url=DEF_ORDER_DELTAIL_URL+util.jsonToUrl({mobile:this.mobile,orderid:t.order_id}),a+=this.itemTemp(r[i]);this.$list.html(a)},destroy:function(){this.unbindEvent()}},exports.init=function(e){return e=e||{},DEF_SEARCH_URL=DEF_SEARCH_URL.replace("{{kehuduan}}",e.kehuduan?"&kehuduan=1":""),DEF_ORDER_LIST_URL=DEF_ORDER_LIST_URL.replace("{{kehuduan}}",e.kehuduan?"&kehuduan=1":""),DEF_ORDER_DELTAIL_URL=DEF_ORDER_DELTAIL_URL.replace("{{kehuduan}}",e.kehuduan?"&kehuduan=1":""),new CaterOrderList}});
;define("place:widget/catersearchorder/catersearchorder.js",function(t,e){var n=t("common:widget/popup/popup.js"),i=t("common:widget/url/url.js"),o=1e3,a=60,r="disabled",c="重新获取",d="秒后重新获取",s="网络连接失败",h="请输入正确的手机号码",l="验证码不能为空",u="/mobile/webapp/place/cater/qt=orderlist{{kehuduan}}?mobile=",v="json",f="",p=f+"/detail?qt=cater_phonecaptcha",m=f+"/detail?qt=cater_verifycaptcha",C=function(t){t=t||{},n.open(t.errorMsg||s)},b=function(t){return t&&11===t.length&&t.match(/^((\(\d{3}\))|(\d{3}\-))?13[0-9]\d{8}|15[0-9]\d{8}|18\d{9}/g)?!0:!1},B=function(t){return!!t},S=function(){this.$el=$("#place-widget-catersearchorder"),this.$submit=this.$el.find('[data-node="submitBtn"]'),this.$tel=this.$el.find('[data-node="tel"]'),this.$vCode=this.$el.find('[data-node="veriCode"]'),this.$vCodeBtn=this.$el.find('[data-node="veriCodeBtn"]'),this.init()};S.prototype={init:function(){this.bindEvent()},bindEvent:function(){this.onSearchFormSubmitHandle=$.proxy(this.onSearchFormSubmit,this),this.onVCodeBtnClickHandle=$.proxy(this.onVCodeBtnClick,this),this.$submit.on("click",this.onSearchFormSubmitHandle),this.$vCodeBtn.on("click",this.onVCodeBtnClickHandle)},changeSCodeBtn:function(t){var e=this;this.timer&&clearInterval(this.timer);var n=isNaN(t)?a:t;this.$vCodeBtn.addClass(r);var i=function(){--n?e.$vCodeBtn.html(n+d):(clearInterval(e.timer),e.$vCodeBtn.html(c),e.$vCodeBtn.removeClass(r))};this.timer=setInterval(i,o)},getSMSCode:function(t){var e=this.$tel.val();return b(e)?($.ajax({url:p,type:"GET",dataType:v,cache:!1,data:{phone_num:e},success:function(e){return e&&0===e.errorNo?("function"==typeof t&&t(e),void 0):C(e)},error:C}),void 0):n.open(h)},checkForm:function(){var t=this.$tel.val(),e=this.$vCode.val();return b(t)?B(e)?!0:(n.open(l),!1):(n.open(h),!1)},onVCodeBtnClick:function(){var t=this,e=this.$vCodeBtn.hasClass(r);if(!e){var n=function(e){e=e||{},t.changeSCodeBtn(e.delay)};this.getSMSCode(n)}},onSearchFormSubmit:function(t){if(t.preventDefault(),this.checkForm()){var e=this.$vCode.val(),n=this.$tel.val();$.ajax({url:m,type:"GET",data:{captcha:e,phone_num:n},cache:!1,dataType:v,success:function(t){return t&&0===t.errorNo?(i.navigate(u+n,{replace:!1}),void 0):C(t)},error:C})}},unbindEvent:function(){this.$submit.off("click",this.onSearchFormSubmitHandle),this.$vCodeBtn.off("click",this.onVCodeBtnClickHandle)},destroy:function(){this.unbindEvent()}},e.init=function(t){return t=t||{},u=u.replace("{{kehuduan}}",t.kehuduan?"&kehuduan=1":""),new S}});
;define("place:widget/codes/codes.js",function(i,e,n){function o(){var i=$("body").width()-85;$(".movie_name").css("width",i),$("#back").click(function(){window.history.go(-1)})}function t(i){$(".list").click(function(){var e=this.id;location.href=u+"/mobile/webapp/place/detail/force=simple&qt=inf&uid="+e+"&c="+i.city_id+"/&code="+i.code+"&sign="+i.sign})}function c(){var i=document.getElementById("city");i.onchange=function(){var i=this.options[this.selectedIndex].value;f.city_id=i,r(f)}}function d(i){for(var e=document.getElementById("city"),n=0;n<e.length;n++)e.options[n].value==i&&(e.options[n].selected=!0)}function s(i){var e="";$.each(i.list,function(i,n){e+='<dl class="list list_boder" id="'+n.uid+'">',e+='<dt><span class="sn">'+(i+1)+'</span><span class="movie_name">'+n.name+"</span></dt>",e+='<dd><span class="addr">'+n.address+'</span></dd><dd class="trad"></dd></dl>'}),$("#list_info").html(e),1==m&&(d(i.city_id),m=!1),c(),t(i)}function a(i){var e=new RegExp("(^|&)"+i+"=([^&]*)(&|$)","i"),n=window.location.href.substr(1).match(e);return null!==n?decodeURIComponent(n[2]):null}function l(){var i={};return i.point_x=a("point_x"),i.point_y=a("point_y"),i.city_id=a("city_id"),i.city_id?$.param(i):""}function r(i){if(i.city_id)var e=u+"/mobile/webapp/place/codes/force=simple&qt=cinemas&code="+i.code+"&sign="+i.sign+"&city_id="+i.city_id;else var e=u+"/mobile/webapp/place/codes/force=simple&qt=cinemas&code="+i.code+"&sign="+i.sign+"&"+i.bound;$.ajax({url:e,type:"get",dataType:"json",crossDomain:!1,data:null,async:!0,error:function(){},success:function(i){0==i.errorNo?(s(i),$("#codes_box").removeClass("hide"),$("#over").addClass("hide")):($("#codes_box").addClass("hide"),$("#over").removeClass("hide"))}})}function p(i,e){o(),f.code=i,f.sign=e,f.bound=l(),r(f)}var u="http://"+window.location.host,f={},m=!0;$(window).resize(function(){o()}),n.exports={initialize:p}});
;define("place:widget/codesdetail/codesdetail.js",function(e,i,t){function n(){$("#name").html(c.name),parseInt(c.score)&&$("#score").html(c.score),c.duration&&"undefined"!=c.duration?$("#duration").html("片长："+c.duration+"分钟"):$("#duration").html("片长：暂无"),c.category&&"undefined"!=c.category?$("#category").html("类型："+c.category):$("#category").html("类型：暂无"),$("#pic").attr("src",c.pic),$("#pname").html(c.pname),c.director&&"undefined"!=c.director?$("#director").html("导演："+c.director):$("#director").html("导演：暂无"),c.player&&"undefined"!=c.player?$("#player").html("主演："+c.player):$("#player").html("主演：暂无"),$("#release").html("上映时间："+c.release);var e=c.day.split("-");$("#day").html(e[1]+"月"+e[2]+"日&nbsp;<span class='txt_red' id='time'>"+c.time+"</span>&nbsp;"+c.type)}function o(){$("#back").click(function(){window.history.go(-1)}),$("#subSure").click(function(){var e=[];if($('input[name="pid"]:checked').each(function(){e.push($(this).val())}),0==e.length){var i=0;return function a(){i>5||(i++,1==i%2?$('input[name="pid"]').each(function(){this.checked=!0}):$('input[name="pid"]').each(function(){this.checked=!1}),window.setTimeout(a,200))}(),void 0}e.join(",");var t=$("#phone").val(),n="http://"+window.location.host,o=n+"/detail?qt=mcdkey&act=exchange&pids="+e+"&phone="+t+"&code="+c.code+"&sign="+c.sign;$.ajax({type:"GET",url:o,data:null,dataType:"json",success:function(e){if(0==e.errorNo)location.href=n+"/detail?qt=movie&act=select&sign="+e.sign+"&act_id="+e.act_id+"&act_pids="+e.pids+"&from=webapp&uid="+c.uid+"&date="+c.day+"&seq_no="+c.seq_no+"&cinema_id="+c.cinemaid+"&movie_id="+c.mid+"&third_from=wangpiao&movie_info="+encodeURIComponent(c.info);else if(300010==e.errorNo)window.location.reload();else if(200002==e.errorNo){var i=0;!function t(){i>5||(i++,$("#phone").toggleClass("tsred"),window.setTimeout(t,200))}()}},error:function(){}})})}function a(e){c=e,n(),o()}var c;t.exports={initialize:a}});
;define("place:widget/codesindex/codesindex.js",function(t,i,e){function o(){var t=h.getCityCode()||1,i={};return h.hasExactPoi()&&(i.point_x=h.getPointX(),i.point_y=h.getPointY(),i.city_id=t),i}function n(){var t=$("#buyCodeCount span");t.click(function(){$(this).addClass("selected").siblings("span").removeClass("selected"),g=parseInt($(this).text())})}function a(t){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),e=window.location.href.substr(1).match(i);return null!==e?decodeURIComponent(e[2]):null}function c(t){$.ajax({url:t.url||"",type:t.type||"GET",dataType:t.dataType||"text",crossDomain:t.crossDomain||!1,data:t.data||"",contentType:"POST"==t.type?"application/x-www-form-urlencoded; charset=utf-8":null,async:!0,success:function(i){t.callback(i)},error:function(){}})}function s(t){function i(t){var i=$("#citylist"),o="";0==t.errorNo&&$.each(t.list,function(t,i){o+='<option class="city_opt" value="'+i.city_id+'">'+i.city+"</option>"}),i.html(o),d(e,"",1)}if(t.city_id)var e="&"+$.param(t);else var e="";var o=y+"/mobile/webapp/place/codes/force=simple&qt=webappcitys"+e+"&act_id="+a("act_id"),n={url:o,type:"GET",dataType:"json",crossDomain:!0,data:null,callback:i};c(n)}function l(){var t=document.getElementById("citylist");t.onchange=function(){var t=this.options[this.selectedIndex].value;d("",t,0)}}function r(t){for(var i=document.getElementById("citylist"),e=0;e<i.length;e++)i.options[e].value==t&&(i.options[e].selected=!0)}function d(t,i,e){function o(t){if(0==t.errorNo){r(t.city_id);var i=$("#cinemas"),e="",o=1;$.each(t.list,function(t,i){$.each(i.list,function(t,i){e+='<li class="cinemaslist" id="'+i.uid+'"><p class="shop"><span class="order">'+o+".</span>"+i.name+"</p>",e+='<p class="addr">'+i.address+"</p></li>",o++})}),i.html(e),u(t)}}if(0==e)var n="&city_id="+i;else var n=t;var s=y+"/detail?qt=mcdkey&from=webapp&act=cinemas"+n+"&act_id="+a("act_id");$("#cityname");var l={url:s,type:"GET",dataType:"json",crossDomain:!1,data:null,callback:o};c(l)}function u(t){$(".cinemaslist").click(function(){var i=this.id;location.href=y+"/mobile/webapp/place/detail/force=simple&qt=inf&uid="+i+"&c="+t.city_id+"&wd=电影院",_.addStat(STAT_CODE.PLACE_BUYCODES_CINDEMAS_PV,{state:t.city_id})})}function p(){var t=$("#rule"),i=$("#rule_list"),e=$("#movieinfo"),o=$("#movieinfolist");t.click(function(){i.toggle(),$(this).toggleClass("mod_tit")}),e.click(function(){o.toggle(),$(this).toggleClass("mod_tit")})}function m(t){function i(t){200002==t.errorNo?(o.html("手机号有误！"),o.removeClass("vhide"),f(o)):300002==t.errorNo?(n.html("您的限额已经用完！"),n.removeClass("vhide"),f(n)):300003==t.errorNo?(n.html("您只能购买"+t.res_num+"张票了哦！"),n.removeClass("vhide"),f(n)):0==t.errorNo&&(window.location.href=t.topayURL)}var e=t,o=$("#phoneMsg"),n=$("#numMsg");$("#submitBtn").click(function(){var t=$("#phone").val(),n=y+"/detail?qt=mcdkey&from=webapp&act=corder&act_id="+e.act_id+"&sign="+e.sign+"&phone="+t+"&num="+g,a={url:n,type:"GET",dataType:"json",crossDomain:!0,data:null,callback:i};if(g){if(!t)return o.html("手机号有误！"),o.removeClass("vhide"),f(o),void 0;_.addStat(STAT_CODE.PLACE_BUYCODES_PV,{state:"buyCodes"}),c(a)}})}function f(t){var i=window.setTimeout(function(){t.addClass("vhide"),window.clearTimeout(i)},5e3)}function v(t){n();var i=o();s(i),l(),p(),m(t)}var y="http://"+window.location.host,h=t("common:widget/geolocation/location.js"),_=t("common:widget/stat/stat.js"),g=1;e.exports={initialize:v}});
;define("place:widget/commentbtn/commentbtn.js",function(t,o,n){var e=t("common:widget/login/login.js"),a=(t("common:widget/stat/stat.js"),t("common:widget/url/url.js"));n.exports={$el:null,init:function(){var t=this;t.$el=$("#J_commentBtn"),t.$el.on("click",$.proxy(this.commentAction,this)),t.showBonus()},commentAction:function(t){e.checkLogin(function(o){o.status?a.navigate($(t.target).closest("a").data("url")):e.loginAction()})},showBonus:function(){var t=this;if(a.get().pageState&&"1"===a.get().pageState.cmark&&"comment"===a.get().pageState.detail_part){var o=$("<a>点击抽奖</a>").data("log",$("#bonus-stat").data("log")).attr("id","comment-bonus").attr("href","http://map.baidu.com/zt/zhuanpan/mobile/?from=app").css({background:"#fcaf41",display:"block",color:"#fff",height:"40px",margin:"10px 0",font:'normal bold 14px/40px "微软雅黑"',"-webkit-border-radius":"5px","border-radius":"5px","text-align":"center"});t.$el.after(o)}else t.$el.parent().find("#comment-bonus").remove()}}});
;define("place:widget/datepicker/datepicker.js",function(t,e,a){"use strict";var i=new Date,n=new Date(i.getTime()+864e5);a.exports={init:function(t){var e=$(".hotel-calendar"),a=e.find(".date-ipt-start .tit-text"),r=e.find(".date-ipt-end .tit-text");this.date={},this.options=t,a.text(i.format("yyyy-MM-dd")),r.text(n.format("yyyy-MM-dd")),this.$sContainer=e.find(".hotel-container-start"),this.$eContainer=e.find(".hotel-container-end"),this.$sWrapper=e.find(".hotel-calwrap-start"),this.$eWrapper=e.find(".hotel-calwrap-end"),this.$sInput=a,this.$eInput=r,this.$calendar=e,this.isShow=!1,this.bindEvent()},bindEvent:function(){var t=this;listener.on("place.datepicker","showcalendar",function(){t.isShow||(t._initCalendar(),t.isShow=!0)})},_initCalendar:function(){var e=this,a=(t("common:widget/datepicker/datepicker.js"),$.datepicker),i=a.parseDate(e.$sInput.text()),n=a.parseDate(e.$eInput.text()),r=e.options.uid;e.$sContainer.datepicker({date:i,minDate:i,valuecommit:function(t,i,n){var s=a.parseDate(e.$eInput.text()),p=new Date(i.getTime()+864e5);e.$sInput.text(n),e._compareDate(i,s)>=0&&(e.$eInput.text(p.format("yyyy-MM-dd")),e.$eContainer.datepicker("date",p)),e.$eContainer.datepicker("minDate",p).datepicker("maxDate",new Date(i.getFullYear(),i.getMonth(),i.getDate()+28)).datepicker("refresh"),e._removeActiveCss("start"),e.$sInput.text()!==e.date.st&&listener.trigger("place.datepicker","datechange",{st:e.$sInput.text(),et:e.$eInput.text(),uid:r}),e.date.st=e.$sInput.text()}}),e.$eContainer.datepicker({date:n,minDate:n,maxDate:new Date(i.getFullYear(),i.getMonth(),i.getDate()+28),valuecommit:function(t,a,i){e.$eInput.text(i),e._removeActiveCss("end"),e.$eInput.text()!==e.date.et&&listener.trigger("place.datepicker","datechange",{st:e.$sInput.text(),et:e.$eInput.text(),uid:r}),e.date.et=e.$eInput.text()}}),e.$calendar.find(".hotel-date-ipt").on("click",$.proxy(e._onDateClick,e)),e.$calendar.show()},_removeActiveCss:function(t){switch(t){case"start":this.$sWrapper.hide(),this.$sInput.parents(".hotel-date-ipt").removeClass("active");break;case"end":this.$eWrapper.hide(),this.$eInput.parents(".hotel-date-ipt").removeClass("active")}},_compareDate:function(t,e){return t.getTime()-e.getTime()},_onDateClick:function(t){var e=this,a=$(t.currentTarget);a.hasClass("date-ipt-start")?(e._removeActiveCss("end"),this.$sWrapper.toggle(),a.toggleClass("active")):a.hasClass("date-ipt-end")&&(e._removeActiveCss("start"),this.$eWrapper.toggle(),a.toggleClass("active")),t.stopPropagation(),t.stopImmediatePropagation()}}});
;define("place:widget/dishcategory/dishcategory.js",function(e,i,t){var a=(e("common:static/js/util.js"),e("place:static/lib/mapresize.js")),c=e("common:static/js/iscroll.js");t.exports={init:function(){function e(e){var i=e.target,t=i.id;if(t){var a=$("#dishCategory_"+t).offset();window.scroll(0,a.top)}$("#place-widget-dish-category").hide()}$("#place-widget-dish-category").show();var i=new c($("#place-widget-dish-category .ddl_wrapper div").get(0),{hScroll:!1,hScrollbar:!1,vScroll:!0,vScrollbar:!0,handleClick:!0}),t=a.h||320;t-=160,t=Math.min(Math.max(120,t),360),$("#place-widget-dish-category .ddl_wrapper .ul_scroll").css({maxHeight:t}),i.refresh(),$("#place-widget-dish-category").on("click",e),$("#place-widget-dish-category").hide()}}});
;define("place:widget/genericlayer/genericlayer.js",function(t,e,o){function i(t){a.TileLayer.call(this,t),this._opts={},t=t||{},this._opts=$.extend(this._opts,t)}var a=t("common:widget/api/api.js"),n=t("common:widget/geolocation/location.js");i.prototype=new a.TileLayer,i.prototype.initialize=function(t,e){a.TileLayer.prototype.initialize.call(this,t,e),this._map=t},i.prototype.getTilesUrl=function(t,e){var o=this,i=t.y,a=t.x,s=["http://gss0.map.baidu.com","http://gss1.map.baidu.com","http://gss2.map.baidu.com","http://gss3.map.baidu.com"],p=Math.abs(a+i)%s.length,r=s[p]+"/?qt=bkg_png&c="+n.getCityCode()+"&ie=utf-8";r+=window.placeParam?"&wd="+encodeURIComponent(o._opts.json.result.return_query)+window.placeParam:"&wd="+encodeURIComponent(o._opts.json.result.return_query),r+="&rn=4",this._map.highResolutionEnabled()&&(r+="&imgtype=hdpi"),n.hasExactPoi()&&(r+="&center_rank=1",r+="&nb_x="+n.getPointX(),r+="&nb_y="+n.getPointY());var l=this._map.getBounds(),c=l.getSouthWest().lng,g=l.getSouthWest().lat,h=l.getNorthEast().lng,m=l.getNorthEast().lat,u=escape("(")+c+","+g+";"+h+","+m+escape(")");return r+="&l="+e+"&xy="+a+"_"+i+"&b="+u+"&t="+(new Date).getTime()},i._className_="MDLayer",o.exports=i});
;define("place:widget/genericrequest/genericrequest.js",function(t,e,i){function s(){this.json=null,this.qWord="",this.qCity=-1,this.isGRequest=!1,this.genDataLst={},this.genDataIdLis=[],this.spotOnId="",this.marker=null,this.curBoundTiles=[],this.curCenterPoint=null,this.types={36:{t:1},38:{t:1},39:{t:1}}}var n=t("common:static/js/mapconst.js"),a=t("common:static/js/util.js"),r=t("common:widget/geolocation/location.js"),o=t("common:widget/api/api.js"),h=t("common:static/js/searchdata.js"),d=t("place:widget/genericlayer/genericlayer.js");$.extend(s.prototype,{initialize:function(){this.clearCache()},setMapView:function(t){this.mapView=t,this.map=t.getMap(),this.bindSpotClickEvent()},bindSpotClickEvent:function(){var t=this;if(!this.binded){this.binded=!0;var e=function(e){var i=t.mapView.iwController.get();if(!i.skipClickHandler){var s=e.spots;if(!s||s.length<1||!s[0].getUserData().tag||"GR_DATA"!=s[0].getUserData().tag)return t.marker&&(t.map.removeOverlay(t.marker),t.marker=null),void 0;t.onGRHotspotClick&&t.onGRHotspotClick(e);var n=s[0].getUserData().userdata,a=n.uid,r=n.name;t.showPoiInfoWindow(s[0].getPosition(),a,r)}};listener.on("infowindow."+n.IW_GRT,"click",function(t,e){var i=e.id,s=e.data,n=e.instance;switch(i){case"iw-l":n.nbSearch(s.name,s.geo);break;case"iw-c":n.detailSearch(s.uid);break;case"iw-r":n.lineSearch(s.name,s.geo)}}),this.map.addEventListener("onhotspotclick",e)}},setGRData:function(t){t&&(this.json=t,this.clearListener(),this.resetStatus())},resetStatus:function(){var t=this.json.result.type.toString();this.types[t]&&(this.isGRequest=!0,1==this.types[t].t?(this.addGRMap(),this.addMDRequest()):2==this.types[t].t&&(this.clearGRMap(),this.clearListener()),this.addMDEvent(),this.curCenterPoint=this.map.centerPoint)},clearCache:function(){this.isGRequest=!1,this.genDataLst={},this.genDataIdLis=[],this.spotOnId="",this.curBoundTiles=[],this.marker&&(this.map.removeOverlay(this.marker),this.marker=null),this.clearListener(),this.map.clearHotspots(),this.qWord="",this.qCity=-1,this.clearGRMap()},clearListener:function(){this.map&&(this.map.removeEventListener("load",window.bindMDRequest),this.map.removeEventListener("moveend",window.bindMDRequest),this.map.removeEventListener("zoomend",window.bindMDRequest),this.map.removeEventListener("mapcontainerresize",window.bindMDRequest))},clearGRMap:function(){var t=s.MDLayer;t&&(this.map.removeTileLayer(t),this.qWord="",this.qCity=-1,this.genDataLst={},this.genDataIdLis=[]),s.MDLayer=null,this.marker&&this.marker.hide()},addGRMap:function(){if(this.json){var t=this.json.result.return_query||"";if(this.qWord!=t||this.qCity!=r.getCityCode()){if(this.clearGRMap(),38==this.json.result.type&&this.map.zoomLevel<11)return;this.qWord=t,this.qCity=r.getCityCode().cityCode,new o.Bounds(-21364736,-10616832,23855104,15859712);var e=new d({json:this.json,transparentPng:!1});this.map.addTileLayer(e),s.MDLayer=e}}},sendMDRequest:function(){var t=this;setTimeout(function(){t._sendMDRequest()},1)},_sendMDRequest:function(){var t=this;if(t.json&&t.isGRequest){var e=this.map.getViewTiles(),i=[];this.curBoundTiles=[];for(var s=0,n=e.length;n>s;s++){var a=this.map.getZoom()+"_"+e[s].x+"_"+e[s].y;this.curBoundTiles.push(a),t.genDataLst[a]||i.push(e[s].x+"_"+e[s].y)}if(0!=i.length){this.map.clearHotspots();var o=[];o.push("/?qt="),o.push("bkg_data&c="+r.getCityCode()+"&ie=utf-8&wd="+encodeURIComponent(t.json.result.return_query)),window.placeParam&&o.push(window.placeParam),o.push("&rn=4");var h=this.map.getBounds(),d="("+h.getSouthWest().lng+","+h.getSouthWest().lat+";"+h.getNorthEast().lng+","+h.getNorthEast().lat+")";o.push("&l="+this.map.zoomLevel+"&xy="+i.join(",")+"&callback=getMData&b="+d),$.ajaxJSONP({url:o.join("")})}}},addMDRequest:function(){this.sendMDRequest()},showPoiInfoWindow:function(t,e,i){t&&e&&i&&(t=new o.Point(t.lng,t.lat),this.marker?this.marker.setPoint(t):this.marker=this.addGRMarker(t),this.marker.show(),iwOverlay=this.mapView.iwController.get(n.IW_GRT),iwOverlay.setData(n.IW_GRT,{json:{uid:e,name:i,geo:"1|"+t.lng+","+t.lat}}).switchTo(0),iwOverlay.skipClickHandler=!0)},addGRMarker:function(t){var e=new o.Icon(n.MARKERS_PATH,new o.Size(23,32),{anchor:new o.Size(12,32),imageOffset:new o.Size(29,352)}),i=new this.mapView.CustomMarker(e,t,{className:"fix_gr_mk"});return this.map.addOverlay(i),i},sendInfRequest:function(t){if(t){var e=this,i="qt=inf&uid="+t;h.fetch(i,function(i){var s=i.content,n=a.getPointByStr(a.parseGeo(s.geo).points);e.showPoiInfoWindow(n,t,s.name)})}},getGRData:function(t){if(t){for(var e=0,i=t.length;i>e;e++){for(var s=[],n=t[e],a=0,r=n.uids.length;r>a;a++)s.push({pt:new o.Point(n.uids[a].x,n.uids[a].y),bd:[30,16,0,16],userdata:{name:n.uids[a].name,uid:n.uids[a].uid},tag:"GR_DATA"});if(this.genDataLst[n.tileid]=s,this.genDataIdLis.push(n.tileid.toString()),this.genDataIdLis.length>30){var h=this.genDataIdLis.shift();delete this.genDataLst[h],delete h}}for(var e=0,i=this.curBoundTiles.length;i>e;e++)if(this.genDataLst[this.curBoundTiles[e]])for(var d=this.genDataLst[this.curBoundTiles[e]],a=0,r=d.length;r>a;a++){var u=new o.Hotspot(d[a].pt,{userData:d[a],offsets:d[a].bd});this.map.addHotspot(u)}}},hasNotMoved:function(){if(!this.curCenterPoint)return!0;0===this.curCenterPoint.lng&&0===this.curCenterPoint.lat&&(this.curCenterPoint=this.map.centerPoint);var t=this.map.pointToPixel(this.curCenterPoint),e=this.map.pointToPixel(this.map.centerPoint),i=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);return this.curCenterPoint=this.map.centerPoint,i>=.6*this.map.width||s>=.6*this.map.height?!1:!0},addMDEvent:function(){var t=this;window.bindMDRequest||(window.bindMDRequest=function(e){"onmoveend"===e.type&&t.hasNotMoved()||t.sendMDRequest()}),this.map.addEventListener("load",window.bindMDRequest),this.map.addEventListener("moveend",window.bindMDRequest),this.map.addEventListener("zoomend",window.bindMDRequest),this.map.addEventListener("mapcontainerresize",window.bindMDRequest)}}),window.getMData=function(e){if(e){var i=t("place:widget/genericrequest/genericrequest.js");i.getGRData(e)}},i.exports=new s});
;define("place:widget/gotomovie/gotomovie.js",function(t,a,o){"use strict";function i(){var t=$("#detail-phone");t.on("click",e)}function e(t){var a=$(".common-widget-nav .title span").text(),o=$(".place-widget-captain").find(".name").text();s.addStat(STAT_CODE.PLACE_DETAIL_TELEPHONE_CLICK,{wd:a,name:o});var i=$(t.target).closest("a");n.isAndroid()&&(i.attr("href","javascript:void(0)"),n.TelBox.showTb(i.attr("data-tel"))),t.stopPropagation(),t.stopImmediatePropagation()}var n=t("common:static/js/util.js"),s=t("common:widget/stat/stat.js");s.addStat(STAT_CODE.PLACE_DETAIL_TELEPHONE_SHOW),o.exports={init:function(){i()}}});
;define("place:widget/groupon/groupon.js",function(a,e,o){function t(a){"use strict";var e=$(a.target).closest("ul").attr("url"),o=$(".place-widget-groupon-site").text();r.addStat(STAT_CODE.PLACE_GROUPON_CLICK,{wd:s.wd,name:s.name,dest:o,srcname:s.srcname}),window.open(e),a.stopPropagation(),a.stopImmediatePropagation()}function i(a){var e=c.html()-0;d.hasClass("place-widget-groupon-disable")&&d.removeClass("place-widget-groupon-disable"),l.hasClass("place-widget-groupon-disable")||(d.on("click",n),p.hide(),p.eq(e-2).show(),c.html(e-1),0==e-2&&(l.addClass("place-widget-groupon-disable"),l.off("click",i))),a.stopPropagation(),a.stopImmediatePropagation()}function n(a){var e=c.html()-0,o=g.html()-0;l.hasClass("place-widget-groupon-disable")&&l.removeClass("place-widget-groupon-disable"),d.hasClass("place-widget-groupon-disable")||(l.on("click",i),p.hide(),p.eq(e).show(),c.html(e+1),e+1==o&&(d.addClass("place-widget-groupon-disable"),d.off("click",n))),a.stopPropagation(),a.stopImmediatePropagation()}var s,p=$(".place-widget-groupon-main"),l=$(".place-widget-groupon-pagenum-prev"),d=$(".place-widget-groupon-pagenum-next"),c=$(".place-widget-groupon-curpage"),g=$(".place-widget-groupon-totalpage"),r=a("common:widget/stat/stat.js");o.exports={init:function(a){"use strict";var e=g.html()-0;s=a||{},p.on("click",t),e>1&&(l.on("click",i),d.on("click",n)),r.addStat(STAT_CODE.PLACE_GROUPON_VIEW,{wd:s.wd,name:s.name,srcname:s.srcname})}}});
;define("place:widget/helper/maphelper.js",function(e,t,i){var s=e("common:static/js/mapconst.js"),a=e("common:widget/url/url.js"),n=e("common:static/js/util.js"),r=(e("common:widget/geolocation/location.js"),e("common:static/js/searchdata.js")),o=e("place:widget/genericrequest/genericrequest.js"),l=e("common:widget/stat/stat.js");i.exports={_selectedIndex:-999,polylineStyles:[{stroke:6,color:"#3a6bdb",opacity:.65},{stroke:6,color:"#3a6bdb",opacity:.75},{stroke:4,color:"#30a208",opacity:.65},{stroke:5,color:"#3a6bdb",opacity:.65},{stroke:6,color:"#3a6bdb",opacity:.5},{stroke:4,color:"#30a208",opacity:.5,strokeStyle:"dashed"},{stroke:4,color:"#575757",opacity:.65,strokeStyle:"dashed"}],poiMarkers:[],transitLines:[],roadPolylines:[],transitPolylines:[],stationPoints:[],stationMarkers:[],init:function(t,i,s,n){this.mapView=t||e("common:widget/map/map.js"),this.BMap=i||e("common:widget/map/map.js"),this.map=this.mapView.getMap(),this.data=n&&n.content?n:s,this._selectedIndex=-999;var r=a.get(),o=r.query,l=r.pageState,c=l.i||0;delete l.vt,delete l.i;var p=$.param(o)+"|"+$.param(l);this.mapView.displayId,this.mapView.clearOverlays(),this.addPoiOverlays(this.data,r),this.mapView.displayId=p,"string"==typeof c&&"uid"==c.split(",")[0]?this.selectHotspotMarker(c.split(",")[1]):this.selectPoiMarker(c)},addPoiOverlays:function(e,t){var i=this,a=this.BMap,n=this.map,r=this.mapView,o=t.query;t.pageState;var l=e.listInfo?e.listInfo.isShowAll:void 0,c=this.processMapData(e,t.pageState,l),p=c.currentCity?c.currentCity.code:1,h=[36,38,39];!c.isSharePoint&&c.points.length>0?(this.addPoiMarkers(c.points),r.iwController.get(s.IW_POI).setData(s.IW_POI,{json:c.content,cityCode:p}).switchTo(0),listener.on("infowindow."+s.IW_POI,"click",function(e,t){var i=t.id,s=t.data,a=t.instance;switch(i){case"iw-l":a.nbSearch(s.name,s.geo);break;case"iw-c":a.detailSearch(s.uid);break;case"iw-r":a.lineSearch(s.name,s.geo)}}),h.indexOf(c.resultType)>-1&&1==o.center_rank&&o.nb_x&&o.nb_y&&this.addCenterPoiMarker(new a.Point(o.nb_x,o.nb_y))):(i.poiMarkers=[],i.mapView.poiMarkers=[]),c.isSharePoint&&c.points.length>0&&(this.addSingleMarker(c.points[0],c.content[0]),r.iwController.get(s.IW_SHR).setData(s.IW_SHR,{json:c.content}).switchTo(0),listener.on("infowindow."+s.IW_SHR,"click",function(){})),c.isSingle||this.addGRHotspotsLayer(this.data),this.transitLines=c.transitLines,this.transitLines.length>0?this.addTransitPolyline(this.transitLines[0],function(e){r.setViewport(e.stationPoints.concat(c.points))}):r.setViewport(c.points),n.addEventListener("onvectorclick",function(e){var t=e.iconInfo;t.uid&&t.name&&t.point&&i.switchSelectedMarker(-999)})},processMapData:function(e,t,i){if(e){var a,r={points:[],content:[],transitLines:[],isSingle:!1,resultType:e.result.type,currentCity:e.current_city};a="undefined"!=typeof i?i||!(!t||1!=t.showall):!(!t||1!=t.showall),11!=r.resultType&&(a=!0);var o=e.content;if(o instanceof Array)for(var l=0;l<o.length;l++){var c=o[l];if(a||1==c.acc_flag)if(c.poiType!=s.POI_TYPE_BUSLINE&&c.poiType!=s.POI_TYPE_SUBLINE){var p=n.parseGeo(c.geo);r.points.push(n.getPointByStr(p.points)),r.content.push(c)}else r.transitLines.push(c)}else{if(!o.geo&&o.point){var h=o.point.replace("|",",");o.geo="1|"+h+";"+h+"|"+h,o.poiType=s.POI_TYPE_NORMAL,o.name=o.title,r.isSharePoint=!0}var p=n.parseGeo(o.geo);o.poiType!=s.POI_TYPE_BUSLINE&&o.poiType!=s.POI_TYPE_SUBLINE?(r.points.push(n.getPointByStr(p.points)),r.content.push(o)):r.transitLines.push(o),r.isSingle=!0}return r}},addPoiMarkers:function(e){for(var t=this,i=this.BMap,a=this.map,n=this.mapView,r=[],o=0,c=e.length;c>o;o++)!function(){var c=o,p=new i.Icon(s.MARKERS_PATH,new i.Size(21,30),{anchor:new i.Size(11,30),imageOffset:new i.Size(0,32*c)}),h=new n.CustomMarker(p,e[c],{className:"mkr_trans",isAnimation:!1,click:function(){l.addStat(COM_STAT_CODE.MAP_POI_MARKER_CLICK),t.selectPoiMarker(c+t.transitLines.length)}});a.addOverlay(h),r.push(h)}();return t.poiMarkers=r,t.mapView.poiMarkers=r,r},addGRHotspotsLayer:function(e){var t=this,i=this.mapView;e&&e.result&&e.result.type&&11!=e.result.type&&(t.grControl=i.grControl=o,o.setMapView(i),o.setGRData(e),o.onGRHotspotClick=function(){l.addStat(COM_STAT_CODE.MAP_GR_MARKER_CLICK),t.switchSelectedMarker(-999)})},addCenterPoiMarker:function(e){var t=this,i=this.BMap,a=this.map,n=this.mapView,r=new i.Icon(s.MARKERS_PATH,new i.Size(22,30),{anchor:new i.Size(11,30),imageOffset:new i.Size(29,320)}),o=new n.CustomMarker(r,e,{className:"mkr_trans",click:function(){l.addStat(COM_STAT_CODE.MAP_POI_MARKER_CLICK),t.setCenterMarker(-999)}});return a.addOverlay(o),o.setZIndex(250),this.centerPoiMarker=o,o},removeNbCenterMarker:function(){this.centerPoiMarker&&(this.map.removeOverlay(this.centerPoiMarker),this.centerPoiMarker=null)},addSingleMarker:function(e,t){var i=this.BMap,a=this.map,n=this.mapView,r=new i.Icon(s.MARKERS_PATH,new i.Size(23,32),{anchor:new i.Size(12,32),imageOffset:new i.Size(29,352)}),o=new n.CustomMarker(r,e,{className:"fix_gr_mk",click:function(){l.addStat(COM_STAT_CODE.MAP_POI_MARKER_CLICK),n.iwController.get(s.IW_POI).setData(s.IW_POI,{json:t}).switchTo(0)}});return a.addOverlay(o),o},addTransitPolyline:function(e,t){var i=this,a={qt:"bsl",uid:e.uid,c:e.area};r.fetch(n.jsonToUrl(a),function(e){for(var a=0;a<i.stationMarkers.length;a++)i.removePoiOverlay(i.stationMarkers[a]);for(var r=0;r<i.transitPolylines.length;r++)i.removeTransitPolyline(i.transitPolylines[r]);firstLine=e.content[0];var o=n.parseGeo(firstLine.geo);if(o&&2==o.type){var l=i.addPolyline(o.points,s.ROUTE_TYPE_BUS);i.transitPolylines.push(l)}if(firstLine&&firstLine.stations){i.stationPoints=[],i.stationMarkers=[];for(var c=firstLine.stations,p=0,h=c.length;h>p;p++){var d=n.parseGeo(c[p].geo);if(1==d.type){var f=n.getPoiPoint(d.points);i.stationPoints.push(f);var y=i.addStationMarker(f);i.stationMarkers.push(y)}}}t&&t({firstLine:firstLine,stationPoints:i.stationPoints})})},removePoiOverlay:function(e){var t=(this.BMap,this.map);this.mapView,t.removeOverlay(e),e=null},removeTransitPolyline:function(e){var t=this.BMap,i=this.map;this.mapView;var s=$.inArray(e,this.transitPolylines);s>-1&&this.transitPolylines.splice(s,1),e&&e._decorativePolyline&&e._decorativePolyline instanceof t.Polyline&&(i.removeOverlay(e._decorativePolyline),e._decorativePolyline=null),i.removeOverlay(e),e=null},addPolyline:function(e,t){var i=this.BMap,a=this.map;this.mapView,"undefined"==typeof t&&(t=0);var n=this.polylineStyles[t];if(n){var r={strokeWeight:n.stroke,strokeColor:n.color,strokeOpacity:n.opacity,strokeStyle:n.strokeStyle},o=new i.Polyline(e,r);if(o._routeType=t,a.addOverlay(o),t==s.ROUTE_TYPE_BUS){var l=new i.Polyline(e,{strokeWeight:n.stroke-2,strokeColor:"#fff",strokeOpacity:.3});o._decorativePolyline=l,a.addOverlay(l)}return o}},addStationMarker:function(e){var t=this.BMap,i=this.map,a=this.mapView,n=new t.Icon(s.DEST_MKR_PATH,new t.Size(11,11),{anchor:new t.Size(5,5),imageOffset:new t.Size(80,15)}),r=new a.CustomMarker(n,e,{className:"dest_mkr"});return i.addOverlay(r),r},selectHotspotMarker:function(e){var t=(this.BMap,this.map,this.mapView);o.setMapView(t),o.sendInfRequest(e)},selectPoiMarker:function(e){if(e=parseInt(e,10),!isNaN(e)){var t=(this.BMap,this.map,this.mapView);if(e-=this.transitLines.length,e=Math.min(e,this.poiMarkers.length-1),this._selectedIndex!=e){if(this.clearRoadPolylines(),this.grControl&&this.grControl.marker&&this.grControl.marker.hide(),e>-1){var i=t.iwController.get(s.IW_POI);i.switchTo(e),this.switchSelectedMarker(e);var r=i.getPoiData();r&&r.ty==s.GEO_TYPE_LINE&&this.addRoadPolylines(r),this.setCenterMarker(e)}else{var o=e+this.transitLines.length;this.transitLines[o]&&this.addTransitPolyline(this.transitLines[o],function(e){t.setViewport(e.stationPoints);var i=e.firstLine,r=i.stations[0],o=n.geoToPoint(r.geo);t.iwController.get(s.IW_BSL).setData(s.IW_BSL,{json:[{content:"<b>{0}</b>".format(i.name),uid:r.uid}],points:[{p:o.lng+","+o.lat}]}).switchTo(0),listener.on("infowindow."+s.IW_BSL,"click",function(e,t){var i=t.instance;l.addStat(COM_STAT_CODE.MAP_IW_BSL_DETAIL),a.update({module:"place",action:"detail",query:{foo:"bar"},pageState:{vt:"list",i:i.index}},{trigger:!0,queryReplace:!1,pageStateReplace:!0})})})}this._selectedIndex=e}}},setCenterMarker:function(e){if(this.centerPoiMarker)for(var t=0,i=this.poiMarkers.length;i>t;t++){var s=this.poiMarkers[t]._point,a=this.centerPoiMarker._point,n=s.lat.toString().slice(0,-1),r=s.lng.toString().slice(0,-1),o=a.lat.toString().slice(0,-1),l=a.lng.toString().slice(0,-1);if(n==o&&r==l)return void 0==e||e>-1&&e!=t?(this.centerPoiMarker.setZIndex(200),this.poiMarkers[t].setZIndex(150)):(this.centerPoiMarker.setZIndex(150),this.poiMarkers[t].setZIndex(200)),void 0}},switchSelectedMarker:function(e){if(this.poiMarkers){if(this._selectedIndex>=0){var t=new BMap.Icon(s.MARKERS_PATH,new BMap.Size(21,30),{anchor:new BMap.Size(11,30),imageOffset:new BMap.Size(0,32*this._selectedIndex)});this.poiMarkers[this._selectedIndex]&&(this.poiMarkers[this._selectedIndex]._div.className="",this.poiMarkers[this._selectedIndex].setIcon(t),this.poiMarkers[this._selectedIndex].setZIndex(200))}if(0>e||e>=this.poiMarkers.length)this._selectedIndex=-999;else{var t=new BMap.Icon(s.MARKERS_PATH,new BMap.Size(26,36),{anchor:new BMap.Size(13,36),imageOffset:new BMap.Size(58,40*e)});this.poiMarkers[e]._div.className="mkr_trans",this.poiMarkers[e].setIcon(t),this.poiMarkers[e].setZIndex(300),this._selectedIndex=e}for(var i=0,a=this.poiMarkers.length;a>i;i++)this.poiMarkers[i]._div.className="mkr_trans"}},addRoadPolylines:function(e){var t=this;this.BMap,this.map,this.mapView;var i={qt:"ext",uid:e.uid,c:e.area,l:18};r.fetch(n.jsonToUrl(i),function(e){if(e&&e.content&&e.content.geo){var i=n.parseGeo(e.content.geo);if(2==i.type)if("string"==typeof i.points)t.roadPolylines.push(t.addPolyline(i.points));else for(var s=0,a=i.points.length;a>s;s++)i.points[s]&&t.roadPolylines.push(t.addPolyline(i.points[s]))}})},clearRoadPolylines:function(){if(this.roadPolylines){for(var e=0,t=this.roadPolylines.length;t>e;e++)this.removeTransitPolyline(this.roadPolylines[e]),this.roadPolylines[e]=null;this.roadPolylines=[]}}}});
;define("place:widget/hotelextcomment/hotelextcomment.js",function(t,o,e){var n=t("common:widget/stat/stat.js"),i=t("common:widget/url/url.js");e.exports={init:function(){this.commentCfg={perCount:5,loadCount:0,totalCount:$(".detail-comlist dt").size(),maxCount:25},this.bindEvent()},bindEvent:function(){$("#detail-loadcomment").on("click",$.proxy(this._showMoreCmts,this)),$("#detail-commore").on("click",$.proxy(this._gotoMoreComment,this))},_showMoreCmts:function(){var t,o=this,e=o.commentCfg;e.loadCount++,$.each([".detail-comlist dt",".detail-comlist dd"],function(t,o){$(o).slice(e.perCount*e.loadCount,e.perCount*(e.loadCount+1)).show()}),(e.loadCount+1)*e.perCount>=e.totalCount&&($("#detail-loadcomment").off().remove(),document.body.clientLeft,(t=$("#detail-commore"))&&t.show()),n.addStat(STAT_CODE.PLACE_HOTEL_DETAIL_SHOWCOMMENT_CLICK)},_gotoMoreComment:function(t){var o=$(t.currentTarget).data("href");i.navigate(this._filter(o))},_filter:function(t){return t.replace(/cmark=1&?/i,"")}}});
;define("place:widget/hotelextimg/hotelextimg.js",function(t,o,e){e.exports={init:function(){"use strict";$(".hotel-img").on("click",$.proxy(this.gotoPhotoDetail,this))},gotoPhotoDetail:function(t){"use strict";t.preventDefault(),t.stopPropagation();var o=$(t.currentTarget).data("href");o&&(window.location=o)}}});
;define("place:widget/icomment/icomment.js",function(t,e,o){var n=t("common:widget/login/login.js"),s=t("common:widget/popup/popup.js"),i=t("common:widget/stat/stat.js"),a=t("common:widget/url/url.js");o.exports={msg:{netError:"发送失败请检查网络连接后重试",nocontentError:"评论内容不能为空"},init:function(){$("#J_impression li").on("click",$.proxy(this.switchScores,this)),$("#J_submitComment").on("click",$.proxy(this.submitComment,this))},switchScores:function(t){var e;(e=$(t.target).closest("li"))&&($("#J_impression li").removeClass("active"),e.addClass("active"))},submitComment:function(){var t=this,e=t._getContent(),o=t._getScore(),s=t.msg,a=$("#J_addComment");i.addStat(STAT_CODE.PLACE_COMMENT_ICOMMENT_SUBMITCLICK),n.checkLogin(function(i){i.status?o&&e?$.ajax({type:"post",url:"/mobile/webapp/place/icomment/force=simple",data:{uid:a.data("uid"),content:e,score:o},dataType:"json",success:function(e){t._addCommentSuccess(e)},error:function(){t.showMessage(s.netError)}}):t.showMessage(s.nocontentError):n.loginAction()})},_getScore:function(){var t=$("#J_addComment");return t.find(".active").attr("value")},_getContent:function(){return $("#J_commentContent").val()},_addCommentSuccess:function(t){var e=this,o=$("#J_addComment");0===parseInt(t.status)?(i.addStat(STAT_CODE.PLACE_COMMENT_ICOMMENT_SUBMITSUCCESS),e.showMessage(t.msg),setTimeout(function(){a.navigate(e.addCommentMark(o.data("url")))},2e3)):e.showMessage(t.msg)},showMessage:function(t,e){s.open({text:t,autoCloseTime:e||2e3})},addCommentMark:function(t){return t+="&cmark=1"}}});
;define("place:widget/listopbanner/listtopbanner.js",function(n,t,e){var i=function(){this.init()};i.prototype={init:function(){this.$el=$("#place-widget-listtopbanner"),this.getBannerData()},getBannerData:function(){$.ajax({url:"/detail?qt=mcdkey&act=advert&from=webapp",type:"GET",dataType:"json",context:this,success:function(n){var t=n?$.isArray(n.list)?n.list[0]:null:null;t&&this.render(t)}})},render:function(n){var t=this.$el.find(".bg"),e=this.$el.find(".banner");t.css("background-color",n.background_color||"#ffffff"),e.css({"background-image":"url("+n.image_url+")","background-position":"center"}),e.attr("href",n.link_url),this.$el.show()}},e.exports.init=function(){return new i}});
;define("place:widget/listtool/listtool.js",function(t,i,e){var o=function(){var i=$(".place-widget-listtool"),e=i.find(".select-btn");e.on("click",function(){var e=e=t("common:widget/stat/stat.js"),o=$(".common-widget-nav .title span").text();!$(this).hasClass("up")&&e.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_CLICK,{wd:o}),$(this).toggleClass("up"),i.toggleClass("hide-extend")})};e.exports.init=o});
;define("place:widget/mcodeskey/mcodeskey.js",function(o,t,e){function n(){var o=s.getCityCode()||1;s.hasExactPoi()&&(f.point_x=s.getPointX(),f.point_y=s.getPointY(),f.city_id=o)}function i(o){var t=new RegExp("(^|&)"+o+"=([^&]*)(&|$)","i"),e=window.location.href.substr(1).match(t);return null!==e?decodeURIComponent(e[2]):null}function c(){$("#exchange").click(function(){var o=i("code"),t=i("sign");if(f.city_id)var e="&"+$.param(f);else var e="";d.addStat(STAT_CODE.PLACE_CODES_PV,{state:"codesreport"}),location.href=l+"/mobile/webapp/place/codes/force=simple&qt=city&code="+o+"&sign="+t+e})}function a(){$("#banner").click(function(){location.href=l+"/mobile/webapp/search/search/foo=bar&qt=s&wd=电影院&c=131&searchFlag=sort/center_name=北京市"})}function r(){n(),a(),c()}var s=o("common:widget/geolocation/location.js"),d=o("common:widget/stat/stat.js"),l="http://"+window.location.host,f={};e.exports={initialize:r}});
;define("place:widget/movielist/movielist.js",function(t,i,e){var a=t("common:widget/url/url.js");t("common:static/js/util.js");var n,o=t("common:widget/stat/stat.js"),l=$(".common-widget-nav .title span").text(),c=function(){var t=$("#place-widget-movielist-showall");t.on("click",d)},s=function(){$pageNav=$(".place-widget-movielist .page-btn"),$.each($pageNav,function(t,i){var e=$(i);e.on("click",function(t){var i=$(t.target),e=i.data("type"),n=i.data("url");o.addCookieStat(STAT_CODE.PLACE_LIST_PAGE_CHANGE,{wd:l,type:e}),i.hasClass("unclick")||a.navigate(n,{replace:!0})})})},d=function(){var t=$(".place-widget-movielist .place-list"),i=$(".place-widget-movielist .pagenav"),e=$("#place-widget-movielist-showall");e.hide(),t.removeClass("acc-list"),i.show(),o.addStat(STAT_CODE.PLACE_MAINRES_OPEN)},v=function(){var t=$(".place-widget-movielist");t.on("click","li",function(t){var i=$(this),e=i.data("href"),c=i.find(".rl_li_title").text(),s=n&&n.isGenRequest,d=t.target;"a"!==d.tagName.toLowerCase()&&(s=1==s?1:0,o.addCookieStat(STAT_CODE.PLACE_LIST_CLICK,{wd:l,name:c,is_gen:s},function(){a.navigate(e)}))})},g=function(t){n=t},m=function(){c(),s(),v()},r=function(t){g(t),m()};e.exports.init=r});
;define("place:widget/movienews/movienews.js",function(require,exports,module){function getOrientation(){var e=window.outerWidth>0?window.outerWidth>window.outerHeight?90:0:document.body.offsetWidth>document.body.offsetHeight?90:0;return e}function formatDate(e){return e.getFullYear()+"-"+(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())}function formateDateText(e,t){var a=["周日","周一","周二","周三","周四","周五","周六"];return e&&e instanceof Date?0==e-t?"今天":864e5==e-t?"明天":1728e5==e-t?"后天":a[e.getDay()]:""}function Schedules(e,t){var a={".btn-more":this.showMore,".btn-close":this.showSpecific,".btn-book":this.bookMovie,".calendar_tab li":this.switchTab,".cover-pic":this.showMovieInfo,".movieDes":this.showDesPopup,".show-info":this.showCompare};this.elePlaceMovie=$("div.place-widget-movienews"),this.now=e,this.uid=t;for(var i in a)this.elePlaceMovie.delegate(i,"click",$.proxy(a[i],this))}require("place:static/lib/template.js");var util=require("common:static/js/util.js"),stat=require("common:widget/stat/stat.js"),iScroll=require("common:static/js/iscroll.js"),DETAILTPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="cover">    <div id="cover-wrapper" class="cover-wrapper">        <div id="cover-scroller" class="cover-scroller">            ');for(var j=0,len=imgs.length;len>j;j++)_template_fun_array.push('            <img class="cover-pic needsclick" width="69" height="84" data-id="',"undefined"==typeof imgs[j].id?"":baidu.template._encodeHTML(imgs[j].id),'" data-date="',"undefined"==typeof imgs[j].day?"":baidu.template._encodeHTML(imgs[j].day),'" src="http://map.baidu.com/maps/services/thumbnails?width=96&height=128&quality=100&src=',"undefined"==typeof imgs[j].url?"":baidu.template._encodeHTML(imgs[j].url),'" style="display:',"undefined"==typeof imgs[j].visible?"":baidu.template._encodeHTML(imgs[j].visible),'" alt="',"undefined"==typeof imgs[j].title?"":baidu.template._encodeHTML(imgs[j].title),'">            '),imgs[j].newm&&_template_fun_array.push('            <span class="new_icon" style="display:',"undefined"==typeof imgs[j].labelvis?"":baidu.template._encodeHTML(imgs[j].labelvis),'"></span>            '),_template_fun_array.push("            ");_template_fun_array.push('        </div>    </div></div><p class="info-tip"><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAYEBAQFBAYFBQYJBgUGCQsIBgYICwwKCgsKCgwQDAwMDAwMEAwODxAPDgwTExQUExMcGxsbHCAgICAgICAgICD/2wBDAQcHBw0MDRgQEBgaFREVGiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICD/wAARCABZANADAREAAhEBAxEB/8QAGwABAAIDAQEAAAAAAAAAAAAAAAEEAwUGAgj/xABHEAABAwIDAwUKCQsFAAAAAAABAAIDBBEFEiETIjEGFEFRcRUWMlJhgZPR0tMjQlRVkZKUo8EkQ0RTYnKDocPh4zNksbKz/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAECAwT/xAAiEQEAAwACAQQDAQAAAAAAAAAAAQIRAyESBDFBUSIyYUL/2gAMAwEAAhEDEQA/APqlAQFAQEBAQEBAQEBQEBAQEBUEBAQEBAQEBAVBAUBAQEBAQEBQEBAQEBAQEBAQEBUEBAQEBAQEBAQEBAQFAQEBBF1AQEBAQQ5wa0ucbNGpJ6kHOycp6momhgpKbKysfsoahzxnAP53ZWNwG71r9tl5OP1tL8nhGu88ExGy6RexwEBAQFQQEBAQEBAQEBAUBAQQoKkmKUUcj43POeM2cAx51tfoB6ChjLSVdNVw7aneJI7kXHWOIIOoKDMgICAgwV1DTV1M6mqWl8L/AAmgube3laQVMWFCl73qCaQQubzhu5K8l0sg/ZLjmI7FinHWv6xi2tM+7ZxSxzRiSJ2ZjuDgujL2gm6AqCAgKggICAgICAoCCFBr8bk2dKx5zFolZnYxxY5wOlgQQfKiw1nPaR36LP55n+2itXiDny1VOaKmkp2RTZ6wFhk27Mvghxdp2orYUtTSOY7Z4QYBmN2vBbc9dvxRGXbQ/N0Z7c/sFA20XzbF957tA20fRhzPNtfdoG3Z83/+vsoG2Z83n731INTiLKmqh2WH0EmHStma6ScQZ9o0HeGvjdaK2kM8ZjB7kuj47rmPB4+QdPFEe4ntdWUuWlFMRKPhLPF907uo6UHQoyIJVBAQFQQEBAQFAQQoCCli9xRFzfDD48js2XKS8DNezuF+pFhS5ti/TV/fN9yqMZpMezkjEGhhtlbnGnXrskGF9Bj8lO+KorjI64dG+GSNti0hzb5otd4IrXw4tygpdmzF5Zr6MklijYxjSfjF2V7C3y3XCvJyeWTXI+25rXOpbrJiv62f0lP7C79uaNnix/PS+lg90p2pscV+USD+NF7lO0QYsVH6UfPOz8IFRXbT44HvMuJMLCfg27S1h5fgtVFI469rLT10bn63cJS3p002fUgyUjQcRpWmobObuflbJmtlYd4jKPGQdAoyKgglUEBUEBAQFAQQVAQFBUxYE4ZVWbnOydZhbnvp4ut+xFaLm+B+M77GPdK9Kwmj5OmZxM8u0s3NGKYaDW27stLp0PNDR8mwx4p5ppwHnOTTbSzvFvstOxOha5rg3izfYh7lOhHNcH8Sf7H/AIk6E80wvojmPbRf41OhPM8N/Uznsox+MavQjmeH9EFX9ljH9JToUKel5PPlnNPFWPkD7T/B8Ha6eBp5k6VdoqXD2wDm1LVuiu626OOY5uLR8a6qNjhUcorJHCKaGBsYAE2XeeXG9ra7oH81EbdARBUEEqggKggICgIIUBAUVSxHFqHD2B1TJZzvAiaM0jv3WDUoKDeV2Gk2EVT6JyLio/Hac18s4hnMb442i0Zvdhff/sEMV8AxZlAysE8FQdtUOmjyxk7ruv6EG076qP5NV+hPrUww76aT5LV+i/umGK0/LnC4H7N8FSJNNzIL3dwHHiehTY3PlfGVnvlb8hqfqt9a1iYd8v8AsKj6G+tMMaahramlqq2V1DIWVM20ZqBYXJ1+lMFug5Rc0pGwyUr84Lyd5tt55d09qYYynlhEONOG/vStHrQxs8JxqkxKN2yOWeO22gJBc2/DUaEHoIRGxQEQVEqggKggICgIIUBQaHGsenilloqFuSojy7SplZI6NubWzcjXZnZfMEac+6KOR+1qeazzkWdPM2oLz57Cw8g0VVLXUMJaM1DHmNmi02p6hdqCy2oh/WUvopT/AEymo9CdnRJT28kMvuVdEtlgvvCJ3ZDN7hNHq9OeEIPZBN7hNFWnw2iiOkE8jM20ET453sz+NYxC57brjHDTy8s/JvznM+F0hlt2i18tM8/8sC66w873yPL2UfrsmjG6lD+NM77Cz8SmjycPB8GCQHo/IIPxcminQthr2Okoqh1Qxjix7oqKkIDhxHhJqrTaCvjmjnikqo5ojdrmUlM246Wuyvbdp6QiOlwjEpqtskdTCaeqhtnYbWc13gvbYusDY6HgojYoCqAQSqCAqCgIIKgICitfNhJdUyzxVcsJmIc9jRGW3DQ347HHgOtB47mVvRiMno4fZUHG4hFX18sM9ZIyY4fUSPo3mMbrmPMYdo4XuBquc2VeocUxyonqI3VrRsshBELdc9/L5FuvaNjROxOeoljmr9nG1rDHJs4xmJJzDW/CwVF8YfVu4Yo49kcXqUHvuTV9OIy+ZkPsFBPcd/TX1P3Q/ppodxj8vqvrR+wgxuwyFvhYlUD+JH7KGqFfTkOi5riVRYX2ozMPRpqWdaprTzz4q3EHU8dfUFojY8asvdznA/E/ZWbTgxUVLV0UkMUE8lPTzVLNs2MRNBMrwHO3WcTfisxZXX9xmnUV1SfLnb7K3AzUeGR0s759tLNI9ojJlcDZrSSLWA6XLSLyAqgglUEBUEBMBTBhqZ208Jle17mttpG1z3am3gtuUwabE+U1RT0e1o8Kq6qpe7LDTmN0eYDwiXWdk0BtmGq5zM/RrlsQ5R8qqWpEmH4fiBgmMjZIZ6cucHPawsscxF2uu3xbLy8dLU33nZdOXk8s6zIe3cpuUTGPifgdacmjnwBzmiS+8bFrcwbfj09CvHWaVyIlztebLtBQ18OF0wmppZHujDpQ1tzmdvO07SukxP0TLkajvtqMWbsMHqxDC8S5WsMTniMnZ5tpoP8AV61i1bT0OojrsaELRJg1a+czbNx2Ya0N0u86k2trp2LXBW9a5b3avMTLZOFQ3LakqHZgHC0R6evqPkXfGVoYfiFgdm4X1tcX8+qviJFBiN7ZHfW/uniPQwzEHXu0+d3908REuF1cTS7JmDfF1P0cVJglpcQr8QghJo8Lq6uo+IzZPay4IFnEi+t+IXO3l1kdClyXouUUhrJMSpJ4pdps4hLq4xh73DXpAz2BU/KVXsbp8Qiw2aSOknlkZZ7WxN3rxkP0+qszE/RuJ5PY3ytLxFX4NUU7Do3daWcLkmxu29lj0/Dak5/j4/jpfki0f11NBXy1TiHUksDR8aUZf5GxXsxzXrJiFlcBMEq4CYCoICAgICAgICAgICAgICAgICAgICAgICAgIP/Z" /><br>暂无当日排期...</p><div class="info '),book||_template_fun_array.push("info-unbook"),_template_fun_array.push('">    '),book&&_template_fun_array.push('    <div class="list-opt">        <button id="btnMovieBookMore" class="btn-more">查看更多影讯<i class="icon-arrow"></i></button>        <button id="btnMovieBookClose" class="btn-close">收起<i class="icon-arrow"></i></button>    </div>    '),_template_fun_array.push("</div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],TABSTPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="tab"><div id="tab_wrapper" class="tab_wrapper"><ul class="calendar_tab">    ');for(var i=0,len=days.length;len>i;i++)_template_fun_array.push('    <li data-date="',"undefined"==typeof days[i].date?"":baidu.template._encodeHTML(days[i].date),'" data-text="',"undefined"==typeof days[i].text?"":baidu.template._encodeHTML(days[i].text),'" '),0==i&&_template_fun_array.push('class="current"'),_template_fun_array.push(" "),days[i].disabled&&_template_fun_array.push('class="disabled"'),_template_fun_array.push(">","undefined"==typeof days[i].text?"":baidu.template._encodeHTML(days[i].text),"</li>    ");_template_fun_array.push("</ul></div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],INFOTPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<dl>    <dt><em class="tit">',"undefined"==typeof name?"":baidu.template._encodeHTML(name),"</em> "),parseInt(score)>0&&_template_fun_array.push('<em class="sco"> ',"undefined"==typeof score?"":baidu.template._encodeHTML(score),"</em>"),_template_fun_array.push('<em data-id="',"undefined"==typeof id?"":baidu.template._encodeHTML(id),'" class="movieDes des">影片简介&gt;&gt;</em></dt>    <dd>        ',"undefined"==typeof times?"":baidu.template._encodeHTML(times),"    </dd></dl>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],TIMETPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<ul class="show-list '),schedules.length>4&&_template_fun_array.push("part"),_template_fun_array.push('">');for(var j=0,len=schedules.length;len>j;j++){if(_template_fun_array.push('<li class="show-item '),0==j&&schedules[j].book&&schedules[j].seatL&&_template_fun_array.push("expand"),_template_fun_array.push('"><div class="show-info"><span class="meta"><em class="time">',"undefined"==typeof schedules[j].time?"":baidu.template._encodeHTML(schedules[j].time),"</em>","undefined"==typeof schedules[j].type?"":baidu.template._encodeHTML(schedules[j].type),'</span><span class="meta-extend"><i class="icon-price">&yen;</i>',"undefined"==typeof schedules[j].price?"":baidu.template._encodeHTML(schedules[j].price),"起"),schedules[j].url?_template_fun_array.push('<a class="btn-exchange" href="',"undefined"==typeof schedules[j].url?"":baidu.template._encodeHTML(schedules[j].url),'">兑换码</a>'):_template_fun_array.push('<i class="icon-arrow"></i>'),_template_fun_array.push("</span></div>"),schedules[j].seatL){_template_fun_array.push('<ul class="compare-list">');for(var i=0,leng=schedules[j].list.length;leng>i;i++)_template_fun_array.push('<li><span class="brand">',"undefined"==typeof schedules[j].list[i].src_name?"":baidu.template._encodeHTML(schedules[j].list[i].src_name)," "),0==i&&leng>1&&_template_fun_array.push('<i class="icon-sheap"></i>'),_template_fun_array.push("</span>"),schedules[j].list[i].price&&_template_fun_array.push('<span class="price"><i class="icon-price">&yen;</i>',"undefined"==typeof schedules[j].list[i].price?"":baidu.template._encodeHTML(schedules[j].list[i].price),"</span>"),_template_fun_array.push('<span class="opt"><a class="btn-book ',"undefined"==typeof schedules[j].style?"":baidu.template._encodeHTML(schedules[j].style),'" data-day="',"undefined"==typeof schedules[j].day?"":baidu.template._encodeHTML(schedules[j].day),'" data-num="',"undefined"==typeof schedules[j].list[i].seq_no?"":baidu.template._encodeHTML(schedules[j].list[i].seq_no),'" data-cinema="',"undefined"==typeof schedules[j].list[i].cinema_id?"":baidu.template._encodeHTML(schedules[j].list[i].cinema_id),'" data-theater="',"undefined"==typeof schedules[j].theater?"":baidu.template._encodeHTML(schedules[j].theater),'" data-time="',"undefined"==typeof schedules[j].time?"":baidu.template._encodeHTML(schedules[j].time),'" data-price="',"undefined"==typeof schedules[j].list[i].price?"":baidu.template._encodeHTML(schedules[j].list[i].price),'" data-movie="',"undefined"==typeof schedules[j].list[i].movie_id?"":baidu.template._encodeHTML(schedules[j].list[i].movie_id),'" data-info="',"undefined"==typeof schedules[j].info?"":baidu.template._encodeHTML(schedules[j].info),'" data-orign="',"undefined"==typeof schedules[j].list[i].src?"":baidu.template._encodeHTML(schedules[j].list[i].src),'">选座订票</a></span></li>');_template_fun_array.push("</ul>")}_template_fun_array.push("</li>")}_template_fun_array.push("</ul>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],POPUPTPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="moviebook-popup-wrapper"><div class="moviebook-popup"><div class="header">',"undefined"==typeof title?"":baidu.template._encodeHTML(title),'院线购票手机验证<a href="javascript:void(0);" id="valid-btn-close" class="btn-close"></a></div><div class="content"><p><label>手机号:&nbsp;</label><input id="valid-phone" autocomplete="false" type="tel"><span class="tip"></span></p><p><label>验证码:&nbsp;</label><input id="valid-number" autocomplete="false" type="text"><img src=""><span class="tip"></span></p><p><button id="valid-btn-submit" class="submit-btn" type="button">提交</button></p></div></div></div>'),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],DESPOPUPTPL=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<div class="moviebook-popup-wrapper"><div class="moviedes_popup"><div class="header">',"undefined"==typeof name?"":baidu.template._encodeHTML(name),""),parseInt(score)>0&&_template_fun_array.push('<span class="sco"> ',"undefined"==typeof score?"":baidu.template._encodeHTML(score),"</span>"),_template_fun_array.push('<a href="javascript:void(0);" id="des-btn-close" class="btn_close"> X </a></div><div class="content" style="text-align:left;"><style>table.des td{vertical-align: top;}</style><table class="des"><tr><td width="45"><span class="name">版本</span>:</td><td><span>',"undefined"==typeof(type||"暂无")?"":baidu.template._encodeHTML(type||"暂无"),'</span></td></tr><tr><td><span class="name">片长</span>:</td><td><span>',"undefined"==typeof(duration||"暂无")?"":baidu.template._encodeHTML(duration||"暂无"),'</span></td></tr><tr><td><span class="name">上映</span>:</td><td><span>',"undefined"==typeof(release||"暂无")?"":baidu.template._encodeHTML(release||"暂无"),'</span></td></tr> <tr><td><span class="name">地区</span>:</td><td><span>',"undefined"==typeof(nation||"暂无")?"":baidu.template._encodeHTML(nation||"暂无"),'</span></td></tr><tr><td><span class="name">导演</span>:</td><td><span>',"undefined"==typeof(director||"暂无")?"":baidu.template._encodeHTML(director||"暂无"),'</span></td></tr><tr><td><span class="name">主演</span>: </td><td><span>',"undefined"==typeof(players||"暂无")?"":baidu.template._encodeHTML(players||"暂无"),'</span></td></tr><tr><td colspan="2"><span class="name">简介</span>: <p style="padding:6px 0 0;">',"undefined"==typeof(des||"暂无")?"":baidu.template._encodeHTML(des||"暂无"),"</p></td></tr></table></div></div></div>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];Schedules.prototype.renderFailInfo=function(){this.elePlaceMovie.find(".movienews-loading").text("暂无影讯数据！")},Schedules.prototype.renderMovieNews=function(e,t){function a(e){var t=[];return $.each(e,function(e,a){var i={url:a.movie_picture||"",id:a.movie_id||"",title:a.movie_name||"",day:"",newm:!1};$.each(l,function(e,t){for(var o=0;o<t.length;){if(a.movie_id==t[o].movie_id){i.day+="d"+e,i.newm=(new Date).getTime()-new Date(a.movie_release_date).getTime()<2592e5;break}o++}}),i.visible=i.day.match(/0/)?"block":"none",i.labelvis="block"==i.visible?"inline-block":"none",t.push(i)}),t}function i(t,a){var i={},o=[],r=[];return $.each(s,function(e,a){a.movie_id==t&&(i=a)}),i&&(i={name:i.movie_name||"",id:i.movie_id||"",duration:i.movie_length&&i.movie_length.toString().replace("分钟","")+"分钟"||"",category:(i.movie_nation?i.movie_nation+"&nbsp;&nbsp;":"")+(i.movie_type||""),director:i.movie_director||"",players:i.movie_starring||"",score:i.movie_score||"",des:i.movie_description||"",pic:i.movie_picture||"",release:i.movie_release_date||""}),$.each(l,function(e,t){t[0].date==a&&(o=t)}),$.isArray(o)?($.each(o,function(t,a){if(i.id==a.movie_id){var o={day:a.date,seatL:!0,book:2==e.webview_style?!1:!0,time:a.time||"",type:a.src_info[0].lan&&a.src_info[0].type?a.src_info[0].lan+"/"+a.src_info[0].type:(a.src_info[0].lan||"")+(a.src_info[0].type||""),price:a.lower_price,style:a.src_info[0].seq_no&&!a.src_info[0].src.match(/dbmovie|mtime/g)?"":"unbook",num:a.src_info[0].seq_no,orign:a.src_info[0].src,cinema:a.src_info[0].cinema_id,theater:a.src_info[0].theater,movie:a.src_info[0].movie_id,name:a.src_info[0].movie_name||i.name,info:"{'lan':'"+a.src_info[0].lan+"','time': '"+a.time+"','price': '"+a.src_info[0].price+"','name': '"+i.name+"'}",list:a.src_info};a.src_info[0].aid&&(o.url=n.createCodeUrl(o,i),o.seatL=!1),r.push(o)}}),i.times=TIMETPL({schedules:r}),i.date=a,i.from=o[0].src_info[0].src,INFOTPL(i).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#92;/g,"\\").replace(/&quot;/g,'"').replace(/&#39;/g,"'")):void 0}function o(e,t){var a=n.eleInfo.length?n.eleInfo:n.elePlaceMovie.find(".info");$("#btnMovieBookClose");var o,s=n.elePlaceMovie.find(".calendar_tab li.current").attr("data-date"),l="#info_"+e+"_"+s;"block"!=$(l).css("display")&&(0==$(l).length&&(o=i(e,s),$(o).prependTo(a).attr("id",l.substr(1))),$("div.cover").find("img[style='display:block']").removeClass("selected").eq(t).addClass("selected"),a.children().hide().filter(l).attr("style",function(){return r.book&&$(this).find("li.show-item").length>4?(a.find(".list-opt").data("id",l).show(),$(this).find("ul.show-list").data("statue")?($("#btnMovieBookMore").hide(),$("#btnMovieBookClose").show()):($("#btnMovieBookMore").show(),$("#btnMovieBookClose").hide())):a.find(".list-opt").data("id",l).hide(),"display: block"}))}var n=this,s=$.isArray(e.base)&&e.base.length>0?e.base:[],l=$.isArray(e.time_table)&&e.base.length>0?e.time_table:[],r={date:{},imgs:[],book:2==e.webview_style?!1:!0,days:[]};wrapperWidth=0,date=new Date,now=e.now_time||date.getFullYear()+"-"+(date.getMonth()<9?"0"+(date.getMonth()+1):date.getMonth()+1)+"-"+(date.getDate()<10?"0"+date.getDate():date.getDate()),contentTpl="",tabsTpl="",days={},this.orign=l[0][0].src_info[0].src,this.name=t,n.arrMovies=s,n.lastOrientation=lastOrientation=-1,$.each(l,function(e,t){var a=new Date(t[0].date.split("-")[0],parseInt(t[0].date.split("-")[1],10)-1,t[0].date.split("-")[2],"00","00","00"),i=t[0].date.replace(/-/g,".").replace(/^[0-9]*./g,"");days[formatDate(a)]=e,r.days[e]={text:i+" "+formateDateText(a,new Date(now.split("-")[0],parseInt(now.split("-")[1],10)-1,now.split("-")[2],"00","00","00")),date:t[0].date,obj:a}}),function(e,t){for(var a,i,o=0,n=e.length;e.length<3;)(a=e[e.length-1].obj)&&a.setDate(a.getDate()+1),i=a.getFullYear()+"-"+(a.getMonth()<9?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+(a.getDate()<10?"0"+a.getDate():a.getDate()),e[n+o]={text:a.getMonth()+1+"."+a.getDate()+" "+formateDateText(a,new Date(t.split("-")[0],parseInt(t.split("-")[1],10)-1,t.split("-")[2],"00","00","00")),date:i,obj:a,disabled:!0},o++}(r.days,now),this.days=days,r.imgs=a(s),contentTpl=DETAILTPL(r),tbsTpl=TABSTPL(r),n.elePlaceMovie.find(".movienews-content").append(tbsTpl).append(contentTpl).show().removeClass("movienews-empty").next().remove(),n.eleCover=this.elePlaceMovie.find(".cover"),n.eleInfo=n.elePlaceMovie.find(".info"),n.eleInfotip=n.elePlaceMovie.find(".info-tip"),l.length>3&&$(".tab_wrapper").width()<75*l.length+8&&($(".tab_wrapper").addClass("slide").find(".calendar_tab").width(75*l.length+12),n.tabScroll=new iScroll("tab_wrapper",{momentum:!1,hScroll:!0,hScrollbar:!1,vScrollbar:!1,vScroll:!1,lockDirection:!0,handleClick:!1})),n.elePlaceMovie.find(".cover-scroller").css({display:"block"}),n.coverScroll=new iScroll("cover-wrapper",{snap:!0,momentum:!1,hScrollbar:!1,vScrollbar:!1,vScroll:!1,lockDirection:!0,onScrollEnd:function(){var e=n.eleCover.find("img[style='display:block']"),t=e.eq(n.coverScroll.currPageX),a=t.data("id");return 0==e.length?(n.elePlaceMovie.addClass("movienews-empty"),!1):(o(a,n.coverScroll.currPageX),void 0)}}),$("div.cover").find("img[style='display:block']").length?this.updateLayout(0):this.elePlaceMovie.toggleClass("movienews-empty",!0)},Schedules.prototype.updateLayout=function(e){var t=$("div.cover").width(),a=this,i=$(".tab_wrapper"),o=i.find("li").length,n=$("div.cover").find("img[style='display:block']").length,s=69,l=a.lastOrientation;window.orientation=getOrientation(),$("#cover-wrapper").css({overflow:"visible",width:s+13,right:3*t/4-s/2-13}),$("#cover-scroller").css("width",(s+13)*n),a.coverScroll.refresh(),"undefined"!=typeof e&&e>-1&&this.coverScroll.scrollToPage(e,0,0),window.setTimeout(function(){window.orientation=getOrientation(),i.width()<75*o+8?(a.tabScroll||(i.addClass("slide").find(".calendar_tab").width(75*o+8),a.tabScroll=new iScroll("tab_wrapper",{momentum:!1,hScroll:!0,hScrollbar:!1,vScrollbar:!1,vScroll:!1,lockDirection:!0,handleClick:!1})),window.orientation!=l&&a.tabScroll.scrollToPage(i.find(".current").index(),0,0)):a.tabScroll&&(i.removeClass("slide").find(".calendar_tab").width("auto"),a.tabScroll.destroy(),delete a.tabScroll),window.orientation!=l&&(a.lastOrientation=window.orientation)},100)},Schedules.prototype.switchTab=function(e){var t,a=$(e.target),i=[],o=a.index();return a.hasClass("current")?!1:a.hasClass("disabled")?!1:(stat.addStat(STAT_CODE.PLACE_MOVIE_TAB_CLICK,{day:o}),a.addClass("current").siblings().removeClass("current"),this.eleCover&&this.eleCover.length&&(this.eleCover.find("img").each(function(e,t){var a=$(t),n=a.data("date"),s=!0;a.removeClass("selected"),-1!=n.indexOf("d"+o)?(a.attr("style","display:block"),0==e&&a.addClass("selected"),a.next().hasClass("new_icon")&&a.next().show()):(a.attr("style","display:none"),a.next().hasClass("new_icon")&&a.next().hide(),s=!1),s&&i.push(a)}),t=0==i.length?!0:!1,this.elePlaceMovie.toggleClass("movienews-empty",t),t||this.updateLayout(0)),void 0)},Schedules.prototype.showDesPopup=function(e){stat.addStat(STAT_CODE.PLACE_MOVIE_DESCRIBTION_CLICK);var t,a,i,o=$(e.target).attr("data-id"),n=this.arrMovies,s=$(".moviebook-popup-wrapper");$.each(n,function(e,t){t.movie_id==o&&(a=t)}),a.movie_starring&&(t=a.movie_starring.split("/").slice(0,4).join("、")),i=a.movie_description.length>180?a.movie_description.slice(0,180)+"...":a.movie_description,a={name:a.movie_name||"",id:a.movie_id||"",duration:a.movie_length&&a.movie_length.toString().replace("分钟","")+"分钟"||"",nation:a.movie_nation,type:a.movie_type,director:a.movie_director||"",players:t,score:a.movie_score,des:i,release:a.movie_release_date},popupHtml=DESPOPUPTPL(a),$(popupHtml).prependTo("#wrapper").show().children().first().css("top",window.scrollY+$(window).height()/3),$("body").height()<window.screen.height&&s.height(window.screen.height),$("#des-btn-close").click($.proxy(this.closePopup,this))},Schedules.prototype.showMovieInfo=function(e){var t=this,a=$(e.target),i=t.elePlaceMovie.find(".cover"),o=-1;i.find("img[style='display:block']").each(function(e,t){$(this).removeClass("selected"),a.data("id")==$(t).data("id")&&($(this).addClass("selected"),o=e)}),o>-1&&o!=t.coverScroll.currPageX&&(stat.addStat(STAT_CODE.PLACE_MOVIE_PIC_CLICK),window.setTimeout(function(){t.coverScroll.scrollToPage(o,0)},0))},Schedules.prototype.showMore=function(e){var t=$(e.target).parent().data("id"),a=$(t),i=a.find("ul.show-list");i.toggleClass("part").data("statue",!0),$("#btnMovieBookMore").hide(),$("#btnMovieBookClose").show(),stat.addStat(STAT_CODE.PLACE_MOVIE_BOOK_LIST_MORE_CLICK)},Schedules.prototype.showSpecific=function(e){var t=$(e.target).parent().data("id"),a=$(t),i=a.find("ul.show-list");i.toggleClass("part").data("statue",!1),$("#btnMovieBookMore").show(),$("#btnMovieBookClose").hide(),document.body.scrollTop=$("#place-pagelet-movienews").position().top+125,stat.addStat(STAT_CODE.PLACE_MOVIE_BOOK_LIST_LESS_CLICK)},Schedules.prototype.bookMovie=function(e){var t=$(e.target);if("A"!=e.target.tagName)return!1;if(e.preventDefault(),t.hasClass("unbook"))return e.stopImmediatePropagation(),!1;var a="/detail?",i={uid:this.uid,date:t.attr("data-day"),seq_no:t.attr("data-num"),cinema_id:t.attr("data-cinema"),cinema_name:this.name,cc_time:t.attr("data-time"),movie_id:t.attr("data-movie"),third_from:t.data("orign"),theater:t.data("theater"),ticket_price:t.data("price"),movie_info:t.attr("data-info").replace(/\'/g,'"')},o=a+"qt=movie&act=select&from=webapp&"+$.param(i);return i.third_from.match(/gewala|wanda|spider/g)?(this.renderValidPopup(o),e.stopImmediatePropagation(),!1):(stat.addStat(STAT_CODE.PLACE_MOVIE_BOOK_CLICK,{from:t.data("orign"),uid:this.uid}),window.setTimeout(function(){window.location.href=o},200),e.stopImmediatePropagation(),void 0)},Schedules.prototype.showCompare=function(e){if($("div.info").hasClass("info-unbook"))return!1;stat.addStat(STAT_CODE.PLACE_MOVIE_COMPARE_LIST_CLICK);var t=$(e.currentTarget).parent(),a=t.find("a").text();"兑换码"!=a&&t.toggleClass("expand")},Schedules.prototype.renderValidPopup=function(e){var t=$(".moviebook-popup-wrapper"),a={wanda:"万达",gewala:"格瓦拉",spider:"蜘蛛网"};params=util.urlToJSON(e.replace("/detail?","")),data={title:a[params.third_from]},popupHtml=POPUPTPL(data),number=localStorage.getItem("movie_book_user_mobile"),t.length||(t=$(popupHtml),t.prependTo("#wrapper").show().data("url",e).children().first().css("top",window.scrollY+$(window).height()/2),$("body").height()<window.screen.height&&t.height(window.screen.height),number&&$("#valid-phone").val(number),$("#valid-btn-close").click($.proxy(this.closePopup,this)),$("#valid-btn-submit").click($.proxy(this.validPhone,this)))},Schedules.prototype.closePopup=function(){var e=$(".moviebook-popup-wrapper");e.length&&e.remove()},Schedules.prototype.validPhone=function(){function e(){var e="mkcode",t=document.createElement("script"),a=function(){$(t).remove(),delete window[e]};window[e]=function(e){a(),e.content&&e.content.vcode&&n.data("vcode",e.content.vcode).find("p").eq(1).show().find("img").attr("src","http://map.baidu.com/maps/services/captcha/image?vcode="+e.content.vcode)},t.src="http://map.baidu.com/maps/services/captcha?setno=1&cb="+e+"&t="+(1e8*Math.random()).toFixed(0),$("head").append(t)}function t(t,a){var o="vdcode",s=document.createElement("script"),l=function(){$(s).remove(),delete window[o]};t.t=(1e8*Math.random()).toFixed(0),window[o]=function(t){return l(),t.result&&0!=t.result.error?(i.val(""),n.find(".tip").eq(1).show().text("验证出错，请重新输入验证码！"),e(),void 0):($.isFunction(a)&&a(),void 0)},s.src="http://map.baidu.com/maps/services/captcha/verify?cb="+o+"&"+$.param(t),s.setAttribute("async","false"),$("head").append(s)}var a=($(event.target),$("#valid-phone")),i=$("#valid-number"),o=a.next(),n=$(".moviebook-popup-wrapper"),s=a.val(),l=localStorage.getItem("movie_book_user_mobile"),r=n.data("url"),d=util.urlToJSON(r.replace("/detail?",""));if(!s||11!=s.length||!s.match(/^((\(\d{3}\))|(\d{3}\-))?13[0-9]\d{8}|15[0-9]\d{8}|18\d{9}/g))return o.html("请确保输入号码正确！").show(),!1;if(n.data("valid"))return o.hide(),t({code:i.val(),vcode:n.data("vcode")},function(){s=a.val();try{localStorage.setItem("movie_book_user_mobile",s)}catch(e){}stat.addStat(STAT_CODE.PLACE_MOVIE_BOOK_CLICK,{from:d.third_from,uid:d.uid}),window.setTimeout(function(){window.location.href=r+"&user_mobile="+s},200)}),!1;if(!l||l&&s!=l)return o.hide(),n.data("valid",!0),e(),!1;try{localStorage.setItem("movie_book_user_mobile",s)}catch(c){}stat.addStat(STAT_CODE.PLACE_MOVIE_BOOK_CLICK,{from:d.third_from,uid:d.uid}),window.setTimeout(function(){window.location.href=r+"&user_mobile="+s},200)},Schedules.prototype.createCodeUrl=function(e,t){var a=util.urlToJSON(window.location.href),i="",o={qt:"verify",uid:this.uid,code:a.code,sign:a.sign,name:t.name,mid:e.movie,duration:t.duration,score:t.score,info:e.info.replace(/\'/g,'"'),day:e.day,seq_no:e.num,cinemaid:e.cinema,time:e.time,type:e.type,pname:$("#place-widget-captain-name").html()||"",release:t.release,category:t.category,director:t.director,player:t.players,pic:t.pic};return a.code&&a.sign&&(i="/mobile/webapp/place/codes/force=simple&"+util.jsonToUrl(o)),i},module.exports={init:function(e,t,a,i){stat.addStat(STAT_CODE.PLACE_MOVIE_PV,{state:t,uid:e});var o=util.urlToJSON(window.location.href),n={qt:"timetable",act:"timetable",uid:e,style:t,code:o.code||"",sign:o.sign||"",from:"webapp"};$.ajax({url:"/detail?",data:n,dataType:"json",success:function(o){var n=new Schedules(o.now_time||a,e);window.addEventListener("resize",function(){n.updateLayout()},!1),2==t&&(o=o.other_info),o.time_table&&o.time_table.length?n.renderMovieNews(o,i):n.renderFailInfo(),stat.addStat(STAT_CODE.PLACE_MOVIE_LOADED_PV,{state:t,uid:e,action:"loaded"})}})}}});
;define("place:widget/photodetailslider/photodetailslider.js",function(e,i,t){t.exports={config:{iService:"",iServiceTpl:"height=$h$&width=$w$&quality=70&src=$src$"},$el:null,photos:[],area:null,frowWhere:null,cIndex:null,imgs:null,init:function(e){"use strict";var i=this,t=Number(e.get.idx);i.$el=$("#photoslider"),i.photos=e.photos,i.area=i.$el.find("#img-area"),i.imgs=i.area.find("img"),i.frowWhere=i.$el.find(".fromwhere"),i.cIndex=i.$el.find(".currentidx"),i.config.iService=e.thumbnailURL+i.config.iServiceTpl,i.resize(),i.bindEvent(),i.displaySlider(t)},displaySlider:function(e){"use strict";var i=this;i._setInfo(e),$("#photos-detail .place-loading").remove(),i.area.slider({index:Number(e)}).on("slideend",$.proxy(i._slide,i))},_slide:function(e,i){"use strict";var t=this;t._setInfo(i)},_setInfo:function(e){"use strict";var i=this,e=Number(e);i.frowWhere.html(i.photos[e].cn_name),i.cIndex.html(e+1)},_setImgs:function(e){"use strict";var i=this,t=i._getDim(),r=[],n=e.photos;for(var s in n)r.push({pic:i._getPic(n[s],t)});return r},_getPic:function(e,i){"use strict";return this.config.iService.replace("$h$",i.sHeight).replace("$w$",i.sWidth).replace("$src$",encodeURIComponent(e.imgUrl))},bindEvent:function(){"use strict";var e=this;e.onImgLoading().onResize().stop},unbindEvent:function(){"use strict";var e=this;e.offImgLoading().offResize()},_getDim:function(){"use strict";var e=this.getClientSize(),i=this.getSliderOffset(),t=(e.width-46)/3,r=.75*t,n=.9*e.width,s=e.height-i.top-40,o=e.height-i.top;return{pHeight:o,tWidth:Math.floor(t),tHeight:Math.floor(r),sWidth:Math.floor(n),sHeight:Math.floor(s),cs:e}},getClientSize:function(){"use strict";var e=window;return{width:e.innerWidth,height:e.innerHeight}},getSliderOffset:function(){"use strict";var e=this;return e.$el.offset()},resize:function(){"use strict";var e=this,i=e._getDim();e.$el.css({height:i.pHeight}),e.area.css({height:i.sHeight})},onResize:function(){"use strict";var e=this;return!e._resizeFun&&$(window).on("resize orientationchange",e._resizeFun=$.proxy(e.resize,e)),e},offResize:function(){"use strict";var e=this;return e._resizeFun&&($(window).off("resize orientationchange",e._resizeFun)||(e._resizeFun=null)),e},onImgLoading:function(){"use strict";return this.imgs.on("load",$.proxy(this._handleImgLoad,this)).on("error",$.proxy(this._handleImgError,this)),this},offImgLoading:function(){"use strict";return this.imgs.off(),this},_handleImgError:function(e){"use strict";$(e.currentTarget).attr("src","/widget/photodetailslider/images/no_img.png")},_handleImgLoad:function(e){"use strict";var i=$(e.target);i.parent().removeClass("loading")}}});
;define("place:widget/photodetailtile/photodetailtile.js",function(i,t,e){var r=i("common:widget/url/url.js");e.exports={config:{iService:"",iServiceTpl:"height=$h$&width=$w$&quality=70&src=$src$",iThreshold:12},imgItemTpl:'<div class="tile-arena-item" style="width:$w$px;height:$h$px"><img data-idx="$i$" src="$url$" alt="加载中……"/></div>',$el:null,tile:null,photos:null,end:0,init:function(i){"use strict";var t=this;t.end=0,t.$el=$("#phototile"),t.tile=t.$el.find(".tile-arena"),t.showFooter=t.$el.find(".tile-footer"),t.showBtn=t.showFooter.find("a"),t.photos=i.photos,t.config.iService=i.thumbnailURL+t.config.iServiceTpl,t.bindEvent(),t.displayTile()},displayTile:function(){"use strict";for(var i=this,t=i.end,e=i.end+i.config.iThreshold>=i.photos.length,r=e?i.photos.length:i.end+i.config.iThreshold,n=[],o=i._getDim(),l=i.config.iService.replace("$h$",o.tHeight).replace("$w$",o.tWidth);r>t;t++){var h=l.replace("$src$",encodeURIComponent(i.photos[t].imgUrl));n.push(i.imgItemTpl.replace("$i$",t).replace("$url$",h).replace("$h$",o.tHeight).replace("$w$",o.tWidth))}var s=$(n.join(""));$("#photos-detail .place-loading").remove(),i.tile.append(s),i.initImgLoading(s),e?i.showFooter.hide():i.showFooter.show(),i.end=r},bindEvent:function(){"use strict";var i=this;return i.$el.on("click",i._clickEl=$.proxy(i.clickHandler,i)),$(window).on("resize orientationchange",i._resizeFun=$.proxy(i.resize,i)),this},unbindEvent:function(){"use strict";var i=this;return i._clickEl&&(i.$el.off("click",i._clickEl)||(i._clickEl=null)),i._resizeFun&&($(window).off("resize orientationchange",i._resizeFun)||(i._resizeFun=null)),this},clickHandler:function(i){"use strict";var t=this,e=$(i.target);"photo-tile-more-imgs"===e.attr("id")?t.displayTile():"tile-arena-item"===e.parent().attr("class")&&t.displayImgSlider(e)},getClientSize:function(){"use strict";var i=window;return{width:i.innerWidth,height:i.innerHeight}},_getDim:function(){"use strict";var i=this.getClientSize(),t=(i.width-46)/3,e=.75*t,r=.9*i.width,n=.9*(i.height-51-40),o=i.height-51;return{pHeight:o,tWidth:Math.floor(t),tHeight:Math.floor(e),sWidth:Math.floor(r),sHeight:Math.floor(n),cs:i}},resize:function(){"use strict";var i=this,t=i._getDim();return i.$el.find(".tile-arena-item").css({width:t.tWidth,height:t.tHeight}),i},displayImgSlider:function(i){"use strict";var t=i.data("idx"),e=r.get();e.pageState.detail_part="photoslider",e.pageState.idx=t,r.update(e)},initImgLoading:function(i){"use strict";i.find("img").on("error",$.proxy(this._handleImgError,this))},_handleImgError:function(i){"use strict";$(i.currentTarget).attr("src","/widget/photodetailtile/images/no_img.png")}}});
;define("place:widget/placelist/placelist.js",function(t,a,e){function i(){"use strict";$('.btn-book[industry="scope"]').on("click",n),$(".place-widget-placelist").on("click","li",c),$("#place-widget-placelist-showall").on("click",s),o()}function n(t){"use strict";var a=$(t.target).closest("li"),e=find(".list-tit").text(),i=a.attr("srcname"),n=$(".common-widget-nav .title span").text();m.addCookieStat(STAT_CODE.PLACE_SCOPE_LIST_BOOK_CLICK,{wd:n,name:e,srcname:i,entry:p})}function o(){"use strict";var t=$(".place-widget-placelist .page-btn");$.each(t,function(t,a){var e=$(a);e.on("click",function(t){var a=$(t.target),e=a.data("type"),i=a.data("url"),n=$(".common-widget-nav .title span").text();m.addCookieStat(STAT_CODE.PLACE_LIST_PAGE_CHANGE,{wd:n,type:e}),a.hasClass("unclick")||g.navigate(i,{replace:!0}),t.stopPropagation(),t.stopImmediatePropagation()})})}function s(t){"use strict";var a=$("#nav_maplink");$("#place-widget-placelist-showall").hide(),$(".place-widget-placelist .place-list").removeClass("acc-list"),$(".place-widget-placelist .list-pagenav").show(),a.attr("href",a.attr("href")+"&showall=1"),m.addStat(STAT_CODE.PLACE_MAINRES_OPEN),t.stopPropagation(),t.stopImmediatePropagation()}function c(t){"use strict";var a=$(this),e=a.data("href"),i=a.find(".list-tit").text(),n=d&&d.isGenRequest,o=t.target,s=a.attr("srcname"),c=$(".common-widget-nav .title span").text();$(o).closest("a").length||(n=1==n?1:0,m.addCookieStat(STAT_CODE.PLACE_LIST_CLICK,{wd:c,name:i,is_gen:n,srcname:s,entry:p},function(){g.navigate(e)}),t.stopPropagation(),t.stopImmediatePropagation())}function l(){"use strict";var t,a=/searchFlag=([A-Za-z]+)/g;(t=a.exec(location.href))&&(p=t[1])}function r(t){"use strict";d=t}var d,p,g=t("common:widget/url/url.js"),m=(t("common:static/js/util.js"),t("common:widget/stat/stat.js")),_=t("common:widget/geolocation/location.js");e.exports={init:function(t){r(t),i(),l();var a=$(".common-widget-nav .title span").text();m.addStat(STAT_CODE.PLACE_LIST_VIEW,{wd:a}),_.hasExactPoi()?m.addStat(STAT_CODE.PLACE_LIST_GEO_SUC):m.addStat(STAT_CODE.PLACE_LIST_GEO_FAIL)}}});
;define("place:widget/premium/premium.js",function(e,i,a){function t(e){var i=$(".premium-list > li"),a=$(".place-widget-premium-pagenum-prev"),m=$(".place-widget-premium-pagenum-next"),n=$(".place-widget-premium-curpage"),p=n.html()-0;m.hasClass("place-widget-premium-disable")&&m.removeClass("place-widget-premium-disable"),a.hasClass("place-widget-premium-disable")||(m.on("click",s),i.hide(),i.eq(p-2).show(),n.html(p-1),0==p-2&&(a.addClass("place-widget-premium-disable"),a.off("click",t))),e.stopPropagation(),e.stopImmediatePropagation()}function s(e){var i=$(".premium-list > li"),a=$(".place-widget-premium-pagenum-prev"),m=$(".place-widget-premium-pagenum-next"),n=$(".place-widget-premium-curpage"),p=$(".place-widget-premium-totalpage"),c=n.html()-0,o=p.html()-0;a.hasClass("place-widget-premium-disable")&&a.removeClass("place-widget-premium-disable"),m.hasClass("place-widget-premium-disable")||(a.on("click",t),i.hide(),i.eq(c).show(),n.html(c+1),c+1==o&&(m.addClass("place-widget-premium-disable"),m.off("click",s))),e.stopPropagation(),e.stopImmediatePropagation()}var m,n=e("common:widget/stat/stat.js"),p=e("common:static/js/util.js");e("common:widget/cookie/cookie.js");var c,o=function(){function e(){var e=$("#msg-tel").val();return isNaN(e)||11!==e.length||!e.match(/^((\(\d{3}\))|(\d{3}\-))?13[0-9]\d{8}|15[89]\d{8}|18\d{9}/g)?(o.addClass("tip-active"),setTimeout(function(){o.removeClass("tip-active")},1e3),void 0):(l.send({en_name:n,poi_id:c,promo_id:m,mobile:e},t),a({type:"sendIng"}),void 0)}function i(){d.hidePopup()}function a(e){e=e||{};var i={noNetWork:"请检查网络，稍后重试",sendIng:"正在发送...",success:"发送成功",fail:"发送失败"},a=e.message||i[e.type]||i.fail,t=p.find(".msg-form");$msgNotice=p.find(".msg-notice"),t.hide(),$msgNotice.show().html(a)}function t(e){var i=e.errorNo;0===i?a({type:"success"}):a({message:e.errMsg}),setTimeout(function(){d.hidePopup()},2e3)}function s(){d.creatPopup(),p=$("div.msg-container"),o=p.find(".tip"),$("#msg-send-btn").on("click",e),$("#msg-cancel-btn").on("click",i)}var m,n,p,o;return{show:function(e,i){m=e||"",n=i||"",s(),$(".place-msg-mask").show().find("input").focus()}}}(),d={creatPopup:function(){var e='<div class="place-msg-mask">            <div class="msg-container">                <div class="msg-form">                    <p>请输入手机号</p>                    <p>                        <input type="tel" id="msg-tel"/>                        <span class="tip">请输入正确手机号</span>                    </p>                    <p class="opt">                        <a href="javascript:void(0);" id="msg-send-btn" class="msg-send-btn">发送</a>                        <a href="javascript:void(0);" id="msg-cancel-btn" class="msg-cancel-btn">取消</a>                    </p>                </div>                <div class="msg-notice"></div>            </div>        </div>';$(e).appendTo("#wrapper")},hidePopup:function(){$(".place-msg-mask").remove()}},l={send:function(e,i){e=$.extend({qt:"sms",en_name:"",poi_id:"",promo_id:"",mobile:"",src:"map",terminal:"webapp",imei:2e14},e),$.ajax({url:"http://client.map.baidu.com/detail",data:e,success:i,dataType:"jsonp"})}};p.urlToJSON(location.href).uid,a.exports={init:function(e,i){c=e,m=i||{};var a=$(".place-widget-premium-totalpage").html()-0;a>1&&($(".place-widget-premium-pagenum-prev").on("click",t),$(".place-widget-premium-pagenum-next").on("click",s)),$("#place-premium-msg-btn").click(function(){var e=$(this),i=e.data("saleid"),a=e.data("enname");window.scrollTo(0,$("#product-nav").height()),o.show(i,a),n.addStat(STAT_CODE.PLACE_PREMIUM_SMSG_DL_CLICK,{wd:m.wd,name:m.name,srcname:m.srcname})}),n.addStat(STAT_CODE.PLACE_PREMIUM_VIEW,{wd:m.wd,name:m.name,srcname:m.srcname})}}});
;define("place:widget/recommend/recommend.js",function(t,e,i){function a(){"use strict";var t=$(".place-widget-recommend ul li");t.on("click",n)}function n(t){"use strict";var e,i,a,n=$(t.target).closest("li"),s=location.href,r=n.attr("data-uid"),d=$(".place-widget-captain .name").text(),l=(n.find("p").eq(0).text().substr(2),s.lastIndexOf("/"));i=s.slice(0,l).replace(/qt=[A-Za-z]*/g,"qt=inf"),a=s.slice(l),e=i+"&uid="+r+a,c.addCookieStat(STAT_CODE.PLACE_CATER_DETAIL_RECOMMEND_CLICK,{name:d},function(){o.navigate(e)}),t.stopPropagation(),t.stopImmediatePropagation()}var o=t("common:widget/url/url.js"),c=t("common:widget/stat/stat.js");i.exports={init:function(){"use strict";a()}}});
;define("place:widget/scopebook/scopebook.js",function(o,t,s){function e(){"use strict";var o=$(".scope-ticket-name").parent();o.on("click",a)}function a(o){var t=$(o.target).closest("div"),s=t.find("span").eq(0),e=t.next(),a=$(".scope-ticket-name").parent(),n=$(".place-widget-scope-book");s.hasClass("scope-arrow-icon-down")||(a.next().addClass("scope-book-hide"),a.find(".scope-arrow-icon").removeClass("scope-arrow-icon-down"),t.attr("last")?t.addClass("scope-border-bottom"):(a.last().addClass("scope-border-bottom-radius"),a.last().attr("style","border-bottom: none"))),s.toggleClass("scope-arrow-icon-down"),0==e.length?null:e.toggleClass("scope-book-hide"),t.attr("last")&&(t.attr("style",""),t.toggleClass("scope-border-bottom-radius"),"scope-border-bottom"!=t.attr("class")&&t.attr("style","border-bottom: none")),r(n),o.stopPropagation(),o.stopImmediatePropagation()}function r(o){var t=o.offset();window.scrollTo(0,t.top)}o("common:widget/stat/stat.js"),s.exports={init:function(){"use strict";e()}}});
;define("place:widget/selectbox/selectbox.js",function(e,t,a){var r,_,o,s=e("common:widget/url/url.js"),n=e("common:widget/geolocation/location.js"),c=e("common:static/js/util.js"),l=e("common:widget/stat/stat.js"),i={takeout:{pl_dist:"radius",pl_sort_type:"sortType",pl_sort_rule:"orderType",pn:"pageNum"}};a.exports.init=function(e){var t,a;(o=e||{})&&(t=o.wd)&&(a=o.srcname),p(),r=o.select_type,_=o.what,l.addStat(STAT_CODE.PLACE_LIST_FILTER_VIEW,{wd:t,srcname:a})};var p=function(){var e=$(".place-widget-selectbox select");e.length,$.each(e,function(e,t){$(t).on("change",d)}),$(".city-select").on("click",T)},d=function(e){var t=e.target,a=$(t).closest("select").attr("name"),r=$(t)[0].selectedIndex,_=$($(t)[0][r]),s=_.text(),n=o.wd,c=o.srcname;switch(a){case"pl_dist":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_RANGE_CLICK,{wd:n,range:s,srcname:c});break;case"pl_sort_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_SORT_CLICK,{wd:n,sort:s,srcname:c});break;case"pl_sub_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_CATEGORY_CLICK,{wd:n,type:s,srcname:c})}u(t),y()},u=function(e){var t=$(e),a=t[0].selectedIndex,r=$(t[0][a]),_=r.text(),o=t.parent().children(".select_title");o.html(_)},y=function(){var e=s.get().query,t=C(),a=n.getCityCode();t=$.extend(t,{pn:0}),e=$.extend(e,t,{c:a}),"takeout"===r&&(e=g(e,r)),"hotel"===r&&(e.pl_filt_type_section=1),e.pl_tonight_sale_flag_section&&delete e.pl_tonight_sale_flag_section,"全市"==e.pl_dist?delete e.center_rank:e.nb_x&&e.nb_y&&(e.center_rank=1),e.pl_movie_book_section="movie_book"==e.pl_sort_type?"1,1":"0,+",s.update({query:e,pageState:{show_select:1}},{queryReplace:!0,replace:!0})},C=function(){var e,t,a=$(".place-widget-selectbox select"),r={};return $.each(a,function(a,_){var o={},s=$(_);switch(s.parent("select-box"),e=$(_).attr("name"),t=$(_).val(),e){case"pl_sub_type":o.wd=t,o.pl_sub_type=t;break;case"pl_sort_type":o.pl_sort_type=t.split("__")[0],o.pl_sort_rule=t.split("__")[1]||0;break;case"pl_dist":o.pl_dist=t}r=$.extend(r,o)}),r},g=function(e,t){if(e&&t){var a=$.extend({},e),r=i[t];return $.each(r,function(e,t){var r=a[e];r&&(a[t]=r),"pl_sort_rule"!==e&&"0"==r&&delete a[t],delete a[e]}),a}},T=function(){var e=n.getCityType(),t=n.getCityCode(),a=s.get(),r=a.query||{},i=(a.pageState||{},o.wd),p=o.srcname;r.wd=_||r.wd,3===e&&(t=n.getUpCityCode()||t),refer_query=c.jsonToUrl(a.query||{}),refer_pagestate=c.jsonToUrl(a.pageState||{}),l.addCookieStat(STAT_CODE.PLACE_SELECT_CLICK_CITY,{wd:i,srcname:p}),s.update({module:"index",action:"setmylocation",query:{c:t},pageState:{refer_query:refer_query,refer_pagestate:refer_pagestate,list_type:"business_area"}},{queryReplace:!0,pageStateReplace:!0})}});
;define("place:widget/selectlist/selectlist.js",function(e,t,n){var a=e("common:widget/geolocation/location.js"),i=e("common:widget/url/url.js"),c=e("common:static/js/util.js"),o=e("common:widget/setcity/setcity.js"),r="_refer_query",d="_refer_pagestate";n.exports.init=function(e){y(e),s()};var l,u="     ",y=function(e){l=e},s=function(){$list=$(".place-widget-selectlist"),$list.on("click","li",p)},p=function(){var e=$(this),t=+e.data("i")-1;m(t)},m=function(e){if("undefined"!=typeof e){var t=l.list[e],n=i.get(),a=n.pageState,c=f(t),u=a.refer_pagestate||window.localStorage.getItem(d),y=a.refer_query||window.localStorage.getItem(r);y&&"undefined"!=y?(_(c,!1),g(t,{referQuery:y,referPageState:u})):(_(c),c.isExactPoi||3===c.addr.cityType?i.toIndex({cache:!1}):o.setAndRedirect(c.addr.city,c.addr.cityCode))}},g=function(e,t){var n,a,o=i.get(),y=t||{},s=(o.pageState||{},c.urlToJSON(y.referQuery)||{}),p=c.urlToJSON(y.referPageState)||{},m="wm"===s.qt||"takeout"===p.search,g=l.city;window.localStorage.removeItem(r),window.localStorage.removeItem(d),s.wd&&s.wd.split(u)[1]&&(s.wd=s.wd.split(u)[1]),s.c=g.code,a=x(),n=m?S(e,s):v(e,s),p=$.extend(p,{center_name:e.name||""}),delete p.i,i.update({module:n.module,action:n.action,query:n.query,pageState:p},{queryReplace:!0,pageStateReplace:!0})},f=function(e){if(e){x(),l.city;var t,n=c.geoToPoint(e.geo),a=w(e);return t={addr:a,isExactPoi:a.isExactPoi,point:{x:n.lng,y:n.lat}}}},_=function(e){e&&(e.isSaveLocInCookie=!0,a.setAddress(e))},w=function(e){var t,n,a=l.city;cityName=a.name,e.cname?(name=e.pcname?e.pcname+e.cname:e.cname,n=!1):(name=e.name,n=!0);var i=null;return 3===e.city_type&&(i=a.up_cityid),t={address:name,city:cityName,cityCode:e.code?e.code:a.code,isExactPoi:n,cityType:e.city_type?e.city_type:a.type,upCityCode:e.pccode?e.pccode:i}},x=function(){return l.type},S=function(e,t){var n,a=x();return 2!=a?(n=c.geoToPoint(e.geo),t.pointX1=n.lng,t.pointY1=n.lat,t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1,t.m="searchXY"):(t.m="searchBrands",delete t.pointX1,delete t.pointY1,delete t.center_rank,delete t.nb_x,delete t.nb_y),t=$.extend(t,{cityId:e.addr.cityCode,directId:e.addr.cityCode,pageNum:1,pageSize:10}),{query:t,module:"place",action:"takeout"}},v=function(e,t){var n,a=x();return 2!=a?(n=c.geoToPoint(e.geo),t.nb_x=n.lng,t.nb_y=n.lat,t.center_rank=1):(delete t.nb_x,delete t.nb_y,delete t.center_rank,delete t.pointX1,delete t.pointY1),t=$.extend(t,{c:e.addr.cityCode,center_rank:1,pn:0}),{query:t,module:"search",action:"search"}}});
;define("place:widget/takeoutdetailnav/takeoutdetailnav.js",function(e,t,i){i.exports={init:function(){$(".place-widget-takeout-detail").on("click",function(){$("#place-widget-dish-category").hide()}),$(".menu-btn").click(function(){$("#place-widget-dish-category .dish-name").length>0&&$("#place-widget-dish-category").toggle()})}}});
;define("place:widget/takeoutlist/takeoutlist.js",function(t,a,e){e.exports.bind=function(){$pageNav=$(".place-widget-taskoutlist .page_btn"),$.each($pageNav,function(t,a){var e=$(a);e.on("click",function(t){var a=$(t.target),e=(a.data("type"),a.data("href"));a.hasClass("unclick")||(e="http://"+location.host+e,window.location.replace(e))})})}});
;define("place:widget/telephone/telephone.js",function(t,e,a){"use strict";function n(){var t=$(".place-widget-telephone");t.on("click",o)}function o(t){var e,a,n,o=$(t.target).closest("a"),r=/searchFlag=([A-Za-z]+)/g;(e=r.exec(location.href))&&(a=e[1]),n={wd:i.wd,name:i.name,srcname:i.srcname,entry:a},c.addStat(STAT_CODE.PLACE_DETAIL_TELEPHONE_CLICK,n),s.isAndroid()&&(o.attr("href","javascript:void(0)"),s.TelBox.showTb(o.attr("data-tel"))),t.stopPropagation(),t.stopImmediatePropagation()}var i,s=t("common:static/js/util.js"),c=t("common:widget/stat/stat.js");a.exports={init:function(t){n(),i=t||{},c.addStat(STAT_CODE.PLACE_DETAIL_TELEPHONE_SHOW,{wd:i.wd,name:i.name,srcname:i.srcname})}}});
;define("place:widget/thirdcomment/thirdcomment.js",function(t,e,o){var n=t("common:static/js/util.js");o.exports={init:function(){$("#J_commentSelect")&&$("#J_commentSelect").on("change",this.loadMore)},loadMore:function(){var t=$(this),e=n.jsonToUrl({uid:t.data("uid"),startIndex:0,maxResults:5,orderBy:t.val()});BigPipe.asyncLoad({id:"place-pagelet-bdcomment"},e)}}});
;define("place:widget/toplist/toplist.js",function(t,e,a){function i(){"use strict";$(".place-widget-toplist").on("click",o),$(".place-widget-toplist-others").on("click",s)}function o(t){"use strict";$(".place-widget-toplist-arrow").toggleClass("place-widget-toplist-arrowup"),$(".place-widget-toplist-others").toggleClass("place-widget-toplist-showall"),t.stopPropagation(),t.stopImmediatePropagation()}function s(t){"use strict";var e,a,i,o=$(t.target).closest("li"),s=location.href,p=o.attr("data-uid"),r=o.find("p").eq(0).text(),d=s.lastIndexOf("/"),g=$(".common-widget-nav .title span").text(),m={wd:g,name_src:n.name,name_dest:r,srcname:n.srcname};a=s.slice(0,d).replace(/qt=[A-Za-z]*/g,"qt=inf"),i=s.slice(d),e=a+"&uid="+p+i,c.addCookieStat(STAT_CODE.PLACE_DETAIL_RANK_CLICK,m,function(){l.navigate(e)}),t.stopPropagation(),t.stopImmediatePropagation()}var n,c=t("common:widget/stat/stat.js"),l=t("common:widget/url/url.js");$(".common-widget-nav .title span").text(),a.exports={init:function(t){"use strict";i(),n=t||{};var e=$(".common-widget-nav .title span").text();c.addStat(STAT_CODE.PLACE_DETAIL_RANK_VIEW,{wd:e,name:n.name,srcname:n.srcname})}}});
;define("place:widget/tosearch/tosearch.js",function(t,e,i){i.exports={init:function(){"use strict";var t=$(".place-widget-tosearch .name");t.css("max-width",$("body").offset().width-200+"px"),$(window).on("resize",function(){t.css("max-width",$("body").offset().width-200+"px")})}}});