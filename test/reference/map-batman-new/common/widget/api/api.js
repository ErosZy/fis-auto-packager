(function(){var W,aC=W=aC||{version:"1.3.4"};aC.guid="$BAIDU$";window[aC.guid]=window[aC.guid]||{};aC.object=aC.object||{};aC.extend=aC.object.extend=function(aN,T){for(var aM in T){if(T.hasOwnProperty(aM)){aN[aM]=T[aM]}}return aN};aC.dom=aC.dom||{};aC.dom.g=function(T){if("string"==typeof T||T instanceof String){return document.getElementById(T)}else{if(T&&T.nodeName&&(T.nodeType==1||T.nodeType==9)){return T}}return null};aC.g=aC.G=aC.dom.g;aC.dom.hide=function(T){T=aC.dom.g(T);T.style.display="none";return T};aC.hide=aC.dom.hide;aC.lang=aC.lang||{};aC.lang.isString=function(T){return"[object String]"==Object.prototype.toString.call(T)};aC.isString=aC.lang.isString;aC.dom._g=function(T){if(aC.lang.isString(T)){return document.getElementById(T)}return T};aC._g=aC.dom._g;aC.dom.contains=function(T,aM){var aN=aC.dom._g;T=aN(T);aM=aN(aM);return T.contains?T!=aM&&T.contains(aM):!!(T.compareDocumentPosition(aM)&16)};aC.browser=aC.browser||{};aC.dom._NAME_ATTRS=(function(){var T={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};T.htmlFor="for";T.className="class";return T})();aC.dom.setAttr=function(aM,T,aN){aM=aC.dom.g(aM);if("style"==T){aM.style.cssText=aN}else{T=aC.dom._NAME_ATTRS[T]||T;aM.setAttribute(T,aN)}return aM};aC.setAttr=aC.dom.setAttr;aC.dom.setAttrs=function(aN,T){aN=aC.dom.g(aN);for(var aM in T){aC.dom.setAttr(aN,aM,T[aM])}return aN};aC.setAttrs=aC.dom.setAttrs;aC.string=aC.string||{};aC.dom.removeClass=function(aQ,aR){aQ=aC.dom.g(aQ);var aO=aQ.className.split(/\s+/),aS=aR.split(/\s+/),aM,T=aS.length,aN,aP=0;for(;aP<T;++aP){for(aN=0,aM=aO.length;aN<aM;++aN){if(aO[aN]==aS[aP]){aO.splice(aN,1);break}}}aQ.className=aO.join(" ");return aQ};aC.removeClass=aC.dom.removeClass;aC.dom.insertHTML=function(aO,T,aN){aO=aC.dom.g(aO);var aM,aP;if(aO.insertAdjacentHTML){aO.insertAdjacentHTML(T,aN)}else{aM=aO.ownerDocument.createRange();T=T.toUpperCase();if(T=="AFTERBEGIN"||T=="BEFOREEND"){aM.selectNodeContents(aO);aM.collapse(T=="AFTERBEGIN")}else{aP=T=="BEFOREBEGIN";aM[aP?"setStartBefore":"setEndAfter"](aO);aM.collapse(aP)}aM.insertNode(aM.createContextualFragment(aN))}return aO};aC.insertHTML=aC.dom.insertHTML;aC.dom.show=function(T){T=aC.dom.g(T);T.style.display="";return T};aC.show=aC.dom.show;aC.dom.getDocument=function(T){T=aC.dom.g(T);return T.nodeType==9?T:T.ownerDocument||T.document};aC.dom.addClass=function(aQ,aR){aQ=aC.dom.g(aQ);var aM=aR.split(/\s+/),T=aQ.className,aP=" "+T+" ",aO=0,aN=aM.length;for(;aO<aN;aO++){if(aP.indexOf(" "+aM[aO]+" ")<0){T+=" "+aM[aO]}}aQ.className=T;return aQ};aC.addClass=aC.dom.addClass;aC.dom._styleFixer=aC.dom._styleFixer||{};aC.dom._styleFilter=aC.dom._styleFilter||[];aC.dom._styleFilter.filter=function(aM,aP,aQ){for(var T=0,aO=aC.dom._styleFilter,aN;aN=aO[T];T++){if(aN=aN[aQ]){aP=aN(aM,aP)}}return aP};aC.string.toCamelCase=function(T){if(T.indexOf("-")<0&&T.indexOf("_")<0){return T}return T.replace(/[-_][^-_]/g,function(aM){return aM.charAt(1).toUpperCase()})};aC.dom.getStyle=function(aN,aM){var aQ=aC.dom;aN=aQ.g(aN);aM=aC.string.toCamelCase(aM);var aP=aN.style[aM];if(!aP){var T=aQ._styleFixer[aM],aO=aN.currentStyle||getComputedStyle(aN,null);aP=T&&T.get?T.get(aN,aO):aO[T||aM]}if(T=aQ._styleFilter){aP=T.filter(aM,aP,"get")}return aP};aC.getStyle=aC.dom.getStyle;if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){aC.browser.opera=+RegExp["\x241"]}aC.browser.isWebkit=/webkit/i.test(navigator.userAgent);aC.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);aC.browser.isStrict=document.compatMode=="CSS1Compat";aC.dom.getPosition=function(T){T=aC.dom.g(T);var aU=aC.dom.getDocument(T),aO=aC.browser,aR=aC.dom.getStyle,aN=aO.isGecko>0&&aU.getBoxObjectFor&&aR(T,"position")=="absolute"&&(T.style.top===""||T.style.left===""),aS={left:0,top:0},aQ=(aO.ie&&!aO.isStrict)?aU.body:aU.documentElement,aV,aM;if(T==aQ){return aS}if(T.getBoundingClientRect){aM=T.getBoundingClientRect();aS.left=Math.floor(aM.left)+Math.max(aU.documentElement.scrollLeft,aU.body.scrollLeft);aS.top=Math.floor(aM.top)+Math.max(aU.documentElement.scrollTop,aU.body.scrollTop);aS.left-=aU.documentElement.clientLeft;aS.top-=aU.documentElement.clientTop;var aT=aU.body,aW=parseInt(aR(aT,"borderLeftWidth")),aP=parseInt(aR(aT,"borderTopWidth"));if(aO.ie&&!aO.isStrict){aS.left-=isNaN(aW)?2:aW;aS.top-=isNaN(aP)?2:aP}}else{aV=T;do{aS.left+=aV.offsetLeft;aS.top+=aV.offsetTop;if(aO.isWebkit>0&&aR(aV,"position")=="fixed"){aS.left+=aU.body.scrollLeft;aS.top+=aU.body.scrollTop;break}aV=aV.offsetParent}while(aV&&aV!=T);if(aO.opera>0||(aO.isWebkit>0&&aR(T,"position")=="absolute")){aS.top-=aU.body.offsetTop}aV=T.offsetParent;while(aV&&aV!=aU.body){aS.left-=aV.scrollLeft;if(!aO.opera||aV.tagName!="TR"){aS.top-=aV.scrollTop}aV=aV.offsetParent}}return aS};if(/firefox\/(\d+\.\d)/i.test(navigator.userAgent)){aC.browser.firefox=+RegExp["\x241"]}(function(){var T=navigator.userAgent;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(T)&&!/chrome/i.test(T)){aC.browser.safari=+(RegExp["\x241"]||RegExp["\x242"])}})();if(/chrome\/(\d+\.\d)/i.test(navigator.userAgent)){aC.browser.chrome=+RegExp["\x241"]}aC.array=aC.array||{};aC.array.each=function(aQ,aO){var aN,aP,aM,T=aQ.length;if("function"==typeof aO){for(aM=0;aM<T;aM++){aP=aQ[aM];aN=aO.call(aQ,aP,aM);if(aN===false){break}}}return aQ};aC.each=aC.array.each;aC.lang.guid=function(){return"TANGRAM__"+(window[aC.guid]._counter++).toString(36)};window[aC.guid]._counter=window[aC.guid]._counter||1;window[aC.guid]._instances=window[aC.guid]._instances||{};aC.lang.isFunction=function(T){return"[object Function]"==Object.prototype.toString.call(T)};aC.lang.Class=function(T){this.guid=T||aC.lang.guid();window[aC.guid]._instances[this.guid]=this};window[aC.guid]._instances=window[aC.guid]._instances||{};aC.lang.Class.prototype.dispose=function(){delete window[aC.guid]._instances[this.guid];for(var T in this){if(!aC.lang.isFunction(this[T])){delete this[T]}}this.disposed=true};aC.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};aC.lang.Event=function(T,aM){this.type=T;this.returnValue=true;this.target=aM||null;this.currentTarget=null};aC.lang.Class.prototype.addEventListener=function(aO,aN,aM){if(!aC.lang.isFunction(aN)){return}!this.__listeners&&(this.__listeners={});var T=this.__listeners,aP;if(typeof aM=="string"&&aM){if(/[^\w\-]/.test(aM)){throw ("nonstandard key:"+aM)}else{aN.hashCode=aM;aP=aM}}aO.indexOf("on")!=0&&(aO="on"+aO);typeof T[aO]!="object"&&(T[aO]={});aP=aP||aC.lang.guid();aN.hashCode=aP;T[aO][aP]=aN};aC.lang.Class.prototype.removeEventListener=function(aN,aM){if(aC.lang.isFunction(aM)){aM=aM.hashCode}else{if(!aC.lang.isString(aM)){return}}!this.__listeners&&(this.__listeners={});aN.indexOf("on")!=0&&(aN="on"+aN);var T=this.__listeners;if(!T[aN]){return}T[aN][aM]&&delete T[aN][aM]};aC.lang.Class.prototype.dispatchEvent=function(aO,T){if(aC.lang.isString(aO)){aO=new aC.lang.Event(aO)}!this.__listeners&&(this.__listeners={});T=T||{};for(var aN in T){aO[aN]=T[aN]}var aN,aM=this.__listeners,aP=aO.type;aO.target=aO.target||this;aO.currentTarget=this;aP.indexOf("on")!=0&&(aP="on"+aP);aC.lang.isFunction(this[aP])&&this[aP].apply(this,arguments);if(typeof aM[aP]=="object"){for(aN in aM[aP]){aM[aP][aN].apply(this,arguments)}}return aO.returnValue};aC.lang.inherits=function(aR,aP,aO){var aN,aQ,T=aR.prototype,aM=new Function();aM.prototype=aP.prototype;aQ=aR.prototype=new aM();for(aN in T){aQ[aN]=T[aN]}aR.prototype.constructor=aR;aR.superClass=aP.prototype;if("string"==typeof aO){aQ._className=aO}};aC.inherits=aC.lang.inherits;aC.lang.instance=function(T){return window[aC.guid]._instances[T]||null};aC.platform=aC.platform||{};aC.platform.isAndroid=/android/i.test(navigator.userAgent);if(/android (\d+\.\d)/i.test(navigator.userAgent)){aC.platform.android=aC.android=RegExp["\x241"]}aC.platform.isIpad=/ipad/i.test(navigator.userAgent);aC.platform.isIphone=/iphone/i.test(navigator.userAgent);aC.platform.iosVersion=/iphone os (\d)\_/i.test(navigator.userAgent)?+RegExp["\x241"]:0;aC.lang.Event.prototype.inherit=function(aN){var aM=this;this.domEvent=aN=window.event||aN;aM.clientX=aN.clientX||aN.pageX;aM.clientY=aN.clientY||aN.pageY;aM.offsetX=aN.offsetX||aN.layerX;aM.offsetY=aN.offsetY||aN.layerY;aM.screenX=aN.screenX;aM.screenY=aN.screenY;aM.ctrlKey=aN.ctrlKey||aN.metaKey;aM.shiftKey=aN.shiftKey;aM.altKey=aN.altKey;if(aN.touches){aM.touches=[];for(var T=0;T<aN.touches.length;T++){aM.touches.push({clientX:aN.touches[T].clientX,clientY:aN.touches[T].clientY,screenX:aN.touches[T].screenX,screenY:aN.touches[T].screenY,pageX:aN.touches[T].pageX,pageY:aN.touches[T].pageY,target:aN.touches[T].target,identifier:aN.touches[T].identifier})}}if(aN.changedTouches){aM.changedTouches=[];for(var T=0;T<aN.changedTouches.length;T++){aM.changedTouches.push({clientX:aN.changedTouches[T].clientX,clientY:aN.changedTouches[T].clientY,screenX:aN.changedTouches[T].screenX,screenY:aN.changedTouches[T].screenY,pageX:aN.changedTouches[T].pageX,pageY:aN.changedTouches[T].pageY,target:aN.changedTouches[T].target,identifier:aN.changedTouches[T].identifier})}}if(aN.targetTouches){aM.targetTouches=[];for(var T=0;T<aN.targetTouches.length;T++){aM.targetTouches.push({clientX:aN.targetTouches[T].clientX,clientY:aN.targetTouches[T].clientY,screenX:aN.targetTouches[T].screenX,screenY:aN.targetTouches[T].screenY,pageX:aN.targetTouches[T].pageX,pageY:aN.targetTouches[T].pageY,target:aN.targetTouches[T].target,identifier:aN.targetTouches[T].identifier})}}aM.rotation=aN.rotation;aM.scale=aN.scale;return aM};aC.lang.decontrol=function(aM){var T=window[aC.guid];T._instances&&(delete T._instances[aM])};aC.event={};aC.on=aC.event.on=function(aN,aM,T){if(!(aN=aC.g(aN))){return aN}aM=aM.replace(/^on/,"");if(aN.addEventListener){aN.addEventListener(aM,T,false)}else{if(aN.attachEvent){aN.attachEvent("on"+aM,T)}}return aN};aC.un=aC.event.un=function(aN,aM,T){if(!(aN=aC.g(aN))){return aN}aM=aM.replace(/^on/,"");if(aN.removeEventListener){aN.removeEventListener(aM,T,false)}else{if(aN.detachEvent){aN.detachEvent("on"+aM,T)}}return aN};aC.dom.hasClass=function(aN,aM){if(!aN||!aN.className||typeof aN.className!="string"){return false}var T=-1;try{T=aN.className==aM||aN.className.indexOf(aM)}catch(aO){return false}return T>-1};window.BMap=window.BMap||{};window.BMap._register=[];window.BMap.register=function(T){this._register.push(T)};BMap._streetViewRegister=[];BMap.streetViewRegister=function(T){this._streetViewRegister.push(T)};function w(aQ,T){aQ=aC.g(aQ);if(!aQ){return}var aT=this;aC.lang.Class.call(aT);aT.config={clickInterval:200,enableDragging:true,enableDblclickZoom:true,enableMouseDown:true,enablePinchToZoom:true,enableAutoResize:true,fps:25,actionDuration:450,minZoom:1,maxZoom:18,mapType:new aG("\u5730\u56fe",ax,{tips:"\u663e\u793a\u666e\u901a\u5730\u56fe",mapInstance:this}),enableInertialDragging:false,drawMargin:100,enableHighResolution:false,devicePixelRatio:window.devicePixelRatio||2,vectorMapLevel:12,beautifyBlackList:["chrome"],trafficStatus:false};aC.extend(aT.config,T||{});var aS=aT.config.beautifyBlackList;for(var aR=0,aP=aS.length;aR<aP;aR++){if(aC.browser[aS[aR]]){aT.config.devicePixelRatio=1;break}}aT.container=aQ;aT._setStyle(aQ);aQ.unselectable="on";aQ.innerHTML="";aQ.appendChild(aT.render());var aM=aT.getSize();aT.width=aM.width;aT.height=aM.height;aT.offsetX=0;aT.offsetY=0;aT.platform=aQ.firstChild;aT.maskLayer=aT.platform.firstChild;aT.maskLayer.style.width=aT.width+"px";aT.maskLayer.style.height=aT.height+"px";aT._panes={};aT.centerPoint=new e(0,0);aT.mercatorCenter=new e(0,0);aT.zoomLevel=1;aT.lastLevel=0;aT.defaultZoomLevel=null;aT.defaultCenter=null;aT._hotspots={};aT.currentOperation=0;T=T||{};var aO=aT.mapType=aT.config.mapType;aT.projection=aO.getProjection();var aN=aT.config;aN.userMinZoom=T.minZoom;aN.userMaxZoom=T.maxZoom;aT._checkZoom();aT.temp={operating:false,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:false,registerIndex:-1,curSpots:[]};for(var aR=0;aR<BMap._register.length;aR++){BMap._register[aR](aT)}aT.temp.registerIndex=aR;aT._bind();am.load("map",function(){aT._draw()});am.load("opmb",function(){aT._asyncRegister()});aQ=null;aT.enableLoadTiles=true;aT._viewTiles=[]}aC.lang.inherits(w,aC.lang.Class,"Map");aC.extend(w.prototype,{render:function(){var T=o("div");var aO=T.style;aO.overflow="visible";aO.position="absolute";aO.zIndex="0";aO.top=aO.left="0px";var aM=o("div",{"class":"BMap_mask"});var aN=aM.style;aN.position="absolute";aN.top=aN.left="0px";aN.zIndex="9";aN.overflow="hidden";aN.WebkitUserSelect="none";T.appendChild(aM);return T},_setStyle:function(aM){var T=aM.style;T.overflow="hidden";if(ak(aM).position!="absolute"){T.position="relative";T.zIndex=0}T.backgroundColor="#F5F3F0";T.color="#000";T.textAlign="left"},_bind:function(){var T=this;T._watchSize=function(){var aM=T.getSize();if(T.width!=aM.width||T.height!=aM.height){var aO=new U(T.width,T.height);var aP=new ar("onbeforeresize");aP.size=aO;T.dispatchEvent(aP);T._updateCenterPoint((aM.width-T.width)/2,(aM.height-T.height)/2);T.maskLayer.style.width=(T.width=aM.width)+"px";T.maskLayer.style.height=(T.height=aM.height)+"px";var aN=new ar("onresize");aN.size=aM;T.dispatchEvent(aN)}};if(T.config.enableAutoResize){T.temp.autoResizeTimer=setInterval(T._watchSize,80)}},_updateCenterPoint:function(aQ,aR,aP,aO){var aN=this.getMapType().getZoomUnits(this.getZoom());var aM=true;if(aP){this.centerPoint=new e(aP.lng,aP.lat);aM=false}var T=(aP&&aO)?aP:this.mercatorCenter;if(T){this.mercatorCenter=new e(T.lng+aQ*aN,T.lat-aR*aN);if(this.mercatorCenter&&aM){this.centerPoint=this.mercatorCenter}}},zoomTo:function(aO,aM){if(!I(aO)){return}aO=this._getProperZoom(aO).zoom;if(aO==this.zoomLevel){return}this.lastLevel=this.zoomLevel;this.zoomLevel=aO;var aN;if(aM){aN=aM}if(aN){var T=this.pointToPixel(aN,this.lastLevel);this._updateCenterPoint(this.width/2-T.x,this.height/2-T.y,this.pixelToPoint(T,this.lastLevel),true)}this.dispatchEvent(new ar("onzoomstart"));this.dispatchEvent(new ar("onzoomstartcode"))},setZoom:function(T){this.zoomTo(T)},zoomIn:function(T){if(this.zoomLevel>=this.config.vectorMapLevel&&this.zoomLevel<=18){BMap.logCountError.countTouch(0,1)}this.zoomTo(this.zoomLevel+1,T)},zoomOut:function(T){if(this.zoomLevel>=this.config.vectorMapLevel&&this.zoomLevel<=18){BMap.logCountError.countTouch(0,1)}this.zoomTo(this.zoomLevel-1,T)},panTo:function(T,aM){if(!(T instanceof e)){return}this.mercatorCenter=T;if(T){this.centerPoint=new e(T.lng,T.lat)}else{this.centerPoint=this.mercatorCenter}},panBy:function(aM,T){aM=Math.round(aM)||0;T=Math.round(T)||0;this._updateCenterPoint(-aM,-T)},addControl:function(T){if(T&&aq(T._i)){T._i(this);this.dispatchEvent(new ar("onaddcontrol",T))}},removeControl:function(T){if(T&&aq(T.remove)){T.remove();this.dispatchEvent(new ar("onremovecontrol",T))}},addOverlay:function(T){if(T&&aq(T._i)){T._i(this);this.dispatchEvent(new ar("onaddoverlay",T))}},removeOverlay:function(T){if(T&&aq(T.remove)){T.remove();this.dispatchEvent(new ar("onremoveoverlay",T))}},clearOverlays:function(){this.dispatchEvent(new ar("onclearoverlays"))},addTileLayer:function(T){if(T){this.dispatchEvent(new ar("onaddtilelayer",T))}},removeTileLayer:function(T){if(T){this.dispatchEvent(new ar("onremovetilelayer",T))}},setCenter:function(T){var aM=this;if(T instanceof e){aM.panTo(T,{noAnimation:true})}},centerAndZoom:function(T,aN,aP){var aM=this;if(!(T instanceof e)||!aN){return}aN=aM._getProperZoom(aN).zoom;aM.lastLevel=aM.zoomLevel||aN;aM.zoomLevel=aN;aM.centerPoint=new e(T.lng,T.lat);aM.mercatorCenter=aM.centerPoint;aM.defaultZoomLevel=aM.defaultZoomLevel||aM.zoomLevel;aM.defaultCenter=aM.defaultCenter||aM.centerPoint;var aQ=new ar("onload");var aO=new ar("onloadcode");aQ.point=new e(T.lng,T.lat);aQ.pixel=aM.pointToPixel(aM.centerPoint,aM.zoomLevel);aQ.zoom=aN;if(!aM.loaded){aM.loaded=true;aM.dispatchEvent(aQ)}aM.dispatchEvent(aO);if(aP){aM.dispatchEvent(new ar("onmoveend"))}else{aM.dispatchEvent(new ar("onmoveend"));if(aM.lastLevel!=aM.zoomLevel){aM.dispatchEvent(new ar("onzoomend"))}}},reset:function(){this.centerAndZoom(this.defaultCenter,this.defaultZoomLevel,true)},enableDragging:function(){this.config.enableDragging=true},disableDragging:function(){this.config.enableDragging=false},enableInertialDragging:function(){this.config.enableInertialDragging=true},disableInertialDragging:function(){this.config.enableInertialDragging=false},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=true},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=false},enablePinchToZoom:function(){this.config.enablePinchToZoom=true},disablePinchToZoom:function(){this.config.enablePinchToZoom=false},enableAutoResize:function(){this.config.enableAutoResize=true;this._watchSize();if(!this.temp.autoResizeTimer){this.temp.autoResizeTimer=setInterval(this._watchSize,80)}},disableAutoResize:function(){this.config.enableAutoResize=false;if(this.temp.autoResizeTimer){clearInterval(this.temp.autoResizeTimer);this.temp.autoResizeTimer=null}},getSize:function(){return new U(this.container.clientWidth,this.container.clientHeight)},getCenter:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},checkResize:function(){this._watchSize()},_getProperZoom:function(aN){var aM=this.config.minZoom,T=this.config.maxZoom,aO=false;if(aN<aM){aO=true;aN=aM}if(aN>T){aO=true;aN=T}return{zoom:aN,exceeded:aO}},getContainer:function(){return this.container},pointToPixel:function(T,aM){aM=aM||this.getZoom();return this.projection.pointToPixel(T,aM,this.mercatorCenter,this.getSize())},pixelToPoint:function(T,aM){aM=aM||this.getZoom();return this.projection.pixelToPoint(T,aM,this.mercatorCenter,this.getSize())},pointToOverlayPixel:function(T,aN){if(!T){return}var aO=new e(T.lng,T.lat);var aM=this.pointToPixel(aO,aN);aM.x-=this.offsetX;aM.y-=this.offsetY;return aM},overlayPixelToPoint:function(T,aN){if(!T){return}var aM=new aH(T.x,T.y);aM.x+=this.offsetX;aM.y+=this.offsetY;return this.pixelToPoint(aM,aN)},getBounds:function(){if(!this.isLoaded()){return new r()}var aP=this.getSize();this.width=aP.width;this.height=aP.height;var aM=arguments[0]||{},aO=aM.margins||[0,0,0,0],T=aM.zoom||null,aQ=this.pixelToPoint({x:aO[3],y:this.height-aO[2]},T),aN=this.pixelToPoint({x:this.width-aO[1],y:aO[0]},T);return new r(aQ,aN)},isLoaded:function(){return !!this.loaded},_getBestLevel:function(aM,aN){var aQ=this.getMapType();var aS=aN.margins||[10,10,10,10],aP=aN.zoomFactor||0,aT=aS[1]+aS[3],aR=aS[0]+aS[2],T=aQ.getMinZoom(),aV=aQ.getMaxZoom();for(var aO=aV;aO>=T;aO--){var aU=this.getMapType().getZoomUnits(aO);if(aM.toSpan().lng/aU<this.width-aT&&aM.toSpan().lat/aU<this.height-aR){break}}aO+=aP;if(aO<T){aO=T}if(aO>aV){aO=aV}return aO},getViewport:function(aU,aM){var aY={center:this.getCenter(),zoom:this.getZoom()};if(!aU||!aU instanceof r&&aU.length==0||aU instanceof r&&aU.isEmpty()){return aY}var aW=[];if(aU instanceof r){aW.push(aU.getNorthEast());aW.push(aU.getSouthWest())}else{aW=aU.slice(0)}aM=aM||{};var aQ=[];for(var aR=0,aP=aW.length;aR<aP;aR++){aQ.push(aW[aR])}var aN=new r();for(var aR=aQ.length-1;aR>=0;aR--){aN.extend(aQ[aR])}if(aN.isEmpty()){return aY}var T=aN.getCenter();var aX=this._getBestLevel(aN,aM);if(aM.margins){var aT=aM.margins,aS=(aT[1]-aT[3])/2,aV=(aT[0]-aT[2])/2,aO=this.getMapType().getZoomUnits(aX);T.lng=T.lng+aO*aS;T.lat=T.lat+aO*aV}return{center:T,zoom:aX}},setViewport:function(aM,aP){var T;if(aM&&aM.center){T=aM}else{T=this.getViewport(aM,aP)}aP=aP||{};var aN=aP.delay||200;if(T.zoom==this.zoomLevel&&aP.enableAnimation!=false){var aO=this;setTimeout(function(){aO.panTo(T.center,{duration:210})},aN)}else{this.centerAndZoom(T.center,T.zoom)}},getPanes:function(){return this._panes},getOverlays:function(){var aO=[],aP=this._overlays,aN=this._customOverlays;if(aP){for(var aM in aP){if(aP[aM] instanceof az){aO.push(aP[aM])}}}if(aN){for(var aM=0,T=aN.length;aM<T;aM++){aO.push(aN[aM])}}return aO},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var T=this.temp.registerIndex;T<BMap._register.length;T++){BMap._register[T](this)}this.temp.registerIndex=T},highResolutionEnabled:function(){return this.config.enableHighResolution&&window.devicePixelRatio>1},enableHighResolution:function(){this.config.enableHighResolution=true},disableHighResolution:function(){this.config.enableHighResolution=false},addHotspot:function(aM){if(aM instanceof J){this._hotspots[aM.guid]=aM;aM.initialize(this)}var T=this;am.load("hotspot",function(){T._asyncRegister()})},removeHotspot:function(T){if(this._hotspots[T.guid]){delete this._hotspots[T.guid]}},clearHotspots:function(){this._hotspots={}},_checkZoom:function(){var aM=this.mapType.getMinZoom();var aN=this.mapType.getMaxZoom();var T=this.config;T.minZoom=T.userMinZoom||aM;T.maxZoom=T.userMaxZoom||aN;if(T.minZoom<aM){T.minZoom=aM}if(T.maxZoom>aN){T.maxZoom=aN}},setMinZoom:function(T){if(T>this.config.maxZoom){T=this.config.maxZoom}this.config.userMinZoom=T;this._updateZoom()},setMaxZoom:function(T){if(T<this.config.minZoom){T=this.config.minZoom}this.config.userMaxZoom=T;this._updateZoom()},_updateZoom:function(){this._checkZoom();var T=this.config;if(this.zoomLevel<T.minZoom){this.setZoom(T.minZoom)}else{if(this.zoomLevel>T.maxZoom){this.setZoom(T.maxZoom)}}var aM=new ar("onzoomspanchange");aM.minZoom=T.minZoom;aM.maxZoom=T.maxZoom;this.dispatchEvent(aM)},getViewTiles:function(){return this._viewTiles},vectorMapEnabled:function(){return this.config.vectorMapLevel!=99},setTrafficOn:function(){this.config.trafficStatus=true;var T=new ar("ontrafficchange");this.dispatchEvent(T)},setTrafficOff:function(){this.config.trafficStatus=false;var T=new ar("ontrafficchange");this.dispatchEvent(T)}});window.BMAP_CANVAS_DRAWER=3;(function(){window.asyncMdlVer={control:"otzzoh",hotspot:"fzmizk",map:"0g5gtk",marker:"3kozvf",opmb:"mrzahz",poly:"1aehwb",tile:"uhunrl",vector:"besg3a",streetview:"30xam4",layer:"3bn2hs"};window.chkVersion=function(T){try{var aM=window.localStorage;if(!aM){return false}return aM[T]&&aM[T].length>0}catch(aN){return false}};window.saveVersion=function(T,aR,aP){try{var aN=window.localStorage;if(aN){for(var aM=aN.length,aO=aM-1;aO>=0;aO--){var aS=aN.key(aO);if(aS.indexOf(aP)>-1){aN.removeItem(aS)}}aN.setItem(T,aR)}}catch(aQ){}};window.getVersion=function(T){try{var aM=window.localStorage;if(!aM){return""}return aM.getItem(T)}catch(aN){return""}}})();function aD(aO){var T={duration:1000,fps:30,delay:0,transition:f.linear,onStop:function(){}};this._anis=[];if(aO){for(var aM in aO){T[aM]=aO[aM]}}this._opts=T;if(I(T.delay)){var aN=this;setTimeout(function(){aN.start()},T.delay)}else{if(T.delay!=aD.INFINITE){this.start()}}}aD.INFINITE="INFINITE";aD.prototype.start=function(){this._beginTime=v();this._endTime=this._beginTime+this._opts.duration;this._launch()};aD.prototype.add=function(T){this._anis.push(T)};aD.prototype._launch=function(){var aN=this;var T=v();if(T>=aN._endTime){if(aq(aN._opts.render)){aN._opts.render(aN._opts.transition(1))}if(aq(aN._opts.finish)){aN._opts.finish()}if(aN._anis.length>0){var aM=aN._anis[0];aM._anis=[].concat(aN._anis.slice(1));aM.start()}return}aN.schedule=aN._opts.transition((T-aN._beginTime)/aN._opts.duration);if(aq(aN._opts.render)){aN._opts.render(aN.schedule)}if(!aN.terminative){aN._timer=setTimeout(function(){aN._launch()},1000/aN._opts.fps)}};aD.prototype.stop=function(aM){this.terminative=true;for(var T=0;T<this._anis.length;T++){this._anis[T].stop();this._anis[T]=null}this._anis.length=0;if(this._timer){clearTimeout(this._timer);this._timer=null}this._opts.onStop(this.schedule);if(aM){this._endTime=this._beginTime;this._launch()}};aD.prototype.cancel=function(){if(this._timer){clearTimeout(this._timer)}this._endTime=this._beginTime;this.schedule=0};aD.prototype.setFinishCallback=function(T){if(this._anis.length>0){this._anis[this._anis.length-1]._opts.finish=T}else{this._opts.finish=T}};var f={linear:function(T){return T},reverse:function(T){return 1-T},easeInQuad:function(T){return T*T},easeInCubic:function(T){return Math.pow(T,3)},easeOutQuad:function(T){return -(T*(T-2))},easeOutCubic:function(T){return Math.pow((T-1),3)+1},easeInOutQuad:function(T){if(T<0.5){return T*T*2}else{return -2*(T-2)*T-1}return},easeInOutCubic:function(T){if(T<0.5){return Math.pow(T,3)*4}else{return Math.pow(T-1,3)*4+1}},easeInOutSine:function(T){return(1-Math.cos(Math.PI*T))/2}};f["ease-in"]=f.easeInQuad;f["ease-out"]=f.easeOutQuad;var aK={imgPath:"http://map.baidu.com/res_mobile2/images/"};function aL(aN,T){var aM=aN.style;aM.left=T[0]+"px";aM.top=T[1]+"px"}function l(T){T.style.MozUserSelect="none"}function n(T){return T&&T.parentNode&&T.parentNode.nodeType!=11}function V(aM,T){aC.dom.insertHTML(aM,"beforeEnd",T);return aM.lastChild}function t(T){var aM={left:0,top:0};while(T&&T.offsetParent){aM.left+=T.offsetLeft;aM.top+=T.offsetTop;T=T.offsetParent}return aM}function ac(T){var T=window.event||T;T.stopPropagation?T.stopPropagation():T.cancelBubble=true}function x(T){var T=window.event||T;T.preventDefault?T.preventDefault():T.returnValue=false;return false}function av(T){ac(T);return x(T)}function H(){var T=document.documentElement,aM=document.body;if(T&&(T.scrollTop||T.scrollLeft)){return[T.scrollTop,T.scrollLeft]}else{if(aM){return[aM.scrollTop,aM.scrollLeft]}else{return[0,0]}}}function p(aM,T){if(!aM||!T){return}return Math.round(Math.sqrt(Math.pow(aM.x-T.x,2)+Math.pow(aM.y-T.y,2)))}function o(aM,T,aN){var aO=document.createElement(aM);if(aN){aO=document.createElementNS(aN,aM)}return aC.dom.setAttrs(aO,T||{})}function ak(T){if(T.currentStyle){return T.currentStyle}else{if(T.ownerDocument&&T.ownerDocument.defaultView){return T.ownerDocument.defaultView.getComputedStyle(T,null)}}}function aq(T){return typeof T=="function"}function I(T){return typeof T=="number"}function aB(T){return typeof T=="string"}function ad(T){return typeof T!="undefined"}function B(T){return typeof T=="object"}function c(T){return"[object Array]"==Object.prototype.toString.call(T)}function h(){if(typeof h.result!="boolean"){h.result=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return h.result}function al(T){return T*Math.PI/180}var ar=aC.lang.Event;function ao(){return !!(aC.platform.isIphone||aC.platform.isIpad||aC.platform.isAndroid)}function v(){return(new Date).getTime()}BMap.logCountError=(function(){var ba=true,aU=true,be=true,a0=true,aX=new Image(),bc=0,a5=0,a7=0,aV=0,aR=0,bi=0,a6=0,aS=0,aP=0,bb=0,a4=0,aN=0,aO=0,a2=0,a9=0,aW=0,bh=0,aM=0,bg=0,T=0,bd=0,a3=0,aT=0,bf=0;function a8(){if(window.speedTest&&window.speedTest.ab){bh=window.speedTest.ab}a8=function(){return bh};return bh}function a1(bk,bl,bn,bm){var bj=(12<=bm&&bm<=18);if(bl){if(bk){a5+=1;if(bj){aS+=1}}else{bc+=1;if(bj){a6+=1}}if(bn==1){if(bk){bi+=1;if(bj){aN+=1}}else{aR+=1;if(bj){a4+=1}}}}else{if(bk){aV+=1;if(bj){bb+=1}}else{a7+=1;if(bj){aP+=1}}}if(ba){ba=false;setTimeout(function(){var bo=(Math.random()*100000000).toFixed(0);ba=true;aX.src="http://map.baidu.com/mobile/img/transparent.gif?type=pic&newmap=1&t="+bo+"&code=20066&pic_pl_error="+bc+"&pic_ph_error="+a5+"&pic_pl_all="+a7+"&pic_ph_all="+aV+"&pic_pl_s="+aR+"&pic_ph_s="+bi+"&pic_pl_error_1="+a6+"&pic_ph_error_1="+aS+"&pic_pl_all_1="+aP+"&pic_ph_all_1="+bb+"&pic_pl_s_1="+a4+"&pic_ph_s_1="+bi+"&ab="+a8();bc=0;a5=0;a7=0;aV=0;aR=0;bi=0;a6=0;aS=0;aP=0;bb=0;a4=0;aN=0},10000)}}function aY(bj){if(bj){a2+=1}else{aW+=1}if(aU){aU=false;setTimeout(function(){var bk=(Math.random()*100000000).toFixed(0);aU=true;aX.src="http://map.baidu.com/mobile/img/transparent.gif?type=vec&newmap=1&t="+bk+"&code=20066&vec_pl_error="+aO+"&vec_ph_error="+a2+"&vec_pl_all="+a9+"&vec_ph_all="+aW+"&ab="+a8();aO=0;a2=0;a9=0;aW=0},10000)}}function aZ(bj,bk){var bl=a8();if(bl==1){aM+=bj;bg+=bk}if(bl==2){T+=bj;bd+=bk}if(be){be=false;setTimeout(function(){var bm=(Math.random()*100000000).toFixed(0);be=true;aX.src="http://map.baidu.com/mobile/img/transparent.gif?res=webapp&counttype=touch&newmap=1&t="+bm+"&move1="+aM+"&zoom1="+bg+"&move2="+T+"&zoom2="+bd;aM=0;bg=0;T=0;bd=0},10000)}}function aQ(bj,bk){if(bj){a3+=1;if(bk==1){bf+=1}}else{aT+=1}if(a0){a0=false;setTimeout(function(){var bl=(Math.random()*100000000).toFixed(0);a0=true;aX.src="http://map.baidu.com/mobile/img/transparent.gif?type=stpic&t="+bl+"&code=20066&st_pic_error="+a3+"&st_pic_all="+aT+"&st_pic_s="+bf;a3=0;aT=0;bf=0},10000)}}return{countPic:a1,countVec:aY,countTouch:aZ,countStPic:aQ}})();function Z(aM,T){if(aM.data("events")&&aM.data("events")[T]){return true}else{return false}}var aF={request:function(aN,T){var aM=o("script",{src:aN,type:"text/javascript",charset:"utf-8"});if(T){BMap.logCountError.countVec(false);aM.onerror=function(){BMap.logCountError.countVec(true)}}aM.addEventListener("load",function(aP){var aO=aP.target;aO.parentNode.removeChild(aO)},false);document.getElementsByTagName("head")[0].appendChild(aM);aM=null}};window.sendReqNo=0;function am(){}aC.object.extend(am,{Request:{INITIAL:-1,WAITING:0,COMPLETED:1},getDependency:function(){return{vector:["tile"],poly:["marker"],layer:["vector"]}},Config:{_baseUrl:"/mobile/?qt=getMobileModules&v=2&"},delayFlag:false,ModuleTree:{_modules:{},_arrMdls:[]},load:function(aM,aO){var T=this.getModule(aM);if(T._status==this.Request.COMPLETED){return}else{if(T._status==this.Request.INITIAL){this.combine(aM);this.pushUniqueMdl(aM);var aN=this;if(aN.delayFlag==false){aN.delayFlag=true;window.setTimeout(function(){var aV=aN.ModuleTree._arrMdls.slice(0);var aX=[];for(var aR=0,aQ=aV.length;aR<aQ;aR++){var aW=aV[aR],aP=window.asyncMdlVer[aW],aT="async_"+aW+"_"+aP;if(!window.chkVersion(aT)){aV[aV[aR]]="";aX.push(aW+"_"+aP)}else{aV[aV[aR]]=window.getVersion(aT)}}if(aX.length==0){for(var aR=0,aQ=aV.length;aR<aQ;aR++){var aY=aV[aR],aT="async_"+aY+"_"+window.asyncMdlVer[aY],aU=window.getVersion(aT);am.run(aY,aU)}}else{var aS=aN.Config._baseUrl+"mod="+aX.join(",")+"&sendReqNo="+window.sendReqNo+"&cbk=_jsload";aF.request(aS);window["sendReqNo"+window.sendReqNo]=aV;window.sendReqNo++}aN.delayFlag=false;aN.ModuleTree._arrMdls.length=0},1)}T._status=this.Request.WAITING}T._callbacks.push(aO)}},combine:function(T){var aN=this.getDependency();if(T&&aN[T]){var aN=aN[T];for(var aM=0;aM<aN.length;aM++){this.combine(aN[aM]);if(!this.ModuleTree._modules[aN[aM]]){this.pushUniqueMdl(aN[aM])}}}},pushUniqueMdl:function(aO){var T=this.ModuleTree._arrMdls;for(var aN=0,aM=T.length;aN<aM;aN++){if(T[aN]==aO){return}}T.push(aO)},getModule:function(aM){var T;if(!this.ModuleTree._modules[aM]){this.ModuleTree._modules[aM]={};this.ModuleTree._modules[aM]._status=this.Request.INITIAL;this.ModuleTree._modules[aM]._callbacks=[]}T=this.ModuleTree._modules[aM];return T},run:function(aO,aR){var aM="async_"+aO+"_"+window.asyncMdlVer[aO],aQ="async_"+aO;if(!window.chkVersion(aM)){window.saveVersion(aM,aR,aQ)}var aN=this.getModule(aO);try{eval(aR)}catch(aS){return}aN._status=this.Request.COMPLETED;for(var aP=0,T=aN._callbacks.length;aP<T;aP++){aN._callbacks[aP]()}aN._callbacks.length=0}});window._jsload=function(aQ,aS,aR){var T=window["sendReqNo"+aR],aN=aQ.split("_")[0];T[aN]=aS;var aP=true;for(var aO=0,aM=T.length;aO<aM;aO++){if(T[T[aO]].length<=0){aP=false;break}}if(aP){for(var aO=0,aM=T.length;aO<aM;aO++){var aQ=T[aO],aS=T[aQ];am.run(aQ,aS)}T.length=0;delete window["sendReqNo"+aR]}};function aH(T,aM){this.x=T||0;this.y=aM||0}aH.prototype.equals=function(T){return T&&T.x==this.x&&T.y==this.y};function U(aM,T){this.width=aM||0;this.height=T||0}U.prototype.equals=function(T){return T&&this.width==T.width&&this.height==T.height};function J(T,aM){if(!T){return}this._position=T;this.guid="spot"+(J.guid++);aM=aM||{};this._text=aM.text||"";this._offsets=aM.offsets?aM.offsets.slice(0):[5,5,5,5];this._userData=aM.userData||null;this._minZoom=aM.minZoom||null;this._maxZoom=aM.maxZoom||null}J.guid=0;aC.extend(J.prototype,{initialize:function(T){if(this._minZoom==null){this._minZoom=T.config.minZoom}if(this._maxZoom==null){this._maxZoom=T.config.maxZoom}},setPosition:function(T){if(T instanceof e){this._position=T}},getPosition:function(){return this._position},setText:function(T){this._text=T},getText:function(){return this._text},setUserData:function(T){this._userData=T},getUserData:function(){return this._userData}});function M(){this._map=null;this._container;this._type="control";this._visible=true}aC.lang.inherits(M,aC.lang.Class,"Control");aC.extend(M.prototype,{initialize:function(T){this._map=T;if(this._container){T.container.appendChild(this._container);return this._container}return},_i:function(T){if(!this._container&&this.initialize&&aq(this.initialize)){this._container=this.initialize(T)}this._opts=this._opts||{printable:false};this._setStyle();this._setPosition();if(this._container){this._container._jsobj=this}},_setStyle:function(){var aM=this._container;if(aM){var T=aM.style;T.position="absolute";T.zIndex=this._container.style.zIndex||"10";T.MozUserSelect="none";T.WebkitTextSizeAdjust="none";if(!this._opts.printable){aC.dom.addClass(aM,"BMap_noprint")}}},remove:function(){this._map=null;if(!this._container){return}this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container._jsobj=null;this._container=null},_render:function(){this._container=V(this._map.container,"<div unselectable='on'></div>");if(this._visible==false){aC.dom.hide(this._container)}return this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(aO){if(this.anchorFixed||!I(aO)||isNaN(aO)||aO<BMAP_ANCHOR_TOP_LEFT||aO>BMAP_ANCHOR_BOTTOM_RIGHT){aO=this.defaultAnchor}this._opts=this._opts||{printable:false};this._opts.offset=this._opts.offset||this.defaultOffset;var aN=this._opts.anchor;this._opts.anchor=aO;if(!this._container){return}var aQ=this._container;var T=this._opts.offset.width;var aP=this._opts.offset.height;if(this instanceof O){if(this._map&&this._map.highResolutionEnabled()){aQ.childNodes[1].style.height="2px";aQ.childNodes[2].style.height="4px";aQ.childNodes[3].style.height="4px";aQ.style.height="19px"}}aQ.firstChild.style.cssText="font-size:11px;line-height:18px;";aQ.style.left=aQ.style.top=aQ.style.right=aQ.style.bottom="auto";switch(aO){case BMAP_ANCHOR_TOP_LEFT:aQ.style.top=aP+"px";aQ.style.left=T+"px";break;case BMAP_ANCHOR_TOP_RIGHT:aQ.style.top=aP+"px";aQ.style.right=T+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:aQ.style.bottom=aP+"px";aQ.style.left=T+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:aQ.style.bottom=aP+"px";aQ.style.right=T+"px";break;default:break}var aM=["TL","TR","BL","BR"];aC.dom.removeClass(this._container,"anchor"+aM[aN]);aC.dom.addClass(this._container,"anchor"+aM[aO])},getAnchor:function(){return this._opts.anchor},setOffset:function(T){if(!(T instanceof U)){return}this._opts=this._opts||{printable:false};this._opts.offset=new U(T.width,T.height);if(!this._container){return}this.setAnchor(this._opts.anchor)},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){if(this._visible==true){return}this._visible=true;if(this._container){aC.dom.show(this._container)}},hide:function(){if(this._visible==false){return}this._visible=false;if(this._container){aC.dom.hide(this._container)}},isPrintable:function(){return !!this._opts.printable},isVisible:function(){if(!this._container&&!this._map){return false}return !!this._visible}});window.BMAP_ANCHOR_TOP_LEFT=0;window.BMAP_ANCHOR_TOP_RIGHT=1;window.BMAP_ANCHOR_BOTTOM_LEFT=2;window.BMAP_ANCHOR_BOTTOM_RIGHT=3;function O(T){M.call(this);T=T||{};this._opts={printable:false};this._opts=aC.object.extend(aC.object.extend(this._opts,{color:"black",unit:"metric"}),T);this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new U(81,18);this.setAnchor(T.anchor);this._units={metric:{name:"metric",conv:1,incon:1000,u1:"\u7c73",u2:"\u516c\u91cc"}};if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._scaleText=null;this._numberArray={};this._asyncLoadCode()}window.BMAP_UNIT_METRIC="metric";aC.lang.inherits(O,M,"ScaleControl");aC.object.extend(O.prototype,{initialize:function(T){this._map=T;return this._container},setColor:function(T){this._opts.color=T+""},getColor:function(){return this._opts.color},_asyncLoadCode:function(){var T=this;am.load("control",function(){T._asyncDraw()})}});function r(T,aM){if(T&&!aM){aM=T}this._sw=this._ne=null;this._swLng=this._swLat=null;this._neLng=this._neLat=null;if(T){this._sw=new e(T.lng,T.lat);this._ne=new e(aM.lng,aM.lat);this._swLng=T.lng;this._swLat=T.lat;this._neLng=aM.lng;this._neLat=aM.lat}}aC.object.extend(r.prototype,{isEmpty:function(){return !this._sw||!this._ne},equals:function(T){if(!(T instanceof r)||this.isEmpty()){return false}return this.getSouthWest().equals(T.getSouthWest())&&this.getNorthEast().equals(T.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getCenter:function(){if(this.isEmpty()){return null}return new e((this._swLng+this._neLng)/2,(this._swLat+this._neLat)/2)},extend:function(T){if(!(T instanceof e)){return}var aM=T.lng,aN=T.lat;if(!this._sw){this._sw=new e(0,0)}if(!this._ne){this._ne=new e(0,0)}if(!this._swLng||this._swLng>aM){this._sw.lng=this._swLng=aM}if(!this._neLng||this._neLng<aM){this._ne.lng=this._neLng=aM}if(!this._swLat||this._swLat>aN){this._sw.lat=this._swLat=aN}if(!this._neLat||this._neLat<aN){this._ne.lat=this._neLat=aN}},toSpan:function(){if(this.isEmpty()){return new e(0,0)}return new e(Math.abs(this._neLng-this._swLng),Math.abs(this._neLat-this._swLat))}});function e(T,aM){this.lng=parseFloat(T);this.lat=parseFloat(aM)}e.prototype.equals=function(T){return T&&this.lat==T.lat&&this.lng==T.lng};function au(T){this._mapType=T}aC.extend(au.prototype,{pointToPixel:function(aM,aQ,aP,aO){if(!aM){return}var aN=this._mapType.getZoomUnits(aQ);var T=Math.round((aM.lng-aP.lng)/aN+aO.width/2);var aR=Math.round((aP.lat-aM.lat)/aN+aO.height/2);return new aH(T,aR)},pixelToPoint:function(aO,aR,aQ,aP){if(!aO){return}var aM=this._mapType.getZoomUnits(aR);var aN=aQ.lng+aM*(aO.x-aP.width/2);var aS=aQ.lat-aM*(aO.y-aP.height/2);var T=new e(aN,aS);return T}});function L(){this._type="overlay"}aC.lang.inherits(L,aC.lang.Class,"Overlay");L.getZIndex=function(T){T=T*1;if(!T){return 0}return(T*-100000)<<1};aC.extend(L.prototype,{_i:function(T){if(!this.domElement&&aq(this.initialize)){this.domElement=this.initialize(T);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}}this.draw()},initialize:function(T){throw"initialize\u65b9\u6cd5\u672a\u5b9e\u73b0"},draw:function(){throw"draw\u65b9\u6cd5\u672a\u5b9e\u73b0"},remove:function(){if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}this.domElement=null;this.dispatchEvent(new ar("onremove"))},hide:function(){if(this.domElement){aC.dom.hide(this.domElement)}},show:function(){if(this.domElement){aC.dom.show(this.domElement)}},isVisible:function(){if(!this.domElement){return false}if(this.domElement.style.display=="none"||this.domElement.style.visibility=="hidden"){return false}return true}});BMap.register(function(aN){var T=aN.temp;T.overlayDiv=aN.overlayDiv=aM(aN.platform,200);aN._panes.floatPane=aM(T.overlayDiv,800);aN._panes.markerMouseTarget=aM(T.overlayDiv,700);aN._panes.floatShadow=aM(T.overlayDiv,600);aN._panes.labelPane=aM(T.overlayDiv,500);aN._panes.markerPane=aM(T.overlayDiv,400);aN._panes.markerShadow=aM(T.overlayDiv,300);aN._panes.mapPane=aM(T.overlayDiv,200);function aM(aO,aR){var aQ=o("div"),aP=aQ.style;aP.position="absolute";aP.top=aP.left=aP.width=aP.height="0";aP.zIndex=aR;aO.appendChild(aQ);return aQ}});function az(){aC.lang.Class.call(this);L.call(this);this.map=null;this._visible=true;this._dblclickTime=0}aC.lang.inherits(az,L,"OverlayInternal");aC.extend(az.prototype,{initialize:function(T){this.map=T;aC.lang.Class.call(this,this.guid);return null},getMap:function(){return this.map},draw:function(){},remove:function(){this.map=null;aC.lang.decontrol(this.guid);L.prototype.remove.call(this)},hide:function(){if(this._visible==false){return}this._visible=false},show:function(){if(this._visible==true){return}this._visible=true},isVisible:function(){if(!this.domElement){return false}return !!this._visible},getContainer:function(){return this.domElement},setConfig:function(aM){aM=aM||{};for(var T in aM){this._config[T]=aM[T]}},setZIndex:function(T){this.zIndex=T},enableMassClear:function(){this._config.enableMassClear=true},disableMassClear:function(){this._config.enableMassClear=false}});function an(){this.map=null;this._overlays={};this._customOverlays=[]}BMap.register(function(aM){var T=new an();T.map=aM;aM._overlays=T._overlays;aM._customOverlays=T._customOverlays;aM.addEventListener("load",function(aN){T.draw(aN)});aM.addEventListener("moveend",function(aN){T.draw(aN)});aM.addEventListener("zoomend",function(aN){T.draw(aN)});aM.addEventListener("addoverlay",function(aR){var aO=aR.target;if(aO instanceof az){if(!T._overlays[aO.guid]){T._overlays[aO.guid]=aO}}else{var aQ=false;for(var aP=0,aN=T._customOverlays.length;aP<aN;aP++){if(T._customOverlays[aP]===aO){aQ=true;break}}if(!aQ){T._customOverlays.push(aO)}}});aM.addEventListener("removeoverlay",function(aQ){var aO=aQ.target;if(aO instanceof az){delete T._overlays[aO.guid]}else{for(var aP=0,aN=T._customOverlays.length;aP<aN;aP++){if(T._customOverlays[aP]===aO){T._customOverlays.splice(aP,1);break}}}});aM.addEventListener("clearoverlays",function(aQ){for(var aP in T._overlays){if(T._overlays[aP]._config.enableMassClear){T._overlays[aP].remove();delete T._overlays[aP]}}for(var aO=0,aN=T._customOverlays.length;aO<aN;aO++){if(T._customOverlays[aO].enableMassClear!=false){T._customOverlays[aO].remove();T._customOverlays[aO]=null;T._customOverlays.splice(aO,1);aO--;aN--}}})});an.prototype.draw=function(aM){for(var T in this._overlays){this._overlays[T].draw()}aC.array.each(this._customOverlays,function(aN){aN.draw()})};function ap(T){az.call(this);this._config={strokeColor:"#3a6bdb",strokeWeight:5,strokeOpacity:0.65,strokeStyle:"solid",enableMassClear:true,getParseTolerance:null,getParseCacheIndex:null,enableParse:true,clickable:true};T=T||{};this.setConfig(T);if(this._config.strokeWeight<=0){this._config.strokeWeight=5}if(this._config.strokeOpacity<0||this._config.strokeOpacity>1){this._config.strokeOpacity=0.65}if(this._config.strokeStyle!="solid"&&this._config.strokeStyle!="dashed"){this._config.strokeStyle="solid"}if(ad(T.enableClicking)){this._config.clickable=T.enableClicking}this.domElement=null;this._bounds=new BMap.Bounds(0,0,0,0);this._parseCache=[];this._temp={}}aC.lang.inherits(ap,az,"Graph");ap.getGraphPoints=function(aM){var T=[];if(!aM){return T}if(aB(aM)){var aN=aM.split(";");aC.array.each(aN,function(aP){var aO=aP.split(",");T.push(new e(aO[0],aO[1]))})}if(aM.constructor==Array&&aM.length>0){T=aM}return T};ap.parseTolerance=[0.09,0.005,0.0001,0.00001];aC.extend(ap.prototype,{initialize:function(T){this.map=T;return null},draw:function(){},setPath:function(T){this._parseCache.length=0;this.points=ap.getGraphPoints(T).slice(0);this._calcBounds()},_calcBounds:function(){if(!this.points){return}var T=this;T._bounds=new r();aC.array.each(this.points,function(aM){T._bounds.extend(aM)})},getPath:function(){return this.points},setPositionAt:function(aM,T){if(!T||!this.points[aM]){return}this._parseCache.length=0;this.points[aM]=new e(T.lng,T.lat);this._calcBounds()},setStrokeColor:function(T){this._config.strokeColor=T},getStrokeColor:function(){return this._config.strokeColor},setStrokeWeight:function(T){if(T>0){this._config.strokeWeight=T}},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(T){if(!T||T>1||T<0){return}this._config.strokeOpacity=T},getStrokeOpacity:function(){return this._config.strokeOpacity},setStrokeStyle:function(T){if(T!="solid"&&T!="dashed"){return}this._config.strokeStyle=T},getStrokeStyle:function(){return this._config.strokeStyle},getBounds:function(){return this._bounds},remove:function(){az.prototype.remove.call(this);this._parseCache.length=0}});function q(aM,aN,aO){if(!aM||!aN){return}this.imageUrl=aM;this.size=aN;var T=new U(Math.floor(aN.width/2),Math.floor(aN.height/2));var aP={anchor:T,imageOffset:new U(0,0)};aO=aO||{};aC.extend(aP,aO);this.anchor=aP.anchor;this.imageOffset=aP.imageOffset;this.printImageUrl=aO.printImageUrl||""}var N=q.prototype;N.setImageUrl=function(T){if(!T){return}this.imageUrl=T};N.setPrintImageUrl=function(T){if(!T){return}this.printImageUrl=T};N.setSize=function(T){if(!T){return}this.size=new U(T.width,T.height)};N.setAnchor=function(T){if(!T){return}this.anchor=new U(T.width,T.height)};N.setImageOffset=function(T){if(!T){return}this.imageOffset=new U(T.width,T.height)};N.toString=function(){return"Icon"};var ae=aK.imgPath+"red_marker.png";var aA=new q(ae,new U(19,25),{anchor:new U(10,25)});var F=new q(ae,new U(20,11),{anchor:new U(6,11),imageOffset:new U(-19,-13)});function C(T,aN){az.call(this);aN=aN||{};this.point=T;this.map=null;this._config={offset:new U(0,0),icon:aA,shadow:F,title:"",baseZIndex:0,clickable:true,zIndexFixed:false,isTop:false,enableMassClear:true};this.setConfig(aN);if(aN.icon&&!aN.shadow){this._config.shadow=null}if(ad(aN.enableClicking)){this._config.clickable=aN.enableClicking}var aM=this;am.load("marker",function(){aM._draw()})}C.TOP_ZINDEX=L.getZIndex(-90)+1000000;aC.lang.inherits(C,az,"Marker");aC.extend(C.prototype,{setIcon:function(T){if(T instanceof q){this._config.icon=T}},getIcon:function(){return this._config.icon},setShadow:function(T){if(T instanceof q){this._config.shadow=T}},getShadow:function(){return this._config.shadow},getPosition:function(){return this.point},setPosition:function(T){if(T instanceof e){this.point=new e(T.lng,T.lat)}},setTop:function(aM,T){this._config.isTop=!!aM;if(aM){this._addi=T||0}},setTitle:function(T){this._config.title=T+""},getTitle:function(){return this._config.title},setOffset:function(T){if(T instanceof U){this._config.offset=T}},getOffset:function(){return this._config.offset}});function ag(T,aN){ap.call(this,aN);this.setPath(T);var aM=this;am.load("poly",function(){aM._draw()})}aC.lang.inherits(ag,ap,"Polyline");function ay(T){this.map=T;this.mapTypeLayers=[];this.tileLayers=[];this.bufferNumber=300;this.realBufferNumber=0;this.mapTiles={};this.bufferTiles={};this.numLoading=0;this.isFirstTile=true;this._mapTypeLayerContainer=this._createDiv(1);this._vectorLayerContainer=this._createDiv(2);this._normalLayerContainer=this._createDiv(3);T.platform.appendChild(this._mapTypeLayerContainer);T.platform.appendChild(this._vectorLayerContainer);T.platform.appendChild(this._normalLayerContainer)}BMap.register(function(aM){var T=new ay(aM);T.initialize();aM.tileMgr=T});aC.extend(ay.prototype,{initialize:function(){var T=this,aM=T.map;aM.addEventListener("loadcode",function(){T.loadTiles()});aM.addEventListener("addtilelayer",function(aN){T.addTileLayer(aN)});aM.addEventListener("removetilelayer",function(aN){T.removeTileLayer(aN)});aM.addEventListener("zoomstartcode",function(aN){T._zoom(aN)});aM.addEventListener("zoomend",function(aN){T.setRasterTrafficStatus(aN)});aM.addEventListener("trafficchange",function(aN){if(!this.rasterTrafficLayer){this.rasterTrafficLayer=new af()}T.setRasterTrafficStatus(aN)});T.addMapClickEvent()},loadTiles:function(){var aS=this;if(!aS.loaded){aS.initMapTypeTiles()}aS.moveGridTiles();if(!aS.loaded){aS.loaded=true;var aQ="tile",aT="vector",aR=window.asyncMdlVer[aQ],aP=window.asyncMdlVer[aT],T="async_"+aQ+"_"+aR,aM="async_"+aT+"_"+aP,aO=window.getVersion(T),aN=window.getVersion(aM);if(aR&&aO&&aP&&aN){am.run(aQ,aO);am.run(aT,aN);aS._asyncLoadCode()}else{if(aS.map.vectorMapEnabled()){am.load("vector",function(){aS._asyncLoadCode()})}else{am.load("tile",function(){aS._asyncLoadCode()})}}}},initMapTypeTiles:function(){var aM=this.map.getMapType();var aN=aM.getTileLayers();for(var T=0;T<aN.length;T++){var aO=new z();aC.extend(aO,aN[T]);this.mapTypeLayers.push(aO);aO.initialize(this.map,this._mapTypeLayerContainer)}},_createDiv:function(aM){var T=o("div");T.style.position="absolute";T.style.left=T.style.top="0";T.style.zIndex=aM;return T},_checkTilesLoaded:function(){this.numLoading--;var T=this;if(this.isFirstTile){this.map.dispatchEvent(new ar("onfirsttileloaded"));this.isFirstTile=false}if(this.numLoading==0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(T.numLoading==0){T.map.dispatchEvent(new ar("ontilesloaded"));T.isFirstTile=true}T._checkLoadedTimer=null},80)}},getTileName:function(T,aM){return"TILE-"+aM.guid+"-"+T[0]+"-"+T[1]+"-"+T[2]},hideTile:function(aM){var T=aM.img;if(T){if(n(T)){T.parentNode.removeChild(T)}}delete this.mapTiles[aM.name];if(!aM.loaded){T=null;aM._callCbks();aM.img=null;aM.mgr=null}},moveGridTiles:function(){var bc=this.mapTypeLayers,aW=bc.concat(this.tileLayers),a1=aW.length;for(var a5=0;a5<a1;a5++){var aP=aW[a5];if(aP.baseLayer){this.tilesDiv=aP.tilesDiv;var a2=this.tilesDiv;if(this.map.getZoom()>=this.map.config.vectorMapLevel){a2.style.display="none";continue}else{a2.style.display="block"}}if(aP._isVectorLayer){continue}var bh=this.map,bd=bh.getMapType(),bi=bd.getProjection(),a4=bh.zoomLevel,a7=bh.mercatorCenter;var aU=bd.getZoomUnits(a4),aX=bd.getZoomFactor(a4),aV=Math.ceil(a7.lng/aX),aQ=Math.ceil(a7.lat/aX),a0=bd.getTileSize(),aO=[aV,aQ,(a7.lng-aV*aX)/aX*a0,(a7.lat-aQ*aX)/aX*a0],bb=aO[0]-Math.ceil((bh.width/2-aO[2])/a0),aN=aO[1]-Math.ceil((bh.height/2-aO[3])/a0),a8=aO[0]+Math.ceil((bh.width/2+aO[2])/a0),aY=aO[1]+Math.ceil((bh.height/2+aO[3])/a0);var aM=this.mapTiles,aT=-a7.lng/aU,aS=a7.lat/aU,bf=[Math.round(aT),Math.round(aS)],T=bh.getZoom();for(var bg in aM){var bj=aM[bg],be=bj.info;if(be[2]!=T||(be[2]==T&&(bb>be[0]||a8<=be[0]||aN>be[1]||aY<=be[1]))){this.hideTile(bj)}}var aR=-bh.offsetX+bh.width/2,aZ=-bh.offsetY+bh.height/2;aP.tilesDiv.style.left=aR+"px";aP.tilesDiv.style.top=aZ+"px";if(this.tilesOrder){this.tilesOrder.length=0}else{this.tilesOrder=[]}if(bh._viewTiles){bh._viewTiles.length=0}else{bh._viewTiles=[]}for(var ba=bb;ba<a8;ba++){for(var a9=aN;a9<aY;a9++){this.tilesOrder.push([ba,a9]);bh._viewTiles.push({x:ba,y:a9})}}this.tilesOrder.sort((function(bk){return function(bl,bm){return((0.4*Math.abs(bl[0]-bk[0])+0.6*Math.abs(bl[1]-bk[1]))-(0.4*Math.abs(bm[0]-bk[0])+0.6*Math.abs(bm[1]-bk[1])))}})([aO[0]-1,aO[1]-1]));if(!this.map.enableLoadTiles){return}var a3=aP.baseLayer?true:false;if(a3){this.map.dispatchEvent(new ar("ontilesbegin"));this.numLoading+=this.tilesOrder.length}if(aP instanceof af){this.map.dispatchEvent(new ar("onTrafficbegin"));this._statRTCount=0;this._statRTTotalCount=0}for(var ba=0,a6=this.tilesOrder.length;ba<a6;ba++){this.showTile([this.tilesOrder[ba][0],this.tilesOrder[ba][1],T],bf,aP)}}},showTile:function(aQ,aP,aT){var aX=this,aV=aT.baseLayer?true:false;aX.centerPos=aP;var aS=this.map.getMapType(),aN=aX.getTileName(aQ,aT),a0=aS.getTileSize(),aO=(aQ[0]*a0)+aP[0],aM=(-1-aQ[1])*a0+aP[1],aU=[aO,aM],aW=this.mapTiles[aN];if(aW&&aW.img){aL(aW.img,aU);if(aV){if(aW.loaded){this._checkTilesLoaded()}else{aW._addLoadCbk(function(){aX._checkTilesLoaded()})}}return}aW=this.bufferTiles[aN];if(aW&&aW.img){aT.tilesDiv.insertBefore(aW.img,aT.tilesDiv.lastChild);this.mapTiles[aN]=aW;aL(aW.img,aU);if(aV){if(aW.loaded){this._checkTilesLoaded()}else{aW._addLoadCbk(function(){aX._checkTilesLoaded()})}}return}var aZ=a0*Math.pow(2,(aS.getMaxZoom()-aQ[2])),aY=new e(aQ[0]*aZ,aQ[1]*aZ),aR=new aH(aQ[0],aQ[1]),T=aT.getTilesUrl(aR,aQ[2]);aW=new at(this,T,aU,aQ,aT);if(aV){aW._addLoadCbk(function(){aX._checkTilesLoaded()})}aW._load();this.mapTiles[aN]=aW},addTileLayer:function(aP){var aO=this,aM=aP.target;for(var aN=0;aN<aO.tileLayers.length;aN++){if(aO.tileLayers[aN]==aM){return}}var T=aM._isVectorLayer?this._vectorLayerContainer:this._normalLayerContainer;aM.initialize(this.map,T);aO.tileLayers.push(aM)},removeTileLayer:function(aP){var aO=this,aM=aP.target;for(var aN=0,T=aO.tileLayers.length;aN<T;aN++){if(aM==aO.tileLayers[aN]){aO.tileLayers.splice(aN,1)}}aM.remove()},_zoom:function(){var T=this;setTimeout(function(){T.moveGridTiles();T.map.dispatchEvent(new ar("onzoomend"))},10)},addMapClickEvent:function(){var aN=this,T=200,aO=null,aM=0;aN.map.addEventListener("click",function(aP){aM++;if(aM==1){aO=setTimeout(function(){aM=0;var aQ=null,aS=aN.tileLayers;for(var aR in aS){if(aS[aR] instanceof E){aQ=aS[aR];break}}if(aQ&&aQ.vectorClick(aP)){return}if(aN.vectorDrawLib){aN.vectorDrawLib.vectorClick(aP)}},T)}else{clearTimeout(aO);aM=0;return false}})},setRasterTrafficStatus:function(aO){var aM=this,aN=aM.map,T=aN.getZoom();if(aN.config.trafficStatus&&T<aN.config.vectorMapLevel){aN.addTileLayer(aN.rasterTrafficLayer)}else{aN.removeTileLayer(aN.rasterTrafficLayer)}}});function at(aS,T,aP,aM,aO){this.mgr=aS;this.position=aP;this._cbks=[];this.name=aS.getTileName(aM,aO);this.info=aM;this.level=parseInt(aM[2],10);var aT=o("img");l(aT);aT.galleryImg=false;var aR=aT.style;var aN=aS.map.getMapType(),aU=aN.getTileSize();aR.position="absolute";aR.width=aU+"px";aR.height=aU+"px";aR.left=aP[0]+"px";aR.top=aP[1]+"px";this.img=aT;this.src=T;var aQ=this;this.img.onload=function(a0){aQ.loaded=true;if(!aQ.mgr){return}var aW=aQ.mgr;var aV=aW.bufferTiles;if(!aV[aQ.name]){aW.realBufferNumber++;aV[aQ.name]=aQ}if(aQ.img&&!n(aQ.img)){if(aO.tilesDiv){aO.tilesDiv.appendChild(aQ.img)}}var aY=aW.realBufferNumber-aW.bufferNumber;for(var aZ in aV){if(aY<=0){break}if(!aW.mapTiles[aZ]){aV[aZ].mgr=null;var aX=aV[aZ].img;if(aX&&aX.parentNode){aX.parentNode.removeChild(aX)}aX=null;aV[aZ].img=null;delete aV[aZ];aW.realBufferNumber--;aY--}}aQ._callCbks();if(this.src.indexOf("TrafficTileService")>-1){aS._statRTCount++;if(aS._statRTCount==aS._statRTTotalCount){aS.map.dispatchEvent(new ar("onTrafficloaded"))}}};this.isHighResolution=aS.map.highResolutionEnabled();this.img.onerror=function(){var aW=aQ.img,aY=aW?aW.getAttribute("errorCount"):true;if(aW&&(!aY||aY&&aY<5)){aY=aY||0;aY++;aW.src=T;BMap.logCountError.countPic(aQ.isHighResolution,false,aY,aQ.level);aW.setAttribute("errorCount",aY);BMap.logCountError.countPic(aQ.isHighResolution,true,aY,aQ.level)}else{aQ._callCbks();if(!aQ.mgr){return}var aV=aQ.mgr;var aX=aV.map.getMapType();if(aX.getErrorImageUrl()){aQ.error=true;aQ.img.src=aX.getErrorImageUrl();if(aQ.img&&!n(aQ.img)){aO.tilesDiv.appendChild(aQ.img)}}BMap.logCountError.countPic(aQ.isHighResolution,true,6,aQ.level)}};aT=null}at.prototype._addLoadCbk=function(T){this._cbks.push(T)};at.prototype._load=function(){this.img.src=this.src;BMap.logCountError.countPic(this.isHighResolution,false,0,this.level)};at.prototype._callCbks=function(){var aM=this;for(var T=0;T<aM._cbks.length;T++){aM._cbks[T]()}aM._cbks.length=0};function z(T){this.opts=T||{};this.baseLayer=this.opts.baseLayer||false;this.zIndex=this.opts.zIndex||0;this.guid=z._guid++}z._guid=0;aC.lang.inherits(z,aC.lang.Class,"TileLayer");aC.extend(z.prototype,{initialize:function(aN,T){if(this.baseLayer){this.zIndex=-100}this.map=aN;if(!this.tilesDiv){var aO=o("div");var aM=aO.style;aM.position="absolute";aM.zIndex=this.zIndex;aM.left=Math.ceil(-aN.offsetX+aN.width/2)+"px";aM.top=Math.ceil(-aN.offsetY+aN.height/2)+"px";T.appendChild(aO);this.tilesDiv=aO}},remove:function(){if(this.tilesDiv&&this.tilesDiv.parentNode){this.tilesDiv.innerHTML="";this.tilesDiv.parentNode.removeChild(this.tilesDiv)}delete this.tilesDiv},getTilesUrl:function(aM,aN){var T="";if(this.opts.tileUrlTemplate){T=this.opts.tileUrlTemplate.replace(/\{X\}/,aM.x);T=T.replace(/\{Y\}/,aM.y);T=T.replace(/\{Z\}/,aN)}return T},getMapType:function(){return this.mapType}});function af(T){z.call(this,T);this._opts={};T=T||{};this._opts=aC.object.extend(this._opts,T);if(this._opts.predictDate){if(this._opts.predictDate.weekday<1||this._opts.predictDate.weekday>7){this._opts.predictDate=1}if(this._opts.predictDate.hour<0||this._opts.predictDate.hour>23){this._opts.predictDate.hour=0}}this._tileUrl="http://its.map.baidu.com:8002/traffic/"}af.prototype=new z();af.prototype.initialize=function(aM,T){z.prototype.initialize.call(this,aM,T);this._map=aM};af.prototype.getTilesUrl=function(aR,aM){this._map.tileMgr._statRTTotalCount++;var aS="";if(this._opts.predictDate){aS="HistoryService?day="+(this._opts.predictDate.weekday-1)+"&hour="+this._opts.predictDate.hour+"&t="+new Date().getTime()+"&"}else{aS="TrafficTileService?time="+new Date().getTime()+"&"}var aN=this._map,aT=aR.x,aO=aR.y,aQ=Math.floor(aT/200),aP=Math.floor(aO/200),T=this._tileUrl+aS+"level="+aM+"&x="+aT+"&y="+aO;return T.replace(/-(\d+)/gi,"M$1")};function E(aO,aN){var aM={zIndex:2};z.call(this,aM);this._keyWord=aO;this._cityCode=aN;this._isVectorLayer=true;this._map=null;this._container=null;var T=this;am.load("layer",function(){T._asyncLoadCode()})}aC.inherits(E,z,"MDLayer");aC.extend(E.prototype,{initialize:function(aM,T){this._map=aM;this._container=T},remove:function(){this._map=null;this._container=null},setKeyword:function(T){this._keyWord=T},getKeyword:function(){return this._keyWord},setCityCode:function(T){this._cityCode=T},getCityCode:function(){return this._cityCode},refreshLayer:function(){}});function aG(T,aM,aN){this._name=T;this._layers=aM instanceof z?[aM]:aM.slice(0);this._opts={tips:"",labelText:"",minZoom:1,maxZoom:18,tileSize:256,textColor:"black",errorImageUrl:"",projection:new au(this)};if(this._layers.length==1){this._layers[0].baseLayer=true}aC.extend(this._opts,aN||{})}aC.extend(aG.prototype,{getName:function(){return this._name},getTips:function(){return this._opts.tips},getLabelText:function(){return this._opts.labelText},getTileLayer:function(){return this._layers[0]},getTileLayers:function(){return this._layers},getTileSize:function(){this._opts.tileSize=256;var T=this._opts.mapInstance;if(T.highResolutionEnabled()&&T.getZoom()<T.config.vectorMapLevel){this._opts.tileSize=128}return this._opts.tileSize},getMinZoom:function(){return this._opts.minZoom},getMaxZoom:function(){return this._opts.maxZoom},getTextColor:function(){return this._opts.textColor},getProjection:function(){return this._opts.projection},getErrorImageUrl:function(){return this._opts.errorImageUrl},getZoomUnits:function(T){var aN=1,aM=this._opts.mapInstance;if(aM.highResolutionEnabled()&&aM.getZoom()<aM.config.vectorMapLevel){aN=2}return Math.pow(2,(18-T))*aN},getZoomFactor:function(T){return this.getZoomUnits(T)*this.getTileSize()}});var s={pd:{host:["http://online0.map.bdimg.com/it/","http://online1.map.bdimg.com/it/","http://online2.map.bdimg.com/it/","http://online3.map.bdimg.com/it/"],params:{fm:42,f:"webapp",format_add:".jpg"}},hd:{host:["http://or1.map.baidu.com:8080/it/","http://or2.map.baidu.com:8080/it/","http://or3.map.baidu.com:8080/it/","http://or4.map.baidu.com:8080/it/"],params:{format:"jpeg",fm:41,quality:70,f:"webapp",format_add:".jpg"}}};var ax=new z();ax.getTilesUrl=function(aM,aS){var aT=aM.x,aO=aM.y,aN,aP;var aQ=BMap.TILE_CONFIG||s;if(this.map.highResolutionEnabled()){aN=aQ.hd;if(typeof TVC!="undefined"){aP=TVC.webapp.high_normal}}else{aN=aQ.pd;if(typeof TVC!="undefined"){aP=TVC.webapp.lower_normal}}var aU="u=x="+aT+";y="+aO+";z="+aS;if(aP&&aP.version){aU+=";v="+aP.version}else{aU+=";v=014"}aU+=";type=web";var T=aN.host[Math.abs(aT+aO)%aN.host.length]+aU;if(aP&&aP.updateDate){T+="&udt="+aP.updateDate}for(var aR in aN.params){T+="&"+aR+"="+aN.params[aR]}return T.replace(/-(\d+)/gi,"M$1")};function y(T,aO){this._container=typeof T=="string"?aC.g(T):T;this._opts={linksControl:true,enableDoubleClickZoom:true};aO=aO||{};for(var aM in aO){this._opts[aM]=aO[aM]}this._pov={heading:0,pitch:0};this._links=[];this._id=null;this._position=null;this._zoom=2;this._description="";this._mode="";var aN=this;am.load("streetview",function(){aN._draw()});this._init()}y.MAX_ZOOM=5;y.MIN_ZOOM=0;aC.lang.inherits(y,aC.lang.Class,"StreetView");aC.extend(y.prototype,{_init:function(){},getLinks:function(){return this._links},getId:function(){return this._id},getPosition:function(){return this._position},getPov:function(){return this._pov},getZoom:function(){return this._zoom},getDescription:function(){return this._description},getRelevants:function(){return this._relevants||[]},getMode:function(){return this._mode},setId:function(T){if(T==this._id){return}this._lastId=this._id;this._id=T;this._position=null;this._innerId=null},setInnerId:function(T){if(T==this._innerId){return}this._innerId=T;this._id=null;this._position=null},setPosition:function(T){if(T.equals(this._position)){return}this._lastId=this._id;this._position=T;this._id=null;this._innerId=null},setPov:function(T){this._pov=T;if(this._pov.pitch>45){this._pov.pitch=45}if(this._pov.pitch<-10){this._pov.pitch=-10}},setZoom:function(T){if(T==this._zoom){return}if(T>y.MAX_ZOOM){T=y.MAX_ZOOM}if(T<y.MIN_ZOOM){T=y.MIN_ZOOM}if(T!=this._zoom){this._zoom=T}},enableDoubleClickZoom:function(){this._opts.enableDoubleClickZoom=true},disableDoubleClickZoom:function(){this._opts.enableDoubleClickZoom=false},clear:function(){this._data=null;this._id=null;this._position=null;this._links=[];this.dispatchEvent(new ar("onclear"))}});function j(){z.call(this)}j.URLS=["http://pcsv0.map.bdimg.com/tile/","http://pcsv1.map.bdimg.com/tile/"];j.prototype=new z();j.prototype.getTilesUrl=function(aO,aN){var T=(aO.x+aO.y)%j.URLS.length;var aM="pl";return j.URLS[T]+"?udt=v&qt=tile&styles="+aM+"&x="+aO.x+"&y="+aO.y+"&z="+aN};function D(T,aM){window.BMap[T]=aM}D("Map",w);D("Hotspot",J);D("MapType",aG);D("Point",e);D("Pixel",aH);D("Size",U);D("Bounds",r);D("TileLayer",z);D("MDLayer",E);D("Overlay",L);D("Marker",C);D("Icon",q);D("Polyline",ag);D("Control",M);D("ScaleControl",O);D("StreetView",y);D("StreetViewCoverageLayer",j);})();module.exports=BMap;