define("transit:widget/list/list.js",function(t,e,i){var a=t("common:widget/datescrollpick/datescrollpicker.js"),s=t("common:widget/url/url.js"),o=t("common:widget/popup/popup.js"),n=t("common:widget/stat/stat.js"),r=t("common:widget/geolocation/location.js"),l=t("common:static/js/util.js");i.exports={init:function(t){this.render(t),this.bind(t)},render:function(t){var e=this,i=s.get();e.selectedTool=$("#takesubwayselect"),e.start=$(".start-time .text")[0],e.action=i.action,e.module=i.module,e.pageState=i.pageState,e.query=i.query,e.initDateSelector(t.result),e._initPage(t)},_initPage:function(){var t=this,e=l.ifSupportSubway(r.getCityCode());e||t.selectedTool.attr("disabled","disabled"),"[0,2,4,7,5,8,9,10,11]"==decodeURIComponent(t.query.f)&&($("#takesubwayselect option[value='1']")[0].selected=!0)},bind:function(){var t=this,e=t.start;$(e).text(this.displayDateTimeText),this.pk||(this.pk=new a(e,{onselect:function(e){t._selectStartTime(e.datetime)}})),this.pk.applyTo(e),listener.on("common","sizechange",$.proxy(function(){this.pk&&this.pk.hide()},this)),t.selectedTool.on("change",$.proxy(t._onselectchange,this))},_onselectchange:function(){var t=$("#takesubwayselect").val(),e=this;e.query.f="1"==t?"[0,2,4,7,5,8,9,10,11]":null,1==t&&n.addCookieStat({code:STAT_CODE.BUS_STRATEGY_CLICK,type:4}),s.update({module:e.module,action:e.action,query:e.query,pageState:e.pageState})},initDateSelector:function(t){var e="",i=t.rplt;switch(i){case 1:e="已经为您屏蔽当前停运的方案!";break;case 2:case 3:e="此时没有可用公交方案，已显示全部方案!"}""!=e&&o.open({text:e});var a=new Date;if(t&&t.exptime){var s=t.exptime.split("T"),n=s[0].split("-"),r=s[1].split(":");a.setYear(n[0]),a.setMonth(n[1]-1),a.setDate(n[2]),a.setHours(parseInt(r[0])),a.setMinutes(parseInt(r[1])),a=new Date(a.getTime()+(10-r[1]%10)%10*6e4)}this.startDateTime=a.format("yyyy-MM-dd hh:mm"),this.displayDateTimeText=this.formatDisplayText(this.startDateTime)},formatDisplayText:function(t){var e=new Date,i=e.getMonth()+1,s=t.split(" "),o=s[0].split("-"),n=(s[1].split(":"),a.getMday(i)),r=e.getDate(),l=o[1]+"",c=o[2]+"";if(o[1]=parseInt(0==l.indexOf("0")?l.substring(1):l),o[2]=parseInt(0==c.indexOf("0")?c.substring(1):c),i==o[1]){var p=o[2];return r==p?"今天 "+s[1]+" 出发":p-r==1?"明天 "+s[1]+" 出发":t}return o[1]-i==1&&r==n&&1==o[2]?"明天 "+s[1]+" 出发":t},_selectStartTime:function(t){var e=this;$(e.start).html(e.formatDisplayText(t)),e.query.version="5",e.query.exptype="dep",e.query.exptime=t,s.update({module:e.module,action:e.action,query:e.query,pageState:e.pageState})}}});