(function(){var W,aD=W=aD||{version:"1.3.4"};aD.guid="$BAIDU$";window[aD.guid]=window[aD.guid]||{};aD.object=aD.object||{};aD.extend=aD.object.extend=function(aO,T){for(var aN in T){if(T.hasOwnProperty(aN)){aO[aN]=T[aN]}}return aO};aD.dom=aD.dom||{};aD.dom.g=function(T){if("string"==typeof T||T instanceof String){return document.getElementById(T)}else{if(T&&T.nodeName&&(T.nodeType==1||T.nodeType==9)){return T}}return null};aD.g=aD.G=aD.dom.g;aD.dom.hide=function(T){T=aD.dom.g(T);T.style.display="none";return T};aD.hide=aD.dom.hide;aD.lang=aD.lang||{};aD.lang.isString=function(T){return"[object String]"==Object.prototype.toString.call(T)};aD.isString=aD.lang.isString;aD.dom._g=function(T){if(aD.lang.isString(T)){return document.getElementById(T)}return T};aD._g=aD.dom._g;aD.dom.contains=function(T,aN){var aO=aD.dom._g;T=aO(T);aN=aO(aN);return T.contains?T!=aN&&T.contains(aN):!!(T.compareDocumentPosition(aN)&16)};aD.browser=aD.browser||{};aD.dom._NAME_ATTRS=(function(){var T={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};T.htmlFor="for";T.className="class";return T})();aD.dom.setAttr=function(aN,T,aO){aN=aD.dom.g(aN);if("style"==T){aN.style.cssText=aO}else{T=aD.dom._NAME_ATTRS[T]||T;aN.setAttribute(T,aO)}return aN};aD.setAttr=aD.dom.setAttr;aD.dom.setAttrs=function(aO,T){aO=aD.dom.g(aO);for(var aN in T){aD.dom.setAttr(aO,aN,T[aN])}return aO};aD.setAttrs=aD.dom.setAttrs;aD.string=aD.string||{};aD.dom.removeClass=function(aR,aS){aR=aD.dom.g(aR);var aP=aR.className.split(/\s+/),aT=aS.split(/\s+/),aN,T=aT.length,aO,aQ=0;for(;aQ<T;++aQ){for(aO=0,aN=aP.length;aO<aN;++aO){if(aP[aO]==aT[aQ]){aP.splice(aO,1);break}}}aR.className=aP.join(" ");return aR};aD.removeClass=aD.dom.removeClass;aD.dom.insertHTML=function(aP,T,aO){aP=aD.dom.g(aP);var aN,aQ;if(aP.insertAdjacentHTML){aP.insertAdjacentHTML(T,aO)}else{aN=aP.ownerDocument.createRange();T=T.toUpperCase();if(T=="AFTERBEGIN"||T=="BEFOREEND"){aN.selectNodeContents(aP);aN.collapse(T=="AFTERBEGIN")}else{aQ=T=="BEFOREBEGIN";aN[aQ?"setStartBefore":"setEndAfter"](aP);aN.collapse(aQ)}aN.insertNode(aN.createContextualFragment(aO))}return aP};aD.insertHTML=aD.dom.insertHTML;aD.dom.show=function(T){T=aD.dom.g(T);T.style.display="";return T};aD.show=aD.dom.show;aD.dom.getDocument=function(T){T=aD.dom.g(T);return T.nodeType==9?T:T.ownerDocument||T.document};aD.dom.addClass=function(aR,aS){aR=aD.dom.g(aR);var aN=aS.split(/\s+/),T=aR.className,aQ=" "+T+" ",aP=0,aO=aN.length;for(;aP<aO;aP++){if(aQ.indexOf(" "+aN[aP]+" ")<0){T+=" "+aN[aP]}}aR.className=T;return aR};aD.addClass=aD.dom.addClass;aD.dom._styleFixer=aD.dom._styleFixer||{};aD.dom._styleFilter=aD.dom._styleFilter||[];aD.dom._styleFilter.filter=function(aN,aQ,aR){for(var T=0,aP=aD.dom._styleFilter,aO;aO=aP[T];T++){if(aO=aO[aR]){aQ=aO(aN,aQ)}}return aQ};aD.string.toCamelCase=function(T){if(T.indexOf("-")<0&&T.indexOf("_")<0){return T}return T.replace(/[-_][^-_]/g,function(aN){return aN.charAt(1).toUpperCase()})};aD.dom.getStyle=function(aO,aN){var aR=aD.dom;aO=aR.g(aO);aN=aD.string.toCamelCase(aN);var aQ=aO.style[aN];if(!aQ){var T=aR._styleFixer[aN],aP=aO.currentStyle||getComputedStyle(aO,null);aQ=T&&T.get?T.get(aO,aP):aP[T||aN]}if(T=aR._styleFilter){aQ=T.filter(aN,aQ,"get")}return aQ};aD.getStyle=aD.dom.getStyle;if(/opera\/(\d+\.\d)/i.test(navigator.userAgent)){aD.browser.opera=+RegExp["\x241"]}aD.browser.isWebkit=/webkit/i.test(navigator.userAgent);aD.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);aD.browser.isStrict=document.compatMode=="CSS1Compat";aD.dom.getPosition=function(T){T=aD.dom.g(T);var aV=aD.dom.getDocument(T),aP=aD.browser,aS=aD.dom.getStyle,aO=aP.isGecko>0&&aV.getBoxObjectFor&&aS(T,"position")=="absolute"&&(T.style.top===""||T.style.left===""),aT={left:0,top:0},aR=(aP.ie&&!aP.isStrict)?aV.body:aV.documentElement,aW,aN;if(T==aR){return aT}if(T.getBoundingClientRect){aN=T.getBoundingClientRect();aT.left=Math.floor(aN.left)+Math.max(aV.documentElement.scrollLeft,aV.body.scrollLeft);aT.top=Math.floor(aN.top)+Math.max(aV.documentElement.scrollTop,aV.body.scrollTop);aT.left-=aV.documentElement.clientLeft;aT.top-=aV.documentElement.clientTop;var aU=aV.body,aX=parseInt(aS(aU,"borderLeftWidth")),aQ=parseInt(aS(aU,"borderTopWidth"));if(aP.ie&&!aP.isStrict){aT.left-=isNaN(aX)?2:aX;aT.top-=isNaN(aQ)?2:aQ}}else{aW=T;do{aT.left+=aW.offsetLeft;aT.top+=aW.offsetTop;if(aP.isWebkit>0&&aS(aW,"position")=="fixed"){aT.left+=aV.body.scrollLeft;aT.top+=aV.body.scrollTop;break}aW=aW.offsetParent}while(aW&&aW!=T);if(aP.opera>0||(aP.isWebkit>0&&aS(T,"position")=="absolute")){aT.top-=aV.body.offsetTop}aW=T.offsetParent;while(aW&&aW!=aV.body){aT.left-=aW.scrollLeft;if(!aP.opera||aW.tagName!="TR"){aT.top-=aW.scrollTop}aW=aW.offsetParent}}return aT};if(/firefox\/(\d+\.\d)/i.test(navigator.userAgent)){aD.browser.firefox=+RegExp["\x241"]}(function(){var T=navigator.userAgent;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(T)&&!/chrome/i.test(T)){aD.browser.safari=+(RegExp["\x241"]||RegExp["\x242"])}})();if(/chrome\/(\d+\.\d)/i.test(navigator.userAgent)){aD.browser.chrome=+RegExp["\x241"]}aD.array=aD.array||{};aD.array.each=function(aR,aP){var aO,aQ,aN,T=aR.length;if("function"==typeof aP){for(aN=0;aN<T;aN++){aQ=aR[aN];aO=aP.call(aR,aQ,aN);if(aO===false){break}}}return aR};aD.each=aD.array.each;aD.lang.guid=function(){return"TANGRAM__"+(window[aD.guid]._counter++).toString(36)};window[aD.guid]._counter=window[aD.guid]._counter||1;window[aD.guid]._instances=window[aD.guid]._instances||{};aD.lang.isFunction=function(T){return"[object Function]"==Object.prototype.toString.call(T)};aD.lang.Class=function(T){this.guid=T||aD.lang.guid();window[aD.guid]._instances[this.guid]=this};window[aD.guid]._instances=window[aD.guid]._instances||{};aD.lang.Class.prototype.dispose=function(){delete window[aD.guid]._instances[this.guid];for(var T in this){if(!aD.lang.isFunction(this[T])){delete this[T]}}this.disposed=true};aD.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};aD.lang.Event=function(T,aN){this.type=T;this.returnValue=true;this.target=aN||null;this.currentTarget=null};aD.lang.Class.prototype.addEventListener=function(aP,aO,aN){if(!aD.lang.isFunction(aO)){return}!this.__listeners&&(this.__listeners={});var T=this.__listeners,aQ;if(typeof aN=="string"&&aN){if(/[^\w\-]/.test(aN)){throw ("nonstandard key:"+aN)}else{aO.hashCode=aN;aQ=aN}}aP.indexOf("on")!=0&&(aP="on"+aP);typeof T[aP]!="object"&&(T[aP]={});aQ=aQ||aD.lang.guid();aO.hashCode=aQ;T[aP][aQ]=aO};aD.lang.Class.prototype.removeEventListener=function(aO,aN){if(aD.lang.isFunction(aN)){aN=aN.hashCode}else{if(!aD.lang.isString(aN)){return}}!this.__listeners&&(this.__listeners={});aO.indexOf("on")!=0&&(aO="on"+aO);var T=this.__listeners;if(!T[aO]){return}T[aO][aN]&&delete T[aO][aN]};aD.lang.Class.prototype.dispatchEvent=function(aP,T){if(aD.lang.isString(aP)){aP=new aD.lang.Event(aP)}!this.__listeners&&(this.__listeners={});T=T||{};for(var aO in T){aP[aO]=T[aO]}var aO,aN=this.__listeners,aQ=aP.type;aP.target=aP.target||this;aP.currentTarget=this;aQ.indexOf("on")!=0&&(aQ="on"+aQ);aD.lang.isFunction(this[aQ])&&this[aQ].apply(this,arguments);if(typeof aN[aQ]=="object"){for(aO in aN[aQ]){aN[aQ][aO].apply(this,arguments)}}return aP.returnValue};aD.lang.inherits=function(aS,aQ,aP){var aO,aR,T=aS.prototype,aN=new Function();aN.prototype=aQ.prototype;aR=aS.prototype=new aN();for(aO in T){aR[aO]=T[aO]}aS.prototype.constructor=aS;aS.superClass=aQ.prototype;if("string"==typeof aP){aR._className=aP}};aD.inherits=aD.lang.inherits;aD.lang.instance=function(T){return window[aD.guid]._instances[T]||null};aD.platform=aD.platform||{};aD.platform.isAndroid=/android/i.test(navigator.userAgent);if(/android (\d+\.\d)/i.test(navigator.userAgent)){aD.platform.android=aD.android=RegExp["\x241"]}aD.platform.isIpad=/ipad/i.test(navigator.userAgent);aD.platform.isIphone=/iphone/i.test(navigator.userAgent);aD.platform.iosVersion=/iphone os (\d)\_/i.test(navigator.userAgent)?+RegExp["\x241"]:0;aD.lang.Event.prototype.inherit=function(aO){var aN=this;this.domEvent=aO=window.event||aO;aN.clientX=aO.clientX||aO.pageX;aN.clientY=aO.clientY||aO.pageY;aN.offsetX=aO.offsetX||aO.layerX;aN.offsetY=aO.offsetY||aO.layerY;aN.screenX=aO.screenX;aN.screenY=aO.screenY;aN.ctrlKey=aO.ctrlKey||aO.metaKey;aN.shiftKey=aO.shiftKey;aN.altKey=aO.altKey;if(aO.touches){aN.touches=[];for(var T=0;T<aO.touches.length;T++){aN.touches.push({clientX:aO.touches[T].clientX,clientY:aO.touches[T].clientY,screenX:aO.touches[T].screenX,screenY:aO.touches[T].screenY,pageX:aO.touches[T].pageX,pageY:aO.touches[T].pageY,target:aO.touches[T].target,identifier:aO.touches[T].identifier})}}if(aO.changedTouches){aN.changedTouches=[];for(var T=0;T<aO.changedTouches.length;T++){aN.changedTouches.push({clientX:aO.changedTouches[T].clientX,clientY:aO.changedTouches[T].clientY,screenX:aO.changedTouches[T].screenX,screenY:aO.changedTouches[T].screenY,pageX:aO.changedTouches[T].pageX,pageY:aO.changedTouches[T].pageY,target:aO.changedTouches[T].target,identifier:aO.changedTouches[T].identifier})}}if(aO.targetTouches){aN.targetTouches=[];for(var T=0;T<aO.targetTouches.length;T++){aN.targetTouches.push({clientX:aO.targetTouches[T].clientX,clientY:aO.targetTouches[T].clientY,screenX:aO.targetTouches[T].screenX,screenY:aO.targetTouches[T].screenY,pageX:aO.targetTouches[T].pageX,pageY:aO.targetTouches[T].pageY,target:aO.targetTouches[T].target,identifier:aO.targetTouches[T].identifier})}}aN.rotation=aO.rotation;aN.scale=aO.scale;return aN};aD.lang.decontrol=function(aN){var T=window[aD.guid];T._instances&&(delete T._instances[aN])};aD.event={};aD.on=aD.event.on=function(aO,aN,T){if(!(aO=aD.g(aO))){return aO}aN=aN.replace(/^on/,"");if(aO.addEventListener){aO.addEventListener(aN,T,false)}else{if(aO.attachEvent){aO.attachEvent("on"+aN,T)}}return aO};aD.un=aD.event.un=function(aO,aN,T){if(!(aO=aD.g(aO))){return aO}aN=aN.replace(/^on/,"");if(aO.removeEventListener){aO.removeEventListener(aN,T,false)}else{if(aO.detachEvent){aO.detachEvent("on"+aN,T)}}return aO};aD.dom.hasClass=function(aO,aN){if(!aO||!aO.className||typeof aO.className!="string"){return false}var T=-1;try{T=aO.className==aN||aO.className.indexOf(aN)}catch(aP){return false}return T>-1};window.BMap=window.BMap||{};window.BMap._register=[];window.BMap.register=function(T){this._register.push(T)};BMap._streetViewRegister=[];BMap.streetViewRegister=function(T){this._streetViewRegister.push(T)};function x(aR,T){aR=aD.g(aR);if(!aR){return}var aU=this;aD.lang.Class.call(aU);aU.config={clickInterval:200,enableDragging:true,enableDblclickZoom:true,enableMouseDown:true,enablePinchToZoom:true,enableAutoResize:true,fps:25,actionDuration:450,minZoom:1,maxZoom:18,mapType:new aH("\u5730\u56fe",ay,{tips:"\u663e\u793a\u666e\u901a\u5730\u56fe",mapInstance:this}),enableInertialDragging:false,drawMargin:100,enableHighResolution:false,devicePixelRatio:window.devicePixelRatio||2,vectorMapLevel:12,beautifyBlackList:["chrome"],trafficStatus:false};aD.extend(aU.config,T||{});var aT=aU.config.beautifyBlackList;for(var aS=0,aQ=aT.length;aS<aQ;aS++){if(aD.browser[aT[aS]]){aU.config.devicePixelRatio=1;break}}aU.container=aR;aU._setStyle(aR);aR.unselectable="on";aR.innerHTML="";aR.appendChild(aU.render());var aN=aU.getSize();aU.width=aN.width;aU.height=aN.height;aU.offsetX=0;aU.offsetY=0;aU.platform=aR.firstChild;aU.maskLayer=aU.platform.firstChild;aU.maskLayer.style.width=aU.width+"px";aU.maskLayer.style.height=aU.height+"px";aU._panes={};aU.centerPoint=new e(0,0);aU.mercatorCenter=new e(0,0);aU.zoomLevel=1;aU.lastLevel=0;aU.defaultZoomLevel=null;aU.defaultCenter=null;aU._hotspots={};aU.currentOperation=0;T=T||{};var aP=aU.mapType=aU.config.mapType;aU.projection=aP.getProjection();var aO=aU.config;aO.userMinZoom=T.minZoom;aO.userMaxZoom=T.maxZoom;aU._checkZoom();aU.temp={operating:false,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:false,registerIndex:-1,curSpots:[]};for(var aS=0;aS<BMap._register.length;aS++){BMap._register[aS](aU)}aU.temp.registerIndex=aS;aU._bind();an.load("map",function(){aU._draw()});an.load("opmb",function(){aU._asyncRegister()});aR=null;aU.enableLoadTiles=true;aU._viewTiles=[]}aD.lang.inherits(x,aD.lang.Class,"Map");aD.extend(x.prototype,{render:function(){var T=p("div");var aP=T.style;aP.overflow="visible";aP.position="absolute";aP.zIndex="0";aP.top=aP.left="0px";var aN=p("div",{"class":"BMap_mask"});var aO=aN.style;aO.position="absolute";aO.top=aO.left="0px";aO.zIndex="9";aO.overflow="hidden";aO.WebkitUserSelect="none";T.appendChild(aN);return T},_setStyle:function(aN){var T=aN.style;T.overflow="hidden";if(al(aN).position!="absolute"){T.position="relative";T.zIndex=0}T.backgroundColor="#F5F3F0";T.color="#000";T.textAlign="left"},_bind:function(){var T=this;T._watchSize=function(){var aN=T.getSize();if(T.width!=aN.width||T.height!=aN.height){var aP=new U(T.width,T.height);var aQ=new at("onbeforeresize");aQ.size=aP;T.dispatchEvent(aQ);T._updateCenterPoint((aN.width-T.width)/2,(aN.height-T.height)/2);T.maskLayer.style.width=(T.width=aN.width)+"px";T.maskLayer.style.height=(T.height=aN.height)+"px";var aO=new at("onresize");aO.size=aN;T.dispatchEvent(aO)}};if(T.config.enableAutoResize){T.temp.autoResizeTimer=setInterval(T._watchSize,80)}},_updateCenterPoint:function(aR,aS,aQ,aP){var aO=this.getMapType().getZoomUnits(this.getZoom());var aN=true;if(aQ){this.centerPoint=new e(aQ.lng,aQ.lat);aN=false}var T=(aQ&&aP)?aQ:this.mercatorCenter;if(T){this.mercatorCenter=new e(T.lng+aR*aO,T.lat-aS*aO);if(this.mercatorCenter&&aN){this.centerPoint=this.mercatorCenter}}},zoomTo:function(aP,aN){if(!I(aP)){return}aP=this._getProperZoom(aP).zoom;if(aP==this.zoomLevel){return}this.lastLevel=this.zoomLevel;this.zoomLevel=aP;var aO;if(aN){aO=aN}if(aO){var T=this.pointToPixel(aO,this.lastLevel);this._updateCenterPoint(this.width/2-T.x,this.height/2-T.y,this.pixelToPoint(T,this.lastLevel),true)}this.dispatchEvent(new at("onzoomstart"));this.dispatchEvent(new at("onzoomstartcode"))},setZoom:function(T){this.zoomTo(T)},zoomIn:function(T){if(this.zoomLevel>=this.config.vectorMapLevel&&this.zoomLevel<=18){BMap.logCountError.countTouch(0,1)}this.zoomTo(this.zoomLevel+1,T)},zoomOut:function(T){if(this.zoomLevel>=this.config.vectorMapLevel&&this.zoomLevel<=18){BMap.logCountError.countTouch(0,1)}this.zoomTo(this.zoomLevel-1,T)},panTo:function(T,aN){if(!(T instanceof e)){return}this.mercatorCenter=T;if(T){this.centerPoint=new e(T.lng,T.lat)}else{this.centerPoint=this.mercatorCenter}},panBy:function(aN,T){aN=Math.round(aN)||0;T=Math.round(T)||0;this._updateCenterPoint(-aN,-T)},addControl:function(T){if(T&&ar(T._i)){T._i(this);this.dispatchEvent(new at("onaddcontrol",T))}},removeControl:function(T){if(T&&ar(T.remove)){T.remove();this.dispatchEvent(new at("onremovecontrol",T))}},addOverlay:function(T){if(T&&ar(T._i)){T._i(this);this.dispatchEvent(new at("onaddoverlay",T))}},removeOverlay:function(T){if(T&&ar(T.remove)){T.remove();this.dispatchEvent(new at("onremoveoverlay",T))}},clearOverlays:function(){this.dispatchEvent(new at("onclearoverlays"))},addTileLayer:function(T){if(T){this.dispatchEvent(new at("onaddtilelayer",T))}},removeTileLayer:function(T){if(T){this.dispatchEvent(new at("onremovetilelayer",T))}},setCenter:function(T){var aN=this;if(T instanceof e){aN.panTo(T,{noAnimation:true})}},centerAndZoom:function(T,aO,aQ){var aN=this;if(!(T instanceof e)||!aO){return}aO=aN._getProperZoom(aO).zoom;aN.lastLevel=aN.zoomLevel||aO;aN.zoomLevel=aO;aN.centerPoint=new e(T.lng,T.lat);aN.mercatorCenter=aN.centerPoint;aN.defaultZoomLevel=aN.defaultZoomLevel||aN.zoomLevel;aN.defaultCenter=aN.defaultCenter||aN.centerPoint;var aR=new at("onload");var aP=new at("onloadcode");aR.point=new e(T.lng,T.lat);aR.pixel=aN.pointToPixel(aN.centerPoint,aN.zoomLevel);aR.zoom=aO;if(!aN.loaded){aN.loaded=true;aN.dispatchEvent(aR)}aN.dispatchEvent(aP);if(aQ){aN.dispatchEvent(new at("onmoveend"))}else{aN.dispatchEvent(new at("onmoveend"));if(aN.lastLevel!=aN.zoomLevel){aN.dispatchEvent(new at("onzoomend"))}}},reset:function(){this.centerAndZoom(this.defaultCenter,this.defaultZoomLevel,true)},enableDragging:function(){this.config.enableDragging=true},disableDragging:function(){this.config.enableDragging=false},enableInertialDragging:function(){this.config.enableInertialDragging=true},disableInertialDragging:function(){this.config.enableInertialDragging=false},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=true},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=false},enablePinchToZoom:function(){this.config.enablePinchToZoom=true},disablePinchToZoom:function(){this.config.enablePinchToZoom=false},enableAutoResize:function(){this.config.enableAutoResize=true;this._watchSize();if(!this.temp.autoResizeTimer){this.temp.autoResizeTimer=setInterval(this._watchSize,80)}},disableAutoResize:function(){this.config.enableAutoResize=false;if(this.temp.autoResizeTimer){clearInterval(this.temp.autoResizeTimer);this.temp.autoResizeTimer=null}},getSize:function(){return new U(this.container.clientWidth,this.container.clientHeight)},getCenter:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},checkResize:function(){this._watchSize()},_getProperZoom:function(aO){var aN=this.config.minZoom,T=this.config.maxZoom,aP=false;if(aO<aN){aP=true;aO=aN}if(aO>T){aP=true;aO=T}return{zoom:aO,exceeded:aP}},getContainer:function(){return this.container},pointToPixel:function(T,aN){aN=aN||this.getZoom();return this.projection.pointToPixel(T,aN,this.mercatorCenter,this.getSize())},pixelToPoint:function(T,aN){aN=aN||this.getZoom();return this.projection.pixelToPoint(T,aN,this.mercatorCenter,this.getSize())},pointToOverlayPixel:function(T,aO){if(!T){return}var aP=new e(T.lng,T.lat);var aN=this.pointToPixel(aP,aO);aN.x-=this.offsetX;aN.y-=this.offsetY;return aN},overlayPixelToPoint:function(T,aO){if(!T){return}var aN=new aI(T.x,T.y);aN.x+=this.offsetX;aN.y+=this.offsetY;return this.pixelToPoint(aN,aO)},getBounds:function(){if(!this.isLoaded()){return new s()}var aQ=this.getSize();this.width=aQ.width;this.height=aQ.height;var aN=arguments[0]||{},aP=aN.margins||[0,0,0,0],T=aN.zoom||null,aR=this.pixelToPoint({x:aP[3],y:this.height-aP[2]},T),aO=this.pixelToPoint({x:this.width-aP[1],y:aP[0]},T);return new s(aR,aO)},isLoaded:function(){return !!this.loaded},_getBestLevel:function(aN,aO){var aR=this.getMapType();var aT=aO.margins||[10,10,10,10],aQ=aO.zoomFactor||0,aU=aT[1]+aT[3],aS=aT[0]+aT[2],T=aR.getMinZoom(),aW=aR.getMaxZoom();for(var aP=aW;aP>=T;aP--){var aV=this.getMapType().getZoomUnits(aP);if(aN.toSpan().lng/aV<this.width-aU&&aN.toSpan().lat/aV<this.height-aS){break}}aP+=aQ;if(aP<T){aP=T}if(aP>aW){aP=aW}return aP},getViewport:function(aV,aN){var aZ={center:this.getCenter(),zoom:this.getZoom()};if(!aV||!aV instanceof s&&aV.length==0||aV instanceof s&&aV.isEmpty()){return aZ}var aX=[];if(aV instanceof s){aX.push(aV.getNorthEast());aX.push(aV.getSouthWest())}else{aX=aV.slice(0)}aN=aN||{};var aR=[];for(var aS=0,aQ=aX.length;aS<aQ;aS++){aR.push(aX[aS])}var aO=new s();for(var aS=aR.length-1;aS>=0;aS--){aO.extend(aR[aS])}if(aO.isEmpty()){return aZ}var T=aO.getCenter();var aY=this._getBestLevel(aO,aN);if(aN.margins){var aU=aN.margins,aT=(aU[1]-aU[3])/2,aW=(aU[0]-aU[2])/2,aP=this.getMapType().getZoomUnits(aY);T.lng=T.lng+aP*aT;T.lat=T.lat+aP*aW}return{center:T,zoom:aY}},setViewport:function(aN,aQ){var T;if(aN&&aN.center){T=aN}else{T=this.getViewport(aN,aQ)}aQ=aQ||{};var aO=aQ.delay||200;if(T.zoom==this.zoomLevel&&aQ.enableAnimation!=false){var aP=this;setTimeout(function(){aP.panTo(T.center,{duration:210})},aO)}else{this.centerAndZoom(T.center,T.zoom)}},getPanes:function(){return this._panes},getOverlays:function(){var aP=[],aQ=this._overlays,aO=this._customOverlays;if(aQ){for(var aN in aQ){if(aQ[aN] instanceof aA){aP.push(aQ[aN])}}}if(aO){for(var aN=0,T=aO.length;aN<T;aN++){aP.push(aO[aN])}}return aP},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var T=this.temp.registerIndex;T<BMap._register.length;T++){BMap._register[T](this)}this.temp.registerIndex=T},highResolutionEnabled:function(){return this.config.enableHighResolution&&window.devicePixelRatio>1},enableHighResolution:function(){this.config.enableHighResolution=true},disableHighResolution:function(){this.config.enableHighResolution=false},addHotspot:function(aN){if(aN instanceof J){this._hotspots[aN.guid]=aN;aN.initialize(this)}var T=this;an.load("hotspot",function(){T._asyncRegister()})},removeHotspot:function(T){if(this._hotspots[T.guid]){delete this._hotspots[T.guid]}},clearHotspots:function(){this._hotspots={}},_checkZoom:function(){var aN=this.mapType.getMinZoom();var aO=this.mapType.getMaxZoom();var T=this.config;T.minZoom=T.userMinZoom||aN;T.maxZoom=T.userMaxZoom||aO;if(T.minZoom<aN){T.minZoom=aN}if(T.maxZoom>aO){T.maxZoom=aO}},setMinZoom:function(T){if(T>this.config.maxZoom){T=this.config.maxZoom}this.config.userMinZoom=T;this._updateZoom()},setMaxZoom:function(T){if(T<this.config.minZoom){T=this.config.minZoom}this.config.userMaxZoom=T;this._updateZoom()},_updateZoom:function(){this._checkZoom();var T=this.config;if(this.zoomLevel<T.minZoom){this.setZoom(T.minZoom)}else{if(this.zoomLevel>T.maxZoom){this.setZoom(T.maxZoom)}}var aN=new at("onzoomspanchange");aN.minZoom=T.minZoom;aN.maxZoom=T.maxZoom;this.dispatchEvent(aN)},getViewTiles:function(){return this._viewTiles},vectorMapEnabled:function(){return this.config.vectorMapLevel!=99},setTrafficOn:function(){this.config.trafficStatus=true;var T=new at("ontrafficchange");this.dispatchEvent(T)},setTrafficOff:function(){this.config.trafficStatus=false;var T=new at("ontrafficchange");this.dispatchEvent(T)}});window.BMAP_CANVAS_DRAWER=3;(function(){window.asyncMdlVer={control:"arzmyk",hotspot:"j3s0sn",map:"1yoqaj",marker:"yykkb5",opmb:"niptkl",poly:"5o4xjf",tile:"prwkzv",vector:"szzsgy",streetview:"znbc5m",layer:"lxkvvv"};window.chkVersion=function(T){try{var aN=window.localStorage;if(!aN){return false}return aN[T]&&aN[T].length>0}catch(aO){return false}};window.saveVersion=function(T,aS,aQ){try{var aO=window.localStorage;if(aO){for(var aN=aO.length,aP=aN-1;aP>=0;aP--){var aT=aO.key(aP);if(aT.indexOf(aQ)>-1){aO.removeItem(aT)}}aO.setItem(T,aS)}}catch(aR){}};window.getVersion=function(T){try{var aN=window.localStorage;if(!aN){return""}return aN.getItem(T)}catch(aO){return""}}})();function aE(aP){var T={duration:1000,fps:30,delay:0,transition:f.linear,onStop:function(){}};this._anis=[];if(aP){for(var aN in aP){T[aN]=aP[aN]}}this._opts=T;if(I(T.delay)){var aO=this;setTimeout(function(){aO.start()},T.delay)}else{if(T.delay!=aE.INFINITE){this.start()}}}aE.INFINITE="INFINITE";aE.prototype.start=function(){this._beginTime=w();this._endTime=this._beginTime+this._opts.duration;this._launch()};aE.prototype.add=function(T){this._anis.push(T)};aE.prototype._launch=function(){var aO=this;var T=w();if(T>=aO._endTime){if(ar(aO._opts.render)){aO._opts.render(aO._opts.transition(1))}if(ar(aO._opts.finish)){aO._opts.finish()}if(aO._anis.length>0){var aN=aO._anis[0];aN._anis=[].concat(aO._anis.slice(1));aN.start()}return}aO.schedule=aO._opts.transition((T-aO._beginTime)/aO._opts.duration);if(ar(aO._opts.render)){aO._opts.render(aO.schedule)}if(!aO.terminative){aO._timer=setTimeout(function(){aO._launch()},1000/aO._opts.fps)}};aE.prototype.stop=function(aN){this.terminative=true;for(var T=0;T<this._anis.length;T++){this._anis[T].stop();this._anis[T]=null}this._anis.length=0;if(this._timer){clearTimeout(this._timer);this._timer=null}this._opts.onStop(this.schedule);if(aN){this._endTime=this._beginTime;this._launch()}};aE.prototype.cancel=function(){if(this._timer){clearTimeout(this._timer)}this._endTime=this._beginTime;this.schedule=0};aE.prototype.setFinishCallback=function(T){if(this._anis.length>0){this._anis[this._anis.length-1]._opts.finish=T}else{this._opts.finish=T}};var f={linear:function(T){return T},reverse:function(T){return 1-T},easeInQuad:function(T){return T*T},easeInCubic:function(T){return Math.pow(T,3)},easeOutQuad:function(T){return -(T*(T-2))},easeOutCubic:function(T){return Math.pow((T-1),3)+1},easeInOutQuad:function(T){if(T<0.5){return T*T*2}else{return -2*(T-2)*T-1}return},easeInOutCubic:function(T){if(T<0.5){return Math.pow(T,3)*4}else{return Math.pow(T-1,3)*4+1}},easeInOutSine:function(T){return(1-Math.cos(Math.PI*T))/2}};f["ease-in"]=f.easeInQuad;f["ease-out"]=f.easeOutQuad;var aL={imgPath:"http://map.baidu.com/res_mobile2/images/"};function aM(aO,T){var aN=aO.style;aN.left=T[0]+"px";aN.top=T[1]+"px"}function l(T){T.style.MozUserSelect="none"}function n(T){return T&&T.parentNode&&T.parentNode.nodeType!=11}function V(aN,T){aD.dom.insertHTML(aN,"beforeEnd",T);return aN.lastChild}function u(T){var aN={left:0,top:0};while(T&&T.offsetParent){aN.left+=T.offsetLeft;aN.top+=T.offsetTop;T=T.offsetParent}return aN}function ac(T){var T=window.event||T;T.stopPropagation?T.stopPropagation():T.cancelBubble=true}function y(T){var T=window.event||T;T.preventDefault?T.preventDefault():T.returnValue=false;return false}function aw(T){ac(T);return y(T)}function H(){var T=document.documentElement,aN=document.body;if(T&&(T.scrollTop||T.scrollLeft)){return[T.scrollTop,T.scrollLeft]}else{if(aN){return[aN.scrollTop,aN.scrollLeft]}else{return[0,0]}}}function q(aN,T){if(!aN||!T){return}return Math.round(Math.sqrt(Math.pow(aN.x-T.x,2)+Math.pow(aN.y-T.y,2)))}function p(aN,T,aO){var aP=document.createElement(aN);if(aO){aP=document.createElementNS(aO,aN)}return aD.dom.setAttrs(aP,T||{})}function al(T){if(T.currentStyle){return T.currentStyle}else{if(T.ownerDocument&&T.ownerDocument.defaultView){return T.ownerDocument.defaultView.getComputedStyle(T,null)}}}function ar(T){return typeof T=="function"}function I(T){return typeof T=="number"}function aC(T){return typeof T=="string"}function ad(T){return typeof T!="undefined"}function C(T){return typeof T=="object"}function c(T){return"[object Array]"==Object.prototype.toString.call(T)}function h(){if(typeof h.result!="boolean"){h.result=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return h.result}function am(T){return T*Math.PI/180}var at=aD.lang.Event;function ap(){return !!(aD.platform.isIphone||aD.platform.isIpad||aD.platform.isAndroid)}function w(){return(new Date).getTime()}BMap.logCountError=(function(){var bb=true,aV=true,bf=true,a1=true,aY=new Image(),bd=0,a6=0,a8=0,aW=0,aS=0,bj=0,a7=0,aT=0,aQ=0,bc=0,a5=0,aO=0,aP=0,a3=0,ba=0,aX=0,bi=0,aN=0,bh=0,T=0,be=0,a4=0,aU=0,bg=0;function a9(){if(window.speedTest&&window.speedTest.ab){bi=window.speedTest.ab}a9=function(){return bi};return bi}function a2(bl,bm,bo,bn){var bk=(12<=bn&&bn<=18);if(bm){if(bl){a6+=1;if(bk){aT+=1}}else{bd+=1;if(bk){a7+=1}}if(bo==1){if(bl){bj+=1;if(bk){aO+=1}}else{aS+=1;if(bk){a5+=1}}}}else{if(bl){aW+=1;if(bk){bc+=1}}else{a8+=1;if(bk){aQ+=1}}}if(bb){bb=false;setTimeout(function(){var bp=(Math.random()*100000000).toFixed(0);bb=true;aY.src="http://map.baidu.com/mobile/img/transparent.gif?type=pic&newmap=1&t="+bp+"&code=20066&pic_pl_error="+bd+"&pic_ph_error="+a6+"&pic_pl_all="+a8+"&pic_ph_all="+aW+"&pic_pl_s="+aS+"&pic_ph_s="+bj+"&pic_pl_error_1="+a7+"&pic_ph_error_1="+aT+"&pic_pl_all_1="+aQ+"&pic_ph_all_1="+bc+"&pic_pl_s_1="+a5+"&pic_ph_s_1="+bj+"&ab="+a9();bd=0;a6=0;a8=0;aW=0;aS=0;bj=0;a7=0;aT=0;aQ=0;bc=0;a5=0;aO=0},10000)}}function aZ(bk){if(bk){a3+=1}else{aX+=1}if(aV){aV=false;setTimeout(function(){var bl=(Math.random()*100000000).toFixed(0);aV=true;aY.src="http://map.baidu.com/mobile/img/transparent.gif?type=vec&newmap=1&t="+bl+"&code=20066&vec_pl_error="+aP+"&vec_ph_error="+a3+"&vec_pl_all="+ba+"&vec_ph_all="+aX+"&ab="+a9();aP=0;a3=0;ba=0;aX=0},10000)}}function a0(bk,bl){var bm=a9();if(bm==1){aN+=bk;bh+=bl}if(bm==2){T+=bk;be+=bl}if(bf){bf=false;setTimeout(function(){var bn=(Math.random()*100000000).toFixed(0);bf=true;aY.src="http://map.baidu.com/mobile/img/transparent.gif?res=webapp&counttype=touch&newmap=1&t="+bn+"&move1="+aN+"&zoom1="+bh+"&move2="+T+"&zoom2="+be;aN=0;bh=0;T=0;be=0},10000)}}function aR(bk,bl){if(bk){a4+=1;if(bl==1){bg+=1}}else{aU+=1}if(a1){a1=false;setTimeout(function(){var bm=(Math.random()*100000000).toFixed(0);a1=true;aY.src="http://map.baidu.com/mobile/img/transparent.gif?type=stpic&t="+bm+"&code=20066&st_pic_error="+a4+"&st_pic_all="+aU+"&st_pic_s="+bg;a4=0;aU=0;bg=0},10000)}}return{countPic:a2,countVec:aZ,countTouch:a0,countStPic:aR}})();function Z(aN,T){if(aN.data("events")&&aN.data("events")[T]){return true}else{return false}}var aG={request:function(aO,T){var aN=p("script",{src:aO,type:"text/javascript",charset:"utf-8"});if(T){BMap.logCountError.countVec(false);aN.onerror=function(){BMap.logCountError.countVec(true)}}aN.addEventListener("load",function(aQ){var aP=aQ.target;aP.parentNode.removeChild(aP)},false);document.getElementsByTagName("head")[0].appendChild(aN);aN=null}};window.sendReqNo=0;function an(){}aD.object.extend(an,{Request:{INITIAL:-1,WAITING:0,COMPLETED:1},getDependency:function(){return{vector:["tile"],poly:["marker"],layer:["vector"]}},Config:{_baseUrl:"/mobile/?qt=getMobileModules&v=2&"},delayFlag:false,ModuleTree:{_modules:{},_arrMdls:[]},load:function(aN,aP){var T=this.getModule(aN);if(T._status==this.Request.COMPLETED){return}else{if(T._status==this.Request.INITIAL){this.combine(aN);this.pushUniqueMdl(aN);var aO=this;if(aO.delayFlag==false){aO.delayFlag=true;window.setTimeout(function(){var aW=aO.ModuleTree._arrMdls.slice(0);var aY=[];for(var aS=0,aR=aW.length;aS<aR;aS++){var aX=aW[aS],aQ=window.asyncMdlVer[aX],aU="async_"+aX+"_"+aQ;if(!window.chkVersion(aU)){aW[aW[aS]]="";aY.push(aX+"_"+aQ)}else{aW[aW[aS]]=window.getVersion(aU)}}if(aY.length==0){for(var aS=0,aR=aW.length;aS<aR;aS++){var aZ=aW[aS],aU="async_"+aZ+"_"+window.asyncMdlVer[aZ],aV=window.getVersion(aU);an.run(aZ,aV)}}else{var aT=aO.Config._baseUrl+"mod="+aY.join(",")+"&sendReqNo="+window.sendReqNo+"&cbk=_jsload";aG.request(aT);window["sendReqNo"+window.sendReqNo]=aW;window.sendReqNo++}aO.delayFlag=false;aO.ModuleTree._arrMdls.length=0},1)}T._status=this.Request.WAITING}T._callbacks.push(aP)}},combine:function(T){var aO=this.getDependency();if(T&&aO[T]){var aO=aO[T];for(var aN=0;aN<aO.length;aN++){this.combine(aO[aN]);if(!this.ModuleTree._modules[aO[aN]]){this.pushUniqueMdl(aO[aN])}}}},pushUniqueMdl:function(aP){var T=this.ModuleTree._arrMdls;for(var aO=0,aN=T.length;aO<aN;aO++){if(T[aO]==aP){return}}T.push(aP)},getModule:function(aN){var T;if(!this.ModuleTree._modules[aN]){this.ModuleTree._modules[aN]={};this.ModuleTree._modules[aN]._status=this.Request.INITIAL;this.ModuleTree._modules[aN]._callbacks=[]}T=this.ModuleTree._modules[aN];return T},run:function(aP,aS){var aN="async_"+aP+"_"+window.asyncMdlVer[aP],aR="async_"+aP;if(!window.chkVersion(aN)){window.saveVersion(aN,aS,aR)}var aO=this.getModule(aP);try{eval(aS)}catch(aT){return}aO._status=this.Request.COMPLETED;for(var aQ=0,T=aO._callbacks.length;aQ<T;aQ++){aO._callbacks[aQ]()}aO._callbacks.length=0}});window._jsload=function(aR,aT,aS){var T=window["sendReqNo"+aS],aO=aR.split("_")[0];T[aO]=aT;var aQ=true;for(var aP=0,aN=T.length;aP<aN;aP++){if(T[T[aP]].length<=0){aQ=false;break}}if(aQ){for(var aP=0,aN=T.length;aP<aN;aP++){var aR=T[aP],aT=T[aR];an.run(aR,aT)}T.length=0;delete window["sendReqNo"+aS]}};function aI(T,aN){this.x=T||0;this.y=aN||0}aI.prototype.equals=function(T){return T&&T.x==this.x&&T.y==this.y};function U(aN,T){this.width=aN||0;this.height=T||0}U.prototype.equals=function(T){return T&&this.width==T.width&&this.height==T.height};function J(T,aN){if(!T){return}this._position=T;this.guid="spot"+(J.guid++);aN=aN||{};this._text=aN.text||"";this._offsets=aN.offsets?aN.offsets.slice(0):[5,5,5,5];this._userData=aN.userData||null;this._minZoom=aN.minZoom||null;this._maxZoom=aN.maxZoom||null}J.guid=0;aD.extend(J.prototype,{initialize:function(T){if(this._minZoom==null){this._minZoom=T.config.minZoom}if(this._maxZoom==null){this._maxZoom=T.config.maxZoom}},setPosition:function(T){if(T instanceof e){this._position=T}},getPosition:function(){return this._position},setText:function(T){this._text=T},getText:function(){return this._text},setUserData:function(T){this._userData=T},getUserData:function(){return this._userData}});function M(){this._map=null;this._container;this._type="control";this._visible=true}aD.lang.inherits(M,aD.lang.Class,"Control");aD.extend(M.prototype,{initialize:function(T){this._map=T;if(this._container){T.container.appendChild(this._container);return this._container}return},_i:function(T){if(!this._container&&this.initialize&&ar(this.initialize)){this._container=this.initialize(T)}this._opts=this._opts||{printable:false};this._setStyle();this._setPosition();if(this._container){this._container._jsobj=this}},_setStyle:function(){var aN=this._container;if(aN){var T=aN.style;T.position="absolute";T.zIndex=this._container.style.zIndex||"10";T.MozUserSelect="none";T.WebkitTextSizeAdjust="none";if(!this._opts.printable){aD.dom.addClass(aN,"BMap_noprint")}}},remove:function(){this._map=null;if(!this._container){return}this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container._jsobj=null;this._container=null},_render:function(){this._container=V(this._map.container,"<div unselectable='on'></div>");if(this._visible==false){aD.dom.hide(this._container)}return this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(aP){if(this.anchorFixed||!I(aP)||isNaN(aP)||aP<BMAP_ANCHOR_TOP_LEFT||aP>BMAP_ANCHOR_BOTTOM_RIGHT){aP=this.defaultAnchor}this._opts=this._opts||{printable:false};this._opts.offset=this._opts.offset||this.defaultOffset;var aO=this._opts.anchor;this._opts.anchor=aP;if(!this._container){return}var aR=this._container;var T=this._opts.offset.width;var aQ=this._opts.offset.height;if(this instanceof O){if(this._map&&this._map.highResolutionEnabled()){aR.childNodes[1].style.height="2px";aR.childNodes[2].style.height="4px";aR.childNodes[3].style.height="4px";aR.style.height="19px"}}aR.firstChild.style.cssText="font-size:11px;line-height:18px;";aR.style.left=aR.style.top=aR.style.right=aR.style.bottom="auto";switch(aP){case BMAP_ANCHOR_TOP_LEFT:aR.style.top=aQ+"px";aR.style.left=T+"px";break;case BMAP_ANCHOR_TOP_RIGHT:aR.style.top=aQ+"px";aR.style.right=T+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:aR.style.bottom=aQ+"px";aR.style.left=T+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:aR.style.bottom=aQ+"px";aR.style.right=T+"px";break;default:break}var aN=["TL","TR","BL","BR"];aD.dom.removeClass(this._container,"anchor"+aN[aO]);aD.dom.addClass(this._container,"anchor"+aN[aP])},getAnchor:function(){return this._opts.anchor},setOffset:function(T){if(!(T instanceof U)){return}this._opts=this._opts||{printable:false};this._opts.offset=new U(T.width,T.height);if(!this._container){return}this.setAnchor(this._opts.anchor)},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){if(this._visible==true){return}this._visible=true;if(this._container){aD.dom.show(this._container)}},hide:function(){if(this._visible==false){return}this._visible=false;if(this._container){aD.dom.hide(this._container)}},isPrintable:function(){return !!this._opts.printable},isVisible:function(){if(!this._container&&!this._map){return false}return !!this._visible}});window.BMAP_ANCHOR_TOP_LEFT=0;window.BMAP_ANCHOR_TOP_RIGHT=1;window.BMAP_ANCHOR_BOTTOM_LEFT=2;window.BMAP_ANCHOR_BOTTOM_RIGHT=3;function O(T){M.call(this);T=T||{};this._opts={printable:false};this._opts=aD.object.extend(aD.object.extend(this._opts,{color:"black",unit:"metric"}),T);this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new U(81,18);this.setAnchor(T.anchor);this._units={metric:{name:"metric",conv:1,incon:1000,u1:"\u7c73",u2:"\u516c\u91cc"}};if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._scaleText=null;this._numberArray={};this._asyncLoadCode()}window.BMAP_UNIT_METRIC="metric";aD.lang.inherits(O,M,"ScaleControl");aD.object.extend(O.prototype,{initialize:function(T){this._map=T;return this._container},setColor:function(T){this._opts.color=T+""},getColor:function(){return this._opts.color},_asyncLoadCode:function(){var T=this;an.load("control",function(){T._asyncDraw()})}});function s(T,aN){if(T&&!aN){aN=T}this._sw=this._ne=null;this._swLng=this._swLat=null;this._neLng=this._neLat=null;if(T){this._sw=new e(T.lng,T.lat);this._ne=new e(aN.lng,aN.lat);this._swLng=T.lng;this._swLat=T.lat;this._neLng=aN.lng;this._neLat=aN.lat}}aD.object.extend(s.prototype,{isEmpty:function(){return !this._sw||!this._ne},equals:function(T){if(!(T instanceof s)||this.isEmpty()){return false}return this.getSouthWest().equals(T.getSouthWest())&&this.getNorthEast().equals(T.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},getCenter:function(){if(this.isEmpty()){return null}return new e((this._swLng+this._neLng)/2,(this._swLat+this._neLat)/2)},extend:function(T){if(!(T instanceof e)){return}var aN=T.lng,aO=T.lat;if(!this._sw){this._sw=new e(0,0)}if(!this._ne){this._ne=new e(0,0)}if(!this._swLng||this._swLng>aN){this._sw.lng=this._swLng=aN}if(!this._neLng||this._neLng<aN){this._ne.lng=this._neLng=aN}if(!this._swLat||this._swLat>aO){this._sw.lat=this._swLat=aO}if(!this._neLat||this._neLat<aO){this._ne.lat=this._neLat=aO}},toSpan:function(){if(this.isEmpty()){return new e(0,0)}return new e(Math.abs(this._neLng-this._swLng),Math.abs(this._neLat-this._swLat))}});function e(T,aN){this.lng=parseFloat(T);this.lat=parseFloat(aN)}e.prototype.equals=function(T){return T&&this.lat==T.lat&&this.lng==T.lng};function av(T){this._mapType=T}aD.extend(av.prototype,{pointToPixel:function(aN,aR,aQ,aP){if(!aN){return}var aO=this._mapType.getZoomUnits(aR);var T=Math.round((aN.lng-aQ.lng)/aO+aP.width/2);var aS=Math.round((aQ.lat-aN.lat)/aO+aP.height/2);return new aI(T,aS)},pixelToPoint:function(aP,aS,aR,aQ){if(!aP){return}var aN=this._mapType.getZoomUnits(aS);var aO=aR.lng+aN*(aP.x-aQ.width/2);var aT=aR.lat-aN*(aP.y-aQ.height/2);var T=new e(aO,aT);return T}});function L(){this._type="overlay"}aD.lang.inherits(L,aD.lang.Class,"Overlay");L.getZIndex=function(T){T=T*1;if(!T){return 0}return(T*-100000)<<1};aD.extend(L.prototype,{_i:function(T){if(!this.domElement&&ar(this.initialize)){this.domElement=this.initialize(T);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}}this.draw()},initialize:function(T){throw"initialize\u65b9\u6cd5\u672a\u5b9e\u73b0"},draw:function(){throw"draw\u65b9\u6cd5\u672a\u5b9e\u73b0"},remove:function(){if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}this.domElement=null;this.dispatchEvent(new at("onremove"))},hide:function(){if(this.domElement){aD.dom.hide(this.domElement)}},show:function(){if(this.domElement){aD.dom.show(this.domElement)}},isVisible:function(){if(!this.domElement){return false}if(this.domElement.style.display=="none"||this.domElement.style.visibility=="hidden"){return false}return true}});BMap.register(function(aO){var T=aO.temp;T.overlayDiv=aO.overlayDiv=aN(aO.platform,200);aO._panes.floatPane=aN(T.overlayDiv,800);aO._panes.markerMouseTarget=aN(T.overlayDiv,700);aO._panes.floatShadow=aN(T.overlayDiv,600);aO._panes.labelPane=aN(T.overlayDiv,500);aO._panes.markerPane=aN(T.overlayDiv,400);aO._panes.markerShadow=aN(T.overlayDiv,300);aO._panes.mapPane=aN(T.overlayDiv,200);function aN(aP,aS){var aR=p("div"),aQ=aR.style;aQ.position="absolute";aQ.top=aQ.left=aQ.width=aQ.height="0";aQ.zIndex=aS;aP.appendChild(aR);return aR}});function aA(){aD.lang.Class.call(this);L.call(this);this.map=null;this._visible=true;this._dblclickTime=0}aD.lang.inherits(aA,L,"OverlayInternal");aD.extend(aA.prototype,{initialize:function(T){this.map=T;aD.lang.Class.call(this,this.guid);return null},getMap:function(){return this.map},draw:function(){},remove:function(){this.map=null;aD.lang.decontrol(this.guid);L.prototype.remove.call(this)},hide:function(){if(this._visible==false){return}this._visible=false},show:function(){if(this._visible==true){return}this._visible=true},isVisible:function(){if(!this.domElement){return false}return !!this._visible},getContainer:function(){return this.domElement},setConfig:function(aN){aN=aN||{};for(var T in aN){this._config[T]=aN[T]}},setZIndex:function(T){this.zIndex=T},enableMassClear:function(){this._config.enableMassClear=true},disableMassClear:function(){this._config.enableMassClear=false}});function ao(){this.map=null;this._overlays={};this._customOverlays=[]}BMap.register(function(aN){var T=new ao();T.map=aN;aN._overlays=T._overlays;aN._customOverlays=T._customOverlays;aN.addEventListener("load",function(aO){T.draw(aO)});aN.addEventListener("moveend",function(aO){T.draw(aO)});aN.addEventListener("zoomend",function(aO){T.draw(aO)});aN.addEventListener("addoverlay",function(aS){var aP=aS.target;if(aP instanceof aA){if(!T._overlays[aP.guid]){T._overlays[aP.guid]=aP}}else{var aR=false;for(var aQ=0,aO=T._customOverlays.length;aQ<aO;aQ++){if(T._customOverlays[aQ]===aP){aR=true;break}}if(!aR){T._customOverlays.push(aP)}}});aN.addEventListener("removeoverlay",function(aR){var aP=aR.target;if(aP instanceof aA){delete T._overlays[aP.guid]}else{for(var aQ=0,aO=T._customOverlays.length;aQ<aO;aQ++){if(T._customOverlays[aQ]===aP){T._customOverlays.splice(aQ,1);break}}}});aN.addEventListener("clearoverlays",function(aR){for(var aQ in T._overlays){if(T._overlays[aQ]._config.enableMassClear){T._overlays[aQ].remove();delete T._overlays[aQ]}}for(var aP=0,aO=T._customOverlays.length;aP<aO;aP++){if(T._customOverlays[aP].enableMassClear!=false){T._customOverlays[aP].remove();T._customOverlays[aP]=null;T._customOverlays.splice(aP,1);aP--;aO--}}})});ao.prototype.draw=function(aN){for(var T in this._overlays){this._overlays[T].draw()}aD.array.each(this._customOverlays,function(aO){aO.draw()})};function aq(T){aA.call(this);this._config={strokeColor:"#3a6bdb",strokeWeight:5,strokeOpacity:0.65,strokeStyle:"solid",enableMassClear:true,getParseTolerance:null,getParseCacheIndex:null,enableParse:true,clickable:true};T=T||{};this.setConfig(T);if(this._config.strokeWeight<=0){this._config.strokeWeight=5}if(this._config.strokeOpacity<0||this._config.strokeOpacity>1){this._config.strokeOpacity=0.65}if(this._config.strokeStyle!="solid"&&this._config.strokeStyle!="dashed"){this._config.strokeStyle="solid"}if(ad(T.enableClicking)){this._config.clickable=T.enableClicking}this.domElement=null;this._bounds=new BMap.Bounds(0,0,0,0);this._parseCache=[];this._temp={}}aD.lang.inherits(aq,aA,"Graph");aq.getGraphPoints=function(aN){var T=[];if(!aN){return T}if(aC(aN)){var aO=aN.split(";");aD.array.each(aO,function(aQ){var aP=aQ.split(",");T.push(new e(aP[0],aP[1]))})}if(aN.constructor==Array&&aN.length>0){T=aN}return T};aq.parseTolerance=[0.09,0.005,0.0001,0.00001];aD.extend(aq.prototype,{initialize:function(T){this.map=T;return null},draw:function(){},setPath:function(T){this._parseCache.length=0;this.points=aq.getGraphPoints(T).slice(0);this._calcBounds()},_calcBounds:function(){if(!this.points){return}var T=this;T._bounds=new s();aD.array.each(this.points,function(aN){T._bounds.extend(aN)})},getPath:function(){return this.points},setPositionAt:function(aN,T){if(!T||!this.points[aN]){return}this._parseCache.length=0;this.points[aN]=new e(T.lng,T.lat);this._calcBounds()},setStrokeColor:function(T){this._config.strokeColor=T},getStrokeColor:function(){return this._config.strokeColor},setStrokeWeight:function(T){if(T>0){this._config.strokeWeight=T}},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(T){if(!T||T>1||T<0){return}this._config.strokeOpacity=T},getStrokeOpacity:function(){return this._config.strokeOpacity},setStrokeStyle:function(T){if(T!="solid"&&T!="dashed"){return}this._config.strokeStyle=T},getStrokeStyle:function(){return this._config.strokeStyle},getBounds:function(){return this._bounds},remove:function(){aA.prototype.remove.call(this);this._parseCache.length=0}});function r(aN,aO,aP){if(!aN||!aO){return}this.imageUrl=aN;this.size=aO;var T=new U(Math.floor(aO.width/2),Math.floor(aO.height/2));var aQ={anchor:T,imageOffset:new U(0,0)};aP=aP||{};aD.extend(aQ,aP);this.anchor=aQ.anchor;this.imageOffset=aQ.imageOffset;this.printImageUrl=aP.printImageUrl||""}var N=r.prototype;N.setImageUrl=function(T){if(!T){return}this.imageUrl=T};N.setPrintImageUrl=function(T){if(!T){return}this.printImageUrl=T};N.setSize=function(T){if(!T){return}this.size=new U(T.width,T.height)};N.setAnchor=function(T){if(!T){return}this.anchor=new U(T.width,T.height)};N.setImageOffset=function(T){if(!T){return}this.imageOffset=new U(T.width,T.height)};N.toString=function(){return"Icon"};var ae=aL.imgPath+"red_marker.png";var aB=new r(ae,new U(19,25),{anchor:new U(10,25)});var F=new r(ae,new U(20,11),{anchor:new U(6,11),imageOffset:new U(-19,-13)});function D(T,aO){aA.call(this);aO=aO||{};this.point=T;this.map=null;this._config={offset:new U(0,0),icon:aB,shadow:F,title:"",baseZIndex:0,clickable:true,zIndexFixed:false,isTop:false,enableMassClear:true};this.setConfig(aO);if(aO.icon&&!aO.shadow){this._config.shadow=null}if(ad(aO.enableClicking)){this._config.clickable=aO.enableClicking}var aN=this;an.load("marker",function(){aN._draw()})}D.TOP_ZINDEX=L.getZIndex(-90)+1000000;aD.lang.inherits(D,aA,"Marker");aD.extend(D.prototype,{setIcon:function(T){if(T instanceof r){this._config.icon=T}},getIcon:function(){return this._config.icon},setShadow:function(T){if(T instanceof r){this._config.shadow=T}},getShadow:function(){return this._config.shadow},getPosition:function(){return this.point},setPosition:function(T){if(T instanceof e){this.point=new e(T.lng,T.lat)}},setTop:function(aN,T){this._config.isTop=!!aN;if(aN){this._addi=T||0}},setTitle:function(T){this._config.title=T+""},getTitle:function(){return this._config.title},setOffset:function(T){if(T instanceof U){this._config.offset=T}},getOffset:function(){return this._config.offset}});function ag(T,aO){aq.call(this,aO);this.setPath(T);var aN=this;an.load("poly",function(){aN._draw()})}aD.lang.inherits(ag,aq,"Polyline");function az(T){this.map=T;this.mapTypeLayers=[];this.tileLayers=[];this.bufferNumber=300;this.realBufferNumber=0;this.mapTiles={};this.bufferTiles={};this.numLoading=0;this.isFirstTile=true;this.arrStatTraffic=[];this._mapTypeLayerContainer=this._createDiv(1);this._vectorLayerContainer=this._createDiv(2);this._normalLayerContainer=this._createDiv(3);T.platform.appendChild(this._mapTypeLayerContainer);T.platform.appendChild(this._vectorLayerContainer);T.platform.appendChild(this._normalLayerContainer)}BMap.register(function(aN){var T=new az(aN);T.initialize();aN.tileMgr=T});aD.extend(az.prototype,{initialize:function(){var T=this,aN=T.map;aN.addEventListener("loadcode",function(){T.loadTiles()});aN.addEventListener("addtilelayer",function(aO){T.addTileLayer(aO)});aN.addEventListener("removetilelayer",function(aO){T.removeTileLayer(aO)});aN.addEventListener("zoomstartcode",function(aO){T._zoom(aO)});aN.addEventListener("zoomend",function(aO){T.setRasterTrafficStatus(aO)});aN.addEventListener("trafficchange",function(aO){if(!this.rasterTrafficLayer){this.rasterTrafficLayer=new af()}T.setRasterTrafficStatus(aO)});T.addMapClickEvent()},loadTiles:function(){var aT=this;if(!aT.loaded){aT.initMapTypeTiles()}aT.moveGridTiles();if(!aT.loaded){aT.loaded=true;var aR="tile",aU="vector",aS=window.asyncMdlVer[aR],aQ=window.asyncMdlVer[aU],T="async_"+aR+"_"+aS,aN="async_"+aU+"_"+aQ,aP=window.getVersion(T),aO=window.getVersion(aN);if(aS&&aP&&aQ&&aO){an.run(aR,aP);an.run(aU,aO);aT._asyncLoadCode()}else{if(aT.map.vectorMapEnabled()){an.load("vector",function(){aT._asyncLoadCode()})}else{an.load("tile",function(){aT._asyncLoadCode()})}}}},initMapTypeTiles:function(){var aN=this.map.getMapType();var aO=aN.getTileLayers();for(var T=0;T<aO.length;T++){var aP=new A();aD.extend(aP,aO[T]);this.mapTypeLayers.push(aP);aP.initialize(this.map,this._mapTypeLayerContainer)}},_createDiv:function(aN){var T=p("div");T.style.position="absolute";T.style.left=T.style.top="0";T.style.zIndex=aN;return T},_checkTilesLoaded:function(){this.numLoading--;var T=this;if(this.isFirstTile){this.map.dispatchEvent(new at("onfirsttileloaded"));this.isFirstTile=false}if(this.numLoading==0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(T.numLoading==0){T.map.dispatchEvent(new at("ontilesloaded"));T.isFirstTile=true}T._checkLoadedTimer=null},80)}},getTileName:function(T,aN){return"TILE-"+aN.guid+"-"+T[0]+"-"+T[1]+"-"+T[2]},hideTile:function(aN){var T=aN.img;if(T){if(n(T)){T.parentNode.removeChild(T)}}delete this.mapTiles[aN.name];if(!aN.loaded){T=null;aN._callCbks();aN.img=null;aN.mgr=null}},moveGridTiles:function(){this.arrStatTraffic.length=[];var bd=this.mapTypeLayers,aX=bd.concat(this.tileLayers),a2=aX.length;for(var a6=0;a6<a2;a6++){var aQ=aX[a6];if(aQ.baseLayer){this.tilesDiv=aQ.tilesDiv;var a3=this.tilesDiv;if(this.map.getZoom()>=this.map.config.vectorMapLevel){a3.style.display="none";continue}else{a3.style.display="block"}}if(aQ._isVectorLayer){continue}var bi=this.map,be=bi.getMapType(),bj=be.getProjection(),a5=bi.zoomLevel,a8=bi.mercatorCenter;var aV=be.getZoomUnits(a5),aY=be.getZoomFactor(a5),aW=Math.ceil(a8.lng/aY),aR=Math.ceil(a8.lat/aY),a1=be.getTileSize(),aP=[aW,aR,(a8.lng-aW*aY)/aY*a1,(a8.lat-aR*aY)/aY*a1],bc=aP[0]-Math.ceil((bi.width/2-aP[2])/a1),aO=aP[1]-Math.ceil((bi.height/2-aP[3])/a1),a9=aP[0]+Math.ceil((bi.width/2+aP[2])/a1),aZ=aP[1]+Math.ceil((bi.height/2+aP[3])/a1);var aN=this.mapTiles,aU=-a8.lng/aV,aT=a8.lat/aV,bg=[Math.round(aU),Math.round(aT)],T=bi.getZoom();for(var bh in aN){var bk=aN[bh],bf=bk.info;if(bf[2]!=T||(bf[2]==T&&(bc>bf[0]||a9<=bf[0]||aO>bf[1]||aZ<=bf[1]))){this.hideTile(bk)}}var aS=-bi.offsetX+bi.width/2,a0=-bi.offsetY+bi.height/2;aQ.tilesDiv.style.left=aS+"px";aQ.tilesDiv.style.top=a0+"px";if(this.tilesOrder){this.tilesOrder.length=0}else{this.tilesOrder=[]}if(bi._viewTiles){bi._viewTiles.length=0}else{bi._viewTiles=[]}for(var bb=bc;bb<a9;bb++){for(var ba=aO;ba<aZ;ba++){this.tilesOrder.push([bb,ba]);bi._viewTiles.push({x:bb,y:ba})}}this.tilesOrder.sort((function(bl){return function(bm,bn){return((0.4*Math.abs(bm[0]-bl[0])+0.6*Math.abs(bm[1]-bl[1]))-(0.4*Math.abs(bn[0]-bl[0])+0.6*Math.abs(bn[1]-bl[1])))}})([aP[0]-1,aP[1]-1]));if(!this.map.enableLoadTiles){return}var a4=aQ.baseLayer?true:false;if(a4){this.map.dispatchEvent(new at("ontilesbegin"));this.numLoading+=this.tilesOrder.length}if(aQ instanceof af){this.map.dispatchEvent(new at("onTrafficbegin"))}for(var bb=0,a7=this.tilesOrder.length;bb<a7;bb++){this.showTile([this.tilesOrder[bb][0],this.tilesOrder[bb][1],T],bg,aQ)}}},showTile:function(aR,aQ,aU){var aY=this,aW=aU.baseLayer?true:false;aY.centerPos=aQ;var aT=this.map.getMapType(),aO=aY.getTileName(aR,aU),a1=aT.getTileSize(),aP=(aR[0]*a1)+aQ[0],aN=(-1-aR[1])*a1+aQ[1],aV=[aP,aN],aX=this.mapTiles[aO];if(aX&&aX.img){aM(aX.img,aV);if(aW){if(aX.loaded){this._checkTilesLoaded()}else{aX._addLoadCbk(function(){aY._checkTilesLoaded()})}}return}aX=this.bufferTiles[aO];if(aX&&aX.img){aU.tilesDiv.insertBefore(aX.img,aU.tilesDiv.lastChild);this.mapTiles[aO]=aX;aM(aX.img,aV);if(aW){if(aX.loaded){this._checkTilesLoaded()}else{aX._addLoadCbk(function(){aY._checkTilesLoaded()})}}return}var a0=a1*Math.pow(2,(aT.getMaxZoom()-aR[2])),aZ=new e(aR[0]*a0,aR[1]*a0),aS=new aI(aR[0],aR[1]),T=aU.getTilesUrl(aS,aR[2]);aX=new au(this,T,aV,aR,aU);if(aW){aX._addLoadCbk(function(){aY._checkTilesLoaded()})}aX._load();this.mapTiles[aO]=aX},addTileLayer:function(aQ){var aP=this,aN=aQ.target;for(var aO=0;aO<aP.tileLayers.length;aO++){if(aP.tileLayers[aO]==aN){return}}var T=aN._isVectorLayer?this._vectorLayerContainer:this._normalLayerContainer;aN.initialize(this.map,T);aP.tileLayers.push(aN)},removeTileLayer:function(aQ){var aP=this,aN=aQ.target;for(var aO=0,T=aP.tileLayers.length;aO<T;aO++){if(aN==aP.tileLayers[aO]){aP.tileLayers.splice(aO,1)}}aN.remove()},_zoom:function(){var T=this;setTimeout(function(){T.moveGridTiles();T.map.dispatchEvent(new at("onzoomend"))},10)},addMapClickEvent:function(){var aO=this,T=200,aP=null,aN=0;aO.map.addEventListener("click",function(aQ){aN++;if(aN==1){aP=setTimeout(function(){aN=0;var aR=null,aT=aO.tileLayers;for(var aS in aT){if(aT[aS] instanceof ah){aR=aT[aS];break}}if(aR&&aR.vectorClick(aQ)){return}if(aO.vectorDrawLib){aO.vectorDrawLib.vectorClick(aQ)}},T)}else{clearTimeout(aP);aN=0;return false}})},setRasterTrafficStatus:function(aP){var aN=this,aO=aN.map,T=aO.getZoom();if(aO.config.trafficStatus&&T<aO.config.vectorMapLevel){aO.addTileLayer(aO.rasterTrafficLayer)}else{aO.removeTileLayer(aO.rasterTrafficLayer)}}});function au(aT,T,aQ,aN,aP){this.mgr=aT;this.position=aQ;this._cbks=[];this.name=aT.getTileName(aN,aP);this.info=aN;this.level=parseInt(aN[2],10);var aU=p("img");l(aU);aU.galleryImg=false;var aS=aU.style;var aO=aT.map.getMapType(),aV=aO.getTileSize();aS.position="absolute";aS.width=aV+"px";aS.height=aV+"px";aS.left=aQ[0]+"px";aS.top=aQ[1]+"px";this.img=aU;this.src=T;var aR=this;this.img.onload=function(a3){aR.loaded=true;if(!aR.mgr){return}var a0=aR.mgr;var a4=a0.bufferTiles;if(!a4[aR.name]){a0.realBufferNumber++;a4[aR.name]=aR}if(aR.img&&!n(aR.img)){if(aP.tilesDiv){aP.tilesDiv.appendChild(aR.img)}}var a5=a0.realBufferNumber-a0.bufferNumber;for(var aX in a4){if(a5<=0){break}if(!a0.mapTiles[aX]){a4[aX].mgr=null;var a2=a4[aX].img;if(a2&&a2.parentNode){a2.parentNode.removeChild(a2)}a2=null;a4[aX].img=null;delete a4[aX];a0.realBufferNumber--;a5--}}aR._callCbks();var aW=this.src,aY=aT.arrStatTraffic;if(aW.indexOf("TrafficTileService")>-1){for(var a1=0,aZ=aY.length;a1<aZ;a1++){if(aW.indexOf(aY[a1])>-1){aY.splice(a1,1);break}}if(aY.length<=0){aT.map.dispatchEvent(new at("onTrafficloaded"))}}};this.isHighResolution=aT.map.highResolutionEnabled();this.img.onerror=function(){var aX=aR.img,aZ=aX?aX.getAttribute("errorCount"):true;if(aX&&(!aZ||aZ&&aZ<5)){aZ=aZ||0;aZ++;aX.src=T;BMap.logCountError.countPic(aR.isHighResolution,false,aZ,aR.level);aX.setAttribute("errorCount",aZ);BMap.logCountError.countPic(aR.isHighResolution,true,aZ,aR.level)}else{aR._callCbks();if(!aR.mgr){return}var aW=aR.mgr;var aY=aW.map.getMapType();if(aY.getErrorImageUrl()){aR.error=true;aR.img.src=aY.getErrorImageUrl();if(aR.img&&!n(aR.img)){aP.tilesDiv.appendChild(aR.img)}}BMap.logCountError.countPic(aR.isHighResolution,true,6,aR.level)}};aU=null}au.prototype._addLoadCbk=function(T){this._cbks.push(T)};au.prototype._load=function(){this.img.src=this.src;BMap.logCountError.countPic(this.isHighResolution,false,0,this.level)};au.prototype._callCbks=function(){var aN=this;for(var T=0;T<aN._cbks.length;T++){aN._cbks[T]()}aN._cbks.length=0};function A(T){this.opts=T||{};this.baseLayer=this.opts.baseLayer||false;this.zIndex=this.opts.zIndex||0;this.guid=A._guid++}A._guid=0;aD.lang.inherits(A,aD.lang.Class,"TileLayer");aD.extend(A.prototype,{initialize:function(aO,T){if(this.baseLayer){this.zIndex=-100}this.map=aO;if(!this.tilesDiv){var aP=p("div");var aN=aP.style;aN.position="absolute";aN.zIndex=this.zIndex;aN.left=Math.ceil(-aO.offsetX+aO.width/2)+"px";aN.top=Math.ceil(-aO.offsetY+aO.height/2)+"px";T.appendChild(aP);this.tilesDiv=aP}},remove:function(){if(this.tilesDiv&&this.tilesDiv.parentNode){this.tilesDiv.innerHTML="";this.tilesDiv.parentNode.removeChild(this.tilesDiv)}delete this.tilesDiv},getTilesUrl:function(aN,aO){var T="";if(this.opts.tileUrlTemplate){T=this.opts.tileUrlTemplate.replace(/\{X\}/,aN.x);T=T.replace(/\{Y\}/,aN.y);T=T.replace(/\{Z\}/,aO)}return T},getMapType:function(){return this.mapType}});function af(T){A.call(this,T);this._opts={};T=T||{};this._opts=aD.object.extend(this._opts,T);if(this._opts.predictDate){if(this._opts.predictDate.weekday<1||this._opts.predictDate.weekday>7){this._opts.predictDate=1}if(this._opts.predictDate.hour<0||this._opts.predictDate.hour>23){this._opts.predictDate.hour=0}}this._tileUrl="http://its.map.baidu.com:8002/traffic/"}af.prototype=new A();af.prototype.initialize=function(aN,T){A.prototype.initialize.call(this,aN,T);this._map=aN};af.prototype.getTilesUrl=function(aU,aN){var aO=this._map.tileMgr.arrStatTraffic,aR="level="+aN+"&x="+aU.x+"&y="+aU.y;aO.push(aR);var aV="";if(this._opts.predictDate){aV="HistoryService?day="+(this._opts.predictDate.weekday-1)+"&hour="+this._opts.predictDate.hour+"&t="+new Date().getTime()+"&"}else{aV="TrafficTileService?time="+new Date().getTime()+"&"}var aP=this._map,aW=aU.x,aQ=aU.y,aT=Math.floor(aW/200),aS=Math.floor(aQ/200),T=this._tileUrl+aV+"level="+aN+"&x="+aW+"&y="+aQ;return T.replace(/-(\d+)/gi,"M$1")};function ah(aP,aO){var aN={zIndex:1};A.call(this,aN);this._keyWord=aP;this._cityCode=aO;this._isVectorLayer=true;this._map=null;this._container=null;var T=this;an.load("layer",function(){T._asyncLoadCode()})}aD.inherits(ah,A,"VectorMDLayer");aD.extend(ah.prototype,{initialize:function(aN,T){this._map=aN;this._container=T},remove:function(){this._map=null;this._container=null},setKeyword:function(T){this._keyWord=T},getKeyword:function(){return this._keyWord},setCityCode:function(T){this._cityCode=T},getCityCode:function(){return this._cityCode},refreshLayer:function(){}});function aH(T,aN,aO){this._name=T;this._layers=aN instanceof A?[aN]:aN.slice(0);this._opts={tips:"",labelText:"",minZoom:1,maxZoom:18,tileSize:256,textColor:"black",errorImageUrl:"",projection:new av(this)};if(this._layers.length==1){this._layers[0].baseLayer=true}aD.extend(this._opts,aO||{})}aD.extend(aH.prototype,{getName:function(){return this._name},getTips:function(){return this._opts.tips},getLabelText:function(){return this._opts.labelText},getTileLayer:function(){return this._layers[0]},getTileLayers:function(){return this._layers},getTileSize:function(){this._opts.tileSize=256;var T=this._opts.mapInstance;if(T.highResolutionEnabled()&&T.getZoom()<T.config.vectorMapLevel){this._opts.tileSize=128}return this._opts.tileSize},getMinZoom:function(){return this._opts.minZoom},getMaxZoom:function(){return this._opts.maxZoom},getTextColor:function(){return this._opts.textColor},getProjection:function(){return this._opts.projection},getErrorImageUrl:function(){return this._opts.errorImageUrl},getZoomUnits:function(T){var aO=1,aN=this._opts.mapInstance;if(aN.highResolutionEnabled()&&aN.getZoom()<aN.config.vectorMapLevel){aO=2}return Math.pow(2,(18-T))*aO},getZoomFactor:function(T){return this.getZoomUnits(T)*this.getTileSize()}});var t={pd:{host:["http://online0.map.bdimg.com/it/","http://online1.map.bdimg.com/it/","http://online2.map.bdimg.com/it/","http://online3.map.bdimg.com/it/"],params:{fm:42,f:"webapp",format_add:".jpg"}},hd:{host:["http://or1.map.baidu.com:8080/it/","http://or2.map.baidu.com:8080/it/","http://or3.map.baidu.com:8080/it/","http://or4.map.baidu.com:8080/it/"],params:{format:"jpeg",fm:41,quality:70,f:"webapp",format_add:".jpg"}}};var ay=new A();ay.getTilesUrl=function(aN,aT){var aU=aN.x,aP=aN.y,aO,aQ;var aR=BMap.TILE_CONFIG||t;if(this.map.highResolutionEnabled()){aO=aR.hd;if(typeof TVC!="undefined"){aQ=TVC.webapp.high_normal}}else{aO=aR.pd;if(typeof TVC!="undefined"){aQ=TVC.webapp.lower_normal}}var aV="u=x="+aU+";y="+aP+";z="+aT;if(aQ&&aQ.version){aV+=";v="+aQ.version}else{aV+=";v=014"}aV+=";type=web";var T=aO.host[Math.abs(aU+aP)%aO.host.length]+aV;if(aQ&&aQ.updateDate){T+="&udt="+aQ.updateDate}for(var aS in aO.params){T+="&"+aS+"="+aO.params[aS]}return T.replace(/-(\d+)/gi,"M$1")};function z(T,aP){this._container=typeof T=="string"?aD.g(T):T;this._opts={linksControl:true,enableDoubleClickZoom:true};aP=aP||{};for(var aN in aP){this._opts[aN]=aP[aN]}this._pov={heading:0,pitch:0};this._links=[];this._id=null;this._position=null;this._zoom=2;this._description="";this._mode="";var aO=this;an.load("streetview",function(){aO._draw()});this._init()}z.MAX_ZOOM=5;z.MIN_ZOOM=0;aD.lang.inherits(z,aD.lang.Class,"StreetView");aD.extend(z.prototype,{_init:function(){},getLinks:function(){return this._links},getId:function(){return this._id},getPosition:function(){return this._position},getPov:function(){return this._pov},getZoom:function(){return this._zoom},getDescription:function(){return this._description},getRelevants:function(){return this._relevants||[]},getMode:function(){return this._mode},setId:function(T){if(T==this._id){return}this._lastId=this._id;this._id=T;this._position=null;this._innerId=null},setInnerId:function(T){if(T==this._innerId){return}this._innerId=T;this._id=null;this._position=null},setPosition:function(T){if(T.equals(this._position)){return}this._lastId=this._id;this._position=T;this._id=null;this._innerId=null},setPov:function(T){this._pov=T;if(this._pov.pitch>45){this._pov.pitch=45}if(this._pov.pitch<-10){this._pov.pitch=-10}},setZoom:function(T){if(T==this._zoom){return}if(T>z.MAX_ZOOM){T=z.MAX_ZOOM}if(T<z.MIN_ZOOM){T=z.MIN_ZOOM}if(T!=this._zoom){this._zoom=T}},enableDoubleClickZoom:function(){this._opts.enableDoubleClickZoom=true},disableDoubleClickZoom:function(){this._opts.enableDoubleClickZoom=false},clear:function(){this._data=null;this._id=null;this._position=null;this._links=[];this.dispatchEvent(new at("onclear"))}});function j(){A.call(this)}j.URLS=["http://pcsv0.map.bdimg.com/tile/","http://pcsv1.map.bdimg.com/tile/"];j.prototype=new A();j.prototype.getTilesUrl=function(aP,aO){var T=(aP.x+aP.y)%j.URLS.length;var aN="pl";return j.URLS[T]+"?udt=v&qt=tile&styles="+aN+"&x="+aP.x+"&y="+aP.y+"&z="+aO};function E(T,aN){window.BMap[T]=aN}E("Map",x);E("Hotspot",J);E("MapType",aH);E("Point",e);E("Pixel",aI);E("Size",U);E("Bounds",s);E("TileLayer",A);E("RasterTrafficLayer",af);E("VectorMDLayer",ah);E("Overlay",L);E("Marker",D);E("Icon",r);E("Polyline",ag);E("Control",M);E("ScaleControl",O);E("StreetView",z);E("StreetViewCoverageLayer",j);})();module.exports=BMap;