define("common:widget/login/login.js",function(o,n,e){o("common:static/js/util.js");var i=o("common:widget/cookie/cookie.js"),t=o("common:widget/stat/stat.js"),a=o("common:widget/url/url.js");o("common:widget/md5/md5.js"),e.exports={init:function(){_init()},checkLogin:function(o){$.ajax({type:"GET",url:"http://mc.map.baidu.com/passport/Session3.php?t="+Date.now(),dataType:"jsonp",timeout:2e3,success:function(n,e){if("success"==e&&"0"==n.bdErrCode&&""!=n.displayname){var a={domain:location.hostname,path:"/mobile",expires:6048e5};return i.set("myUserName",n.displayname,a),localStorage.loginErr&&(t.addCookieStat(COM_STAT_CODE.STAT_USER_LOGIN_SUCCESS),localStorage.removeItem("loginErr")),o&&o({status:!0,username:n.displayname}),!0}localStorage.loginErr=1,o&&o({status:!1,username:""})},error:function(){return localStorage.loginErr=1,o&&o({status:!1,username:""}),!1}})},loginAction:function(){t.addCookieStat(COM_STAT_CODE.STAT_USER_LOGIN_SHOW),location.href="http://wappass.baidu.com/passport/?authsite=1&u="+encodeURIComponent(document.location)},logoutAction:function(){t.addCookieStat(COM_STAT_CODE.STAT_USER_MYCENTER_LOGOUT_CLICK),i.remove("myUserName"),location.href="http://wappass.baidu.com/passport/?logout&u=http://"+location.host+"/mobile/webapp/index/index/force=simple"},goMycenter:function(){t.addCookieStat(COM_STAT_CODE.STAT_INDEX_HEAD_MYCENTER_CLICK),a.navigate("/mobile/webapp/user/mycenter/force=simple")},makeSysSign:function(o){var n=[],e="";for(var i in o)n.push(i);for(var t=0;t<n.length;t++)e+=n[t]+"="+encodeURIComponent(o[n[t]]);return hex_md5(e)},_init:function(){var o=location.search,n=location.search.substr(location.search.indexOf("shopId")+7);-1!=n.indexOf("&")?(window.config.shopId=n.substr(0,n.indexOf("&")),window.config.isappInstalled=n.substr(n.indexOf("isappInstalled")+15)):(window.config.shopId=n.substr(0),window.config.isappInstalled=0),/android/gi.test(navigator.appVersion)&&(window.config.platform="android"),/iphone|ipad/gi.test(navigator.appVersion)&&(window.config.platform="iphone");var e=o.substr(o.indexOf("?from=")+6);$("open").href=e.substr(0,e.indexOf("&"));var i={fields:'{"extends":{"more":1}}',sysTerminalType:window.config.platform+window.config["token_"+window.config.platform]},t=makeSysSign(i),a=window.config.dataSource+window.config.shopId+"?sysSign="+t+"&fields="+i.fields+"&sysTerminalType="+window.config.platform;scriptRequest(encodeURIComponent(a),"makeData")}}});