define("place:widget/genericre/genericre-vector.js",function(e,a,n){var i,t=e("common:static/js/mapconst.js"),r=e("common:widget/stat/stat.js"),o=e("common:widget/geolocation/location.js"),c=c||{};$.extend(c,{init:function(){this.bind()},bind:function(){var e=this;if(!e.hasbinded){e.hasbinded=!0,listener.on("infowindow."+t.IW_GRT,"click",function(e,a){var n=a.id,i=a.data,t=a.instance;switch(n){case"iw-l":t.nbSearch(i.name,i.geo);break;case"iw-c":t.detailSearch(i.uid);break;case"iw-r":t.lineSearch(i.name,i.geo)}});var a=e.map;a.addEventListener("click",function(){e.marker&&(e.map.removeOverlay(e.marker),e.marker=null)}),a.addEventListener("onvectorclick",function(a){var n=a.iconInfo;if("madian"==a.from){var o=new i.Point(n.point.x,n.point.y),c=e.mapView.iwController.get(t.IW_GRT);e.marker?e.marker.setPoint(o):e.marker=e.addGRMarker(o),e.marker.show(),c.setData(t.IW_GRT,{json:[{uid:n.uid,name:n.name,geo:"1|"+o.lng+","+o.lat}]}).switchTo(0),r.addStat(COM_STAT_CODE.MAP_GR_MARKER_CLICK),c.skipClickHandler=!0}})}},addGRMarker:function(e){var a=new i.Icon(t.MARKERS_PATH,new i.Size(23,32),{anchor:new i.Size(11,30),imageOffset:new i.Size(29,352)}),n=new this.mapView.CustomMarker(a,e,{className:"fix_gr_mk"});return this.map.addOverlay(n),n},setMapView:function(e){var a=this;a.mapView=e,a.map=e.getMap(),i=e.getBMap(),a.hasbinded||a.init()},setGRData:function(e){var a=encodeURIComponent(e.result.return_query),n=o.getCityCode()||1,t=this,r=t.map;e.current_city&&"code"in e.current_city&&(n=e.current_city.code),t.vectorMdLayer=new i.VectorMDLayer(a,n),r.addTileLayer(t.vectorMdLayer)},clearCache:function(){var e=this,a=e.map;a.removeTileLayer(e.vectorMdLayer)}}),n.exports=c});