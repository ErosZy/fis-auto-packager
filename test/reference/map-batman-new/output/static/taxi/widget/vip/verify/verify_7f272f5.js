define("taxi:widget/vip/verify/verify.js",function(t,e,i){"use strict";var n=t("taxi:static/js/storage.js"),o=t("taxi:widget/common/popup/popup.js"),a=t("common:widget/stat/stat.js"),e={create:function(){var t=this.$el=$(".taxi-widget-vip-verify"),e=this.$inputPhone=t.find(".input-phone"),i=this.$inputCode=t.find(".input-code"),o=this.$btnGetCode=t.find(".btn-get-code"),a=this.$btnVerifyPhone=t.find(".btn-verify-phone"),s=t.find(".btn-back");o.on("click",$.proxy(this.onBtnGetCodeClick,this)),a.on("click",$.proxy(this.onBtnVerifyPhoneClick,this)),e.on("keyup",$.proxy(this.onInputPhoneKeyup,this)),i.on("keyup",$.proxy(this.onInputCodeKeyup,this)),s.on("click",$.proxy(this.onBtnBackClick,this)),e.val(n.get("thirdPhone")||""),Taxi.validatePhone(e.val())&&o.removeAttr("disabled"),this.options&&this.options.referrer&&s.show(),this.$btnGetCode=o,this.$inputPhone=e},onBtnGetCodeClick:function(){var t,e=this,i=this.$btnGetCode,n=this.$inputPhone,a=60,s=i.text(),r=this.$inputPhone.val(),d=function(){i.text(a+"秒"),a--};i.attr("disabled","disabled"),n.attr("disabled","disabled"),LoadManager.request({data:{qt:"sendcode",phone:r},success:function(){d(),t=e.interval=setInterval(function(){0===a?(i.removeAttr("disabled"),n.removeAttr("disabled"),i.text(s),clearInterval(t),t=-1):d()},1e3)},error:function(t){var a="";switch(t.errno){case-201:a="请求太频繁，请60秒后重试！";break;case-101:a="参数错误！";break;default:a="系统错误！"}o.open({text:a,layer:!0,onClose:function(){i.removeAttr("disabled"),n.removeAttr("disabled"),i.text(s),clearInterval(e.interval),e.interval=-1}})}})},onBtnVerifyPhoneClick:function(){var t=this.$inputPhone.val(),e=this.$btnVerifyPhone;e.attr("disabled","disabled"),o.open({text:"正在验证手机号...",layer:!0,autoCloseTime:0}),LoadManager.request({data:{qt:"verifycode",phone:t,code:this.$inputCode.val()},success:function(i){o.close(),1===i.info.is_pass?(n.set("thirdPhone",t),LoadManager.loadPage("vip/home")):o.open({text:"验证码错误！",layer:!0}),e.removeAttr("disabled"),a.addStat(STAT_CODE.TAXI_VERIFYCODE)},error:function(){o.close(),e.removeAttr("disabled")}})},onInputPhoneKeyup:function(){Taxi.validatePhone(this.$inputPhone.val())?this.$btnGetCode.removeAttr("disabled"):this.$btnGetCode.attr("disabled","disabled")},onInputCodeKeyup:function(){Taxi.validatePhone(this.$inputPhone.val())&&Taxi.validateCode(this.$inputCode.val())?this.$btnVerifyPhone.removeAttr("disabled"):this.$btnVerifyPhone.attr("disabled","disabled")},onBtnBackClick:function(){LoadManager.loadPage(this.options.referrer)},destroy:function(){clearInterval(this.interval),this.interval=-1},init:function(){this.options=LoadManager.getPageOptions(),this.create()}};i.exports=e});