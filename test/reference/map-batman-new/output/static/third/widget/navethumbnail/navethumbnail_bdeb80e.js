define("third:widget/navethumbnail/navethumbnail.js",function(t,e,i){var n=t("common:static/js/util.js"),a=(t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),o=t("common:static/js/searchdata.js"),s=t("common:widget/stat/stat.js"),r={type:"0,2",level:16,height:101,width:window.innerWidth-22,url:null,host:"http://snap.map.baidu.com/?qt=snap&data="},c=window._CURRENT_CITY,h=c.name;n.showLoading($("#poipic-area")),i.exports={init:function(){this.render(),this.bind()},render:function(){this.thumbImage=$("#mapimg"),this.errorCnt=$(".error-cnt"),this.thumbImageA=$("#right-a"),this.subwayBtn=$("#subwayBtn"),this.cityNameCnt=$("#cityNameCnt"),this.nearbus=$("#nb-bus"),this.nearbusspan=$("#busspan"),this.nearsubway=$("#nb-subway"),this.nearsubwayspan=$("#stationspan"),this.imgcon=$("#route-pic")},bind:function(){var t=this;listener.on("common.geolocation","mylocsuc",function(){t.setLocation()},this),listener.on("common.geolocation","fail",function(){t.thumbImageA.hide(),t.errorCnt.show()},this),listener.on("common","sizechange",function(){t._appReSize()},this),t._trafficsubway()},_trafficsubway:function(){var t=this;if("全国"!=h){t.imgcon.show(),t._setThumbUrl();var e=n.ifSupportSubway(a.getCityCode());if(e){var i=e.split(",");t.subwayBtn.attr("href","/mobile/webapp/subway/show/city="+i[0]+"/ref=index&forcesample=old_sample_1309"),t.cityNameCnt.html(i[1]+"市地铁线路图"),t.subwayBtn.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAYBTN_DISPLAY)}else t.subwayBtn.hide()}},_appReSize:function(){var t=this;n.isAndroid()?setTimeout(function(){r.width=window.innerWidth-22},800):r.width=window.innerWidth-22,t._setThumbUrl()},setLocation:function(){var t=this;a.getMyCityCode()==c.code&&t._getNearbyData()},_setThumbUrl:function(){var t=this,e=t._getThumbUrl();t.thumbImage.attr("src",e),n.hideLoading($("#poipic-area"))},_getThumbUrl:function(){r.level=0==r.type?"全国"==a.getCity()?3:a.hasExactPoi()?16:10:10;var t;c?(JSONdata=c.geo,cityPoint=n.geoToPoint(JSONdata),t={x:0,y:0},t.x=cityPoint.lng,t.y=cityPoint.lat):t=a.getCenterPoi();var e={retype:1,src:"webapp",level:r.level,center:t.x+" "+t.y,height:101,width:r.width,coordtype:"M",pictype:r.type};return r.host+JSON.stringify(e)},_getNearbyData:function(){var t=this,e=$.param(t._getQueryByWd("公交站").query),i=$.param(t._getQueryByWd("地铁站").query);o.fetch(e,$.proxy(t._cbGetBusStation,this)),o.fetch(i,$.proxy(t._cbGetSubwayStation,this))},_getQueryByWd:function(t){var e={qt:"s",wd:t,c:a.getMyCityCode()},i={};return e.center_rank=1,e.nb_x=a.getMyPointX(),e.nb_y=a.getMyPointY(),{query:e,pageState:i}},_cbGetBusStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){var i=t.content[0]||"";e.nearbusspan.text(i.name+"-公交站"),e.nearbusspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+i.uid+"&c="+a.getMyCityCode()+"/tab=line"),e.nearbus.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_BUS_DISPLAY)}},_cbGetSubwayStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){for(var i=void 0,n=0,o=t.content.length;o>n;n++)if(3==t.content[n].poiType){i=t.content[n];break}if(void 0!=i){var r=i||"",c=r.name+"-地铁站";e.nearsubwayspan.text(c),e.nearsubwayspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+r.uid+"&c="+a.getMyCityCode()+"/tab=line"),e.nearsubway.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAY_DISPLAY)}}}}});