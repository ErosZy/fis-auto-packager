!function(e){function t(e){var t={selector:"a,[data-href]",cacheMaxTime:3e5,pushState:!0,layer:document.body};A=u(t,e),P=A.cacheMaxTime,m=A.pushState,b=n(A.layer),y=g(),m===!0&&r()}function r(){window.addEventListener("popstate",o,!1),b.addEventListener("click",l,!0),BigPipe.on("pagerendercomplete",a,this),BigPipe.on("pagearrived",i,this),BigPipe.on("onpageloaded",c,this)}function n(e){return"string"==typeof e?document.querySelector(e):e&&e.nodeType?e:document.body}function o(e){var t=g();y&&t!==y&&(v("onpagerenderstart"),h(t,e.state))}function a(e){x[e.url]={resource:e.resource,time:Date.now()},v("onpagerendercomplete",{url:e.url})}function i(e){v("onpagearrived",e)}function c(){v("onpageloaded")}function u(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function l(e){for(var t=e.target,r=t,n=A.selector;r!==document.body;){if(p(r,n)){if(urlAttr="a"===r.tagName.toLowerCase()?"href":"data-href",url=r.getAttribute(urlAttr),d(url)){e.stopPropagation(),e.preventDefault();var o={replace:r.getAttribute("data-replace")||!1,containerId:r.getAttribute("data-area"),pagelets:r.getAttribute("data-area"),target:r};s(url,o)}return}r=r.parentNode}}function p(e,t){if(!e||1!==e.nodeType)return!1;var r,n,o=e.webkitMatchesSelector||e.matchesSelector;return o?n=o.call(e,t):(r=e.parentNode,n=!!r.querySelector(t)),n}function d(e){var t=A.validate,r=Object.prototype.toString.call(t);return"[object RegExp]"===r?t.test(e):"[object Function]"===r?t(e):!0}function f(e){return E.test(e)?RegExp.$5+(RegExp.$6?RegExp.$6:""):("console"in window&&console.error("[url error]:",e),void 0)}function g(){return f(window.location.href)}function s(e,t){if(e=f(e),g()!==e){var r,n={trigger:!0,forword:!0,replace:!1},o={url:e};if(t=u(n,t),o.target=t.target||null,t.trigger===!1)return m&&(r=t.replace?"replaceState":"pushState",window.history[r]({},document.title,e)),void 0;if(!m)return t.replace?location.replace(e):location.href=e,void 0;v("onpagerenderstart",o),h(e,t,function(){t.forword&&(r=t.replace?"replaceState":"pushState",window.history[r]({},document.title,e))})}}function h(e,t,r){if(e){var t=(Date.now(),t||{}),n=[],o={},a=t.containerId?t.containerId:A.containerId,i=t.pagelets?t.pagelets:A.pagelets;if("string"==typeof i&&(i=[i]),y=e,i.length>0){for(var c=0,u=i.length;u>c;c++)n.push("pagelets[]="+i[c]);e=-1===e.indexOf("?")?e+"/?"+n.join("&"):e+"&"+n.join("&")}t.cache===!1&&(o.cache=!1),BigPipe.refresh(e,a,o,function(){r&&r()})}}function v(e){var t=B[e];if(t)for(var r=j.call(arguments,1),n=0,o=t.length;o>n;n++){var a=t[n];if(a.f.apply(a.o,r)===!1)break}}function w(e,t,r){var n=B[e]||(B[e]=[]);n.push({f:t,o:r})}var y,m,b,S=e,x={},P=0,A={},E=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/i,j=[].slice,B={};S.appPage={start:t,redirect:s,on:w},"define"in window&&"undefined"!=typeof module&&(module.exports=S.appPage)}(this);