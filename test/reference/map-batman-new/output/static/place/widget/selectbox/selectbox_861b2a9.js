define("place:widget/selectbox/selectbox.js",function(e,t,a){var r,_,o,s=e("common:widget/url/url.js"),n=e("common:widget/geolocation/location.js"),c=e("common:static/js/util.js"),l=e("common:widget/stat/stat.js"),i={takeout:{pl_dist:"radius",pl_sort_type:"sortType",pl_sort_rule:"orderType",pn:"pageNum"}};a.exports.init=function(e){var t,a;(o=e||{})&&(t=o.wd)&&(a=o.srcname),p(),r=o.select_type,_=o.what,l.addStat(STAT_CODE.PLACE_LIST_FILTER_VIEW,{wd:t,srcname:a})};var p=function(){var e=$(".place-widget-selectbox select");e.length,$.each(e,function(e,t){$(t).on("change",d)}),$(".city-select").on("click",T)},d=function(e){var t=e.target,a=$(t).closest("select").attr("name"),r=$(t)[0].selectedIndex,_=$($(t)[0][r]),s=_.text(),n=o.wd,c=o.srcname;switch(a){case"pl_dist":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_RANGE_CLICK,{wd:n,range:s,srcname:c});break;case"pl_sort_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_SORT_CLICK,{wd:n,sort:s,srcname:c});break;case"pl_sub_type":l.addCookieStat(STAT_CODE.PLACE_LIST_FILTER_CATEGORY_CLICK,{wd:n,type:s,srcname:c})}u(t),y()},u=function(e){var t=$(e),a=t[0].selectedIndex,r=$(t[0][a]),_=r.text(),o=t.parent().children(".select_title");o.html(_)},y=function(){var e=s.get().query,t=C(),a=n.getCityCode();t=$.extend(t,{pn:0}),e=$.extend(e,t,{c:a}),"takeout"===r&&(e=g(e,r)),"hotel"===r&&(e.pl_filt_type_section=1),e.pl_tonight_sale_flag_section&&delete e.pl_tonight_sale_flag_section,"全市"==e.pl_dist?delete e.center_rank:e.nb_x&&e.nb_y&&(e.center_rank=1),e.pl_movie_book_section="movie_book"==e.pl_sort_type?"1,1":"0,+",s.update({query:e,pageState:{show_select:1}},{queryReplace:!0,replace:!0})},C=function(){var e,t,a=$(".place-widget-selectbox select"),r={};return $.each(a,function(a,_){var o={},s=$(_);switch(s.parent("select-box"),e=$(_).attr("name"),t=$(_).val(),e){case"pl_sub_type":o.wd=t,o.pl_sub_type=t;break;case"pl_sort_type":o.pl_sort_type=t.split("__")[0],o.pl_sort_rule=t.split("__")[1]||0;break;case"pl_dist":o.pl_dist=t}r=$.extend(r,o)}),r},g=function(e,t){if(e&&t){var a=$.extend({},e),r=i[t];return $.each(r,function(e,t){var r=a[e];r&&(a[t]=r),"pl_sort_rule"!==e&&"0"==r&&delete a[t],delete a[e]}),a}},T=function(){var e=n.getCityType(),t=n.getCityCode(),a=s.get(),r=a.query||{},i=(a.pageState||{},o.wd),p=o.srcname;r.wd=_||r.wd,3===e&&(t=n.getUpCityCode()||t),refer_query=c.jsonToUrl(a.query||{}),refer_pagestate=c.jsonToUrl(a.pageState||{}),l.addCookieStat(STAT_CODE.PLACE_SELECT_CLICK_CITY,{wd:i,srcname:p}),s.update({module:"index",action:"setmylocation",query:{c:t},pageState:{refer_query:refer_query,refer_pagestate:refer_pagestate,list_type:"business_area"}},{queryReplace:!0,pageStateReplace:!0})}});