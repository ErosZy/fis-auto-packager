define("index:widget/addestop/addestop.js",function(t,e,o){var i=t("common:widget/url/url.js"),n=t("common:static/js/util.js"),s=t("common:widget/cookie/cookie.js"),d=t("common:widget/stat/stat.js");o.exports={init:function(){this.render(),this.bind()},render:function(){var t=this;t.isosres=!1,t.os=n.isAndroid()?"android":n.isIPhone()?"iphone":n.isIPad()?"ipad":"unknown",t.isios7=n.getIosVersion()},bind:function(){var t=this;t._adddestop(),window.addEventListener("orientationchange",function(){if(t.isosres&&!s.get("addestopShow")){var e=$("#se_tabgroup"),o=e.height();e.css("height",o+1);var i=document.documentElement.clientWidth/2-91,n=document.getElementById("adddesktop-con");t.isios7||(90==window.orientation||-90==window.orientation)&&(i-=40),n.setAttribute("style","left:"+i+"px;bottom: 10px;bottom: 10px;"),e.css("height",e.height()-1)}})},_adddestop:function(){var t=this,e=window._APP_HASH,o=e.module,n=e.action,a=i.get().pageState||{},r=navigator.userAgent,c=navigator.appVersion,p=/\s+UC\s+/i.test(r)||/\s+UC\s+/i.test(r)||/UCWeb/i.test(r)||/UCBrowser/i.test(r)||/UCWeb/i.test(c)||/UCBrowser/i.test(c),l="iphone"==t.os&&r.indexOf("Safari")>0,u=document;if(!l||!window.navigator.standalone)if("index"==n&&"index"==o)if("line"!=a.tab&&"map"!=a.vt){if("ipad"!=t.os&&(p||l)&&!s.get("addestopShow")){u.gE=function(t){return document.getElementById(t)};var g=g||function(){};g.prototype={init:function(){var t=this;t.render(),t.bind()},render:function(){var t=this;t.closebtn=u.gE("adddestop_close_con")},bind:function(){var t=this;t.closebtn.addEventListener("click",t.closeAddestop,!1)},closeAddestop:function(){u.gE("adddesktop-con").style.display="none";var t={domain:location.hostname,path:"/",expires:432e4};s.set("addestopShow",!0,t)}};var h=new g;h.init();var m=u.gE("adddesktop-con-tip"),f=u.gE("adddesktop-con"),w=u.gE("adddesktop-con-star");p&&function(){f.setAttribute("style","top: 10px;"),w.className="ucaddbg adddesktop-con-star"}(),l&&function(){t.isosres=!0,m.setAttribute("style","-webkit-transform: rotate(180deg);left: 82px;top: 75px;");var e=document.documentElement.clientWidth/2-91;f.setAttribute("style","left:"+e+"px;bottom: 10px;"),w.className=t.isios7?"ios7addbg adddesktop-con-star":"iphoneaddbg adddesktop-con-star",u.gE("addestop").innerHTML='再"添加至主屏幕"'}(),d.addStat(STAT_CODE.STAT_ADDDESTOP_SHOW),f.style.display=""}}else $("#adddesktop-con").hide();else $("#adddesktop-con").hide()}}});
;define("index:widget/allcity/allcity.js",function(t,i,e){var c=t("common:widget/setcity/setcity.js");e.exports.init=function(){n()};var n=function(){var t=$(".index-widget-allcity");t.on("click",".select-letter span",a),t.on("click",".city-item",d)},a=function(t){var i=$(t.target),e=i.data("href");window.location.replace(e)},d=function(t){var i=$(t.target),e=$.trim(i.data("city")),n=i.data("cityid"),a=i.data("cityeng");c.setAndRedirect(e,n,a)}});
;define("index:widget/helper/helper.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),stat=require("common:widget/stat/stat.js"),searchData=require("common:static/js/searchdata.js"),locator=require("common:widget/geolocation/location.js");module.exports={cates:{cater:{wd:"美食",id:"cater",count:3,data:void 0},hotel:{wd:"快捷酒店",id:"hotel",count:2,data:void 0},bank:{wd:"银行",id:"bank",data:[{name:"工商银行",key:"icbc"},{name:"农业银行",key:"abc"},{name:"建设银行",key:"cbc"},{name:"中国银行",key:"bc"},{name:"ATM",key:"atm"}]}},thumbConfig:{host:"http://map.baidu.com/maps/services/thumbnails",imgWidth:180,imgHeight:135,oneStarW:15},getData:function(t,e,a){if(1===this.getCityCode())return this.cates[t].data=[],e&&e([]),void 0;a=a||{},this.cates[t].data=void 0,a.page&&"hao123"===a.page&&(this.cates.cater.count=6,this.cates.hotel.count=3);var r=this,o=this.cates[t].wd,i=this.getHash({query:{wd:o}}).query;searchData.fetch(util.jsonToQuery(i),function(a){var i=[];a&&a.content&&(i=r._formatData(o,a.content)),r.cates[t].data=i,e&&e(i)},function(){e&&e([])})},getHash:function(t){var e=t.module||"search",a=t.action||"search",r={qt:"s",wd:"",c:this.getCityCode()},o={};t.query?r=$.extend(r,t.query):(r.wd=t.wd||t.word||t.name,r.searchFlag="sort");var i=url.get(),n=i.query,c=i.pageState||{},s=c.from||"",d=decodeURIComponent(c.center_name||locator.getCity());switch("place"===e&&"takeout"===a&&(o.search="takeout",d=locator.hasExactPoi()?locator.isUserInput()?locator.getAddress():"我的位置":locator.getCity()),s){case"searchnearby":r.center_rank=1,r.nb_x=n.nb_x||c.nb_x,r.nb_y=n.nb_y||c.nb_y,o.from="searchnearby",o.type="searchnearby","place"===e&&"takeout"===a&&(d=decodeURIComponent(c.center_name));break;case"business":r.wd=c.bd+"     "+r.wd,"place"===e&&"takeout"===a&&locator.hasExactPoi()&&(r.center_rank=1,r.nb_x=locator.getPointX(),r.nb_y=locator.getPointY());break;default:locator.hasExactPoi()&&(d=locator.isUserInput()?locator.getAddress():"我的位置",r.center_rank=1,r.nb_x=locator.getPointX(),r.nb_y=locator.getPointY())}return o.center_name=d,"今夜特价"===r.wd&&(r.pl_tonight_sale_flag_section=1,r.pl_data_type="hotel"),{module:e,action:a,query:r,pageState:o}},ready:function(){(this.cates.cater.data||this.cates.hotel.data)&&listener.trigger("nearpush","dataready")},go:function(evt,key){var target=$(evt.currentTarget);switch(target.attr("jsaction")){case key+"-detail":eval("var data = "+target.attr("userdata"));var uid=data.uid;stat.addCookieStat(STAT_CODE.STAT_NEARPUSH_DETAIL_CLICK,{id:data.id}),url.update({module:"place",action:"detail",query:{qt:"inf",uid:uid,c:this.getCityCode()}},{trigger:!0,queryReplace:!0});break;case key+"-all":eval("var data = "+target.attr("userdata"));var word=data.wd||this.cates[key].wd,hash=this.getHash({module:"search",action:"search",query:{wd:word}});stat.addCookieStat(STAT_CODE.STAT_NEARPUSH_ALL_CLICK,{id:data.id}),url.update({module:hash.module,action:hash.action,query:hash.query,pageState:hash.pageState},{trigger:!0,queryReplace:!0,pageStateReplace:!0})}return!1},getCityCode:function(){var t=url.get(),e=(t.query,t.pageState||{});return e.code&&1!=e.code?e.code:locator.getCityCode()||1},_formatData:function(t,e){var a=this;switch(t){case"美食":return a._formatDataCY(e);case"快捷酒店":return a._formatDataHotel(e)}},_formatDataCY:function(t){for(var e=this,a=this.cates.cater.count,r=[],o=[],i=0,n=t.length;n>i;i++){var c={};c.name=t[i].name,c.uid=t[i].uid;var s,d;if(void 0!=t[i].ext&&void 0!=t[i].ext.detail_info&&(s=!0,d=t[i].ext.detail_info),""!=d.image&&s){if(c.image=e._getImgSrc(d.image)||"",""!=d.groupon&&null!=d.groupon?c.otherflag='<em class="icon groupon-icon"></em>':""!=d.premium2&&0!=d.premium2&&null!=d.premium2&&(c.otherflag='<em class="icon sale-icon"></em>'),c.star=e._getStar(d.overall_rating)||"",c.comment=d.comment_num||"",r.push(c),r.length===a)return r}else o.push(c)}return r=r.concat(o.slice(0,a-r.length))},_formatDataHotel:function(t){for(var e=this,a=this.cates.hotel.count,r=[],o=[],i=0,n=t.length;n>i;i++){var c={};c.name=t[i].name,c.uid=t[i].uid,c.addr=t[i].addr;var s,d;if(void 0!=t[i].ext&&void 0!=t[i].ext.detail_info&&(s=!0,d=t[i].ext.detail_info),c.price=d.price||"",""!=t[i].image&&d&&""!=t[i].tel){if(c.image=e._getImgSrc(d.image)||"",c.star=e._getStar(d.overall_rating)||"",c.tel=e._getTel(t[i].tel)||{},d.uid=t[i].uid,c.order=e._getOrder(d),r.push(c),r.length===a)return r;o.push(c)}}return r=r.concat(o.slice(0,a-r.length))},visible:function(t,e,a){var r=$(t)[0],o=function(){var t=r.getBoundingClientRect().top,o=window.innerHeight;o>=t&&e&&(a?e.call(a):e())};o(),$(window).on("scroll",o)},_getTel:function(t){var e,a;return void 0===t||""===t?{}:(e=t.indexOf(",")>-1?t.split(","):t.split(";"),e=e[0].replace(/\(/gi,"").replace(/\)/gi,"-"),a=util.isAndroid()?'href="javascript:void(0);" data-tel="'+e+'"':'href="tel:'+e+'"',{url:a,num:e})},_getOrder:function(t){return 1==parseInt(t.wap_bookable,10)?!0:void 0},_getStar:function(t){if(t){var e=parseInt(10*t)/10*this.thumbConfig.oneStarW,a='<span class="star-box">                            <span class ="star-scroe" style = "width:#rate#px"></span>                    </span>'.replace("#rate#",e);return a}},_getImgSrc:function(t){if("string"!=typeof t||""===t)return F.uri("/static/img/no_img.png");var e=this.thumbConfig;t.indexOf("&nbsp;&nbsp;&nbsp;")>-1&&(t=$.trim(t.split("&nbsp;&nbsp;&nbsp;")[0])),t=t.replace("(","%28"),t=t.replace(")","%29");var a=e.host+"?width="+e.imgWidth+"&height="+e.imgHeight+"&src="+encodeURIComponent(t);return a}}});
;define("index:widget/bizarea/bizarea.js",function(require,exports,module){var util=require("common:static/js/util.js"),searchData=require("common:static/js/searchdata.js"),locator=require("common:widget/geolocation/location.js"),helper=require("index:widget/helper/helper.js");module.exports={hasGetData:!1,curRenderCity:"",init:function(e){this.wrap=$(".index-widget-bizarea"),e?(this.curRenderCity=locator.getCityCode(),this.wrap.show()):1!=locator.getCityCode()&&this._render(),this._bindGeoEvent()},_render:function(){helper.visible(this.wrap,function(){this.render()},this)},_bindGeoEvent:function(){listener.on("common.geolocation","success",this.render,this)},render:function(){if(!this.hasGetData||this.curRenderCity!=locator.getCityCode()&&1!=locator.getCityCode()){this.hasGetData=!0,this.curRenderCity=locator.getCityCode();var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.area&&data.area.length>0){_template_fun_array.push('    <h2>热门商区</h2>    <ul class="clearfix biz-list">            ');for(var i=0,l=data.area.length;l>i;i++){var item=data.area[i];_template_fun_array.push('                <li>                    <a href="/mobile/webapp/index/casuallook/foo=bar/from=business&bd=',"undefined"==typeof item?"":item,"&code=","undefined"==typeof data.code?"":data.code,'" jsaction="jump" user-data="item">',"undefined"==typeof item?"":item,"</a>                </li>            ")}_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],_this=this,host="/mobile/webapp/index/index/?",param={async:"1",fn:"gethotarea",mmaptype:"simple",cityname:locator.getCity()},requestUrl=host+util.jsonToUrl(param);$.ajax({url:requestUrl,dataType:"jsonp",success:function(e){try{var t=e;t&&t.data&&t.data.area?(_this.wrap.show(),_this.wrap.html(tpl({data:t.data}))):_this.error()}catch(a){_this.error()}},error:function(){_this.error()}})}},error:function(){this.wrap.hide()}}});
;define("index:widget/businesslist/businesslist.js",function(require,exports,module){var url=require("common:widget/url/url.js"),util=require("common:static/js/util.js"),searchData=require("common:static/js/searchdata.js"),_dataCache,_areaList={},cityData,BUSINESS_SPLIT="     ",dataPath="/mobile/?&from=maponline&tn=m01&ie=utf-8&data_version=11252019",saveData=function(e){e&&(addAreaItem(e.area_code,e),2==e.area_type&&(cityData=e),e.sub&&$.each(e.sub,function(e,a){addAreaItem(a.area_code,a)}))},addAreaItem=function(e,a){a&&e&&(_areaList[e]=a)},getAreaItem=function(e){return _areaList[e]},bind=function(){var e=$(".index-widget-bussinesslist");e.on("click",".top-title",toggleList),e.on("click","[jsaction]",eventHandler)},completeSelete=function(e){if(e){var a,t=getAreaItem(e),i=url.get(),s=(i.query||{},i.pageState||{}),n="",l="",r={},o={},d=n.wd;try{n=util.urlToJSON(s.refer_query)||{},l=util.urlToJSON(s.refer_pagestate)||{}}catch(u){}r=$.extend({},r,l,{dist_name:t.area_name,keep_stay:1}),d&&d.indexOf(BUSINESS_SPLIT)>-1&&(d=d.split(BUSINESS_SPLIT)[1]),10==t.area_type?(d=t.area_name+BUSINESS_SPLIT+d,a=cityData.area_code):a=t.area_code,o=$.extend(o,n,{c:a,wd:d,pn:0}),delete o.nb_x,delete o.nb_y,delete o.center_rank,url.update({module:"place",action:"list",query:o,pageState:r})}},listSub=function(e,a){if(e&&a){var t=(a.data("loaded"),"/?qt=sub_area_list&level=1&business_flag=1"),i=a.next();1==a.data("loaded")?i.hasClass("hide")?(i.data("visible","1"),hideOther(),scrollToEle(a)):hideOther():(t+="&areacode="+e,searchData.fetch(t,function(e){var t=e.content;hideOther(),t&&(saveData(t),appendSubList(t,a))},function(){}))}},scrollToEle=function(e){if(e){var a=e.offset().top;window.scrollTo(0,a)}},hideOther=function(){$(".index-widget-bussinesslist .sub_list .sub_list").not("hide").each(function(e,a){1==$(a).data("visible")?$(a).removeClass("hide"):$(a).addClass("hide"),$(a).data("visible","0")})},appendSubList=function(data,ele){var tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push('<li class="sub_list"><ul class="sub_wrapper"><li data-areacode = "',"undefined"==typeof area_code?"":area_code,'" jsaction="complete"><h4>全区</h4><span class="rl_opt"><em class="rl_opt_btn rl_opt_close"></em></span>               </li>');for(var i=0,l=sub.length;l>i;i++)_template_fun_array.push('<li data-areacode = "',"undefined"==typeof sub[i].area_code?"":sub[i].area_code,'" jsaction="complete"><h4>',"undefined"==typeof sub[i].area_name?"":sub[i].area_name,'</h4><span class="rl_opt"><em class="rl_opt_btn rl_opt_close"></em></span>               </li>');_template_fun_array.push("</ul></li>"),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0],html=tpl(data);$(html).insertAfter(ele),ele.data("loaded","1"),ele.data("visible","1"),scrollToEle(ele)},switchToList=function(e){var a,t,i,s,n=this;a=n.get("pagestate"),t={},s={};try{t=JSON.parse(a.refer_query),s=JSON.parse(a.refer_pagestate)}catch(l){}s=$.extend(s,{dist_name:e.isBusiness?"":e.name,keep_stay:1});var r=t.wd.split(mapConst.BUSINESS_SPLIT);r=r[1]?r[1]:t.wd,i={wd:e.isBusiness?e.name+"     "+r:r,c:e.isBusiness?e.cityCode:e.subCode,pn:0},$.extend(t,i),app.updateHash({module:"place",action:"list",query:t,pageState:s},{trigger:!0,queryReplace:!0,pageStateReplace:!0})},toggleList=function(){var e=$(this);e.next().toggleClass("hide")},eventHandler=function(){var e=$(this),a=e.data("areacode"),t=e.attr("jsaction"),i={complete:completeSelete,listsub:listSub},s=i[t];$.isFunction(s)&&s(a,e)};module.exports.init=function(e){saveData(e),bind()}});
;define("index:widget/bussinesslist/bussinesslist.js",function(){});
;define("index:widget/cateinfo/cateinfo.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),helper=require("index:widget/helper/helper.js"),stat=require("common:widget/stat/stat.js");module.exports={init:function(){this.bind()},bind:function(){var e=this;$(".index-widget-cateinfo [jsaction]").on("click",function(t){var a=$(t.currentTarget);e.search(a.attr("userdata"))})},search:function(userdata){eval("var hash = "+userdata),stat.addCookieStat(STAT_CODE.STAT_CATEINFO_CLICK,{cate:hash.cate,name:hash.wd}),url.update(helper.getHash(hash))}}});
;define("index:widget/curloc/curloc.js",function(o,t,c){var i=o("common:widget/geolocation/location.js");c.exports.init=function(){var o=i.getLocation();o&&"ip"!==o.type?n(o):listener.on("common.geolocation","success",n,this)};var n=function(){var o=$(".widget-index-curloc .current-city"),t=i.getAddress();o.html(t)}});
;define("index:widget/error/error.js",function(e,o,t){var r=e("common:widget/url/url.js"),n="_lastPageUrl",a=function(){$(".back-last-page").on("click",function(){i()})},i=function(){var e=window.localStorage.getItem(n);"string"==typeof e?(window.localStorage.removeItem(n),r.navigate(e,{replace:!0,storageKey:!1})):history.back()};t.exports.init=a});
;define("index:widget/helper/maphelper.js",function(e,n,t){{var o=e("common:widget/map/map.js"),i=(e("common:static/js/mapconst.js"),e("common:widget/geolocation/location.js"));e("common:widget/url/url.js")}t.exports={init:function(e,n){this.saveLocation(n),o.clearOverlays(),o._centerAndZoom(),this.openInfoWindow()},openInfoWindow:function(){setTimeout(function(){var e=(window._APP_HASH,o.iwController.get());i.isUserInput()||(o.isMyCenter()?e&&o.openGeoIw():e&&e.hide())},100)},saveLocation:function(e){if(e){var n,t,o,c,s=this;t=26===e.result.type?!0:!1,c=t?e.current_city:e.content,point=t?e.content[0].split(","):s.getPoint(c),o=t?e.content[1]:c.level,o=0!==o?o:4,n={addr:{city:t?c.name:c.pcname?c.pcname:c.cname,address:t?c.name:c.pcname?c.pcname+c.cname:c.cname,cityCode:c.pccode?c.pccode:c.code,cityType:e.current_city.type},point:{x:point[0],y:point[1]},isExactPoi:!1,level:o,isGeoSuc:!0},i.setAddress(n)}},getPoint:function(e){return e.geo.split(";")[1].split("|")[0].split(",")}}});
;define("index:widget/helper/revert.js",function(e,n,r){r.exports={init:function(){window.eventRecorder&&(eventRecorder.stop(),eventRecorder.play(),window.eventRecorder=null,delete window.eventRecorder)}}});
;define("index:widget/historycity/historycity.js",function(t,i,n){"use strict";var e=t("common:widget/setcity/setcity.js");n.exports={init:function(){this.render(),this.bind()},render:function(){var t=$(".history-content"),i=this._localStorage();if(void 0!==i&&""!==i){$(".index-widget-historycity").show(),i=i.split(encodeURIComponent(","));for(var n=$('<ul class="historycity-list"></ul>'),e=0;e<i.length;e++){var o=i[e].split("-"),a=o[0],c=o[1],r=o[2],l=$('<span class="historycity-item"></span>');l.attr("data-cityid",c),l.attr("data-city",a),l.attr("data-cityeng",r);var s=$("<li ></li>");if(l.html(a),s.append(l),n.append(s),e==i.length-1){var d=$("<br style='clear:both'>");n.append(d)}}t.append(n)}},bind:function(){{var t=this;$(".index-widget-allcity")}$(".historycity-item").on("click",t._onClickCity),$(".history-clean").on("click",$.proxy(this._onCleanHistory,this))},_onCleanHistory:function(){this._localStorage(null),$(".index-widget-historycity").hide()},_onClickCity:function(t){var i=$(t.target),n=$.trim(i.data("city")),o=i.data("cityid"),a=i.data("cityeng");e.setAndRedirect(n,o,a)},_localStorage:function(t){var i,n,e,o,a="historyCity";try{if(null===t)window.localStorage[a]="";else if(void 0!==t){n=window.localStorage[a],e=n?n.split(encodeURIComponent(",")):[];var c=t.cityName+"-"+t.cityId+"-"+t.cityeng;~$.inArray(c,e)&&(o=e.indexOf(c),e.splice(o,1)),e.unshift(c),e.length>5&&e.splice(5,1),window.localStorage[a]=e.join(encodeURIComponent(","))}i=window.localStorage[a]}catch(r){}return i}}});
;define("index:widget/hotcity/hotcity.js",function(t,i,e){var c=t("common:widget/setcity/setcity.js");e.exports.init=function(){n()};var n=function(){var t=$(".index-widget-hotcity");t.on("click",".city-item",d)},d=function(t){var i=$(t.target),e=i.text(),n=i.data("cityid"),d=i.data("cityeng");c.setAndRedirect(e,n,d)}});
;define("index:widget/locsearch/locsearch.js",function(e,t,a){var r,n=e("common:widget/geolocation/location.js"),o=e("common:widget/url/url.js"),i="输入城市或者其他位置";a.exports.init=function(){r=$(".index-widget-locsearch"),c()};var c=function(){var e=$("#search-input"),t=r.find("#search-button"),a=r.find("form");e.on("focus",$.proxy(u,this)),e.on("blur",l),e.on("foucs",u),t.on("click",f),a.on("submit",f)},u=function(e){var t=$(e.target);t.val()===i&&(t.val(""),t.removeClass("ipt"))},l=function(e){var t=$(e.target);""===$.trim(t.val())&&(t.val(i),t.addClass("ipt"))},s=function(e){var t={qt:"s",wd:$.trim(e),c:n.getCityCode()};return t},f=function(e){var t=$("#search-input"),a=t.val(),r=s(a),n=o.get().pageState||{};o.update({module:"place",action:"selectpoint",query:r,pageState:{refer_pagestate:n.refer_pagestate,refer_query:n.refer_query}},{queryReplace:!0,pageStateReplace:!0}),e.preventDefault()}});
;define("index:widget/morecategory/morecategory.js",function(e,t,n){MY_GEO="我的位置";var r=e("common:widget/geolocation/location.js"),i=e("common:static/js/util.js"),a=e("common:widget/url/url.js");n.exports={init:function(){this.render(),this.bind(),this.initSize()},render:function(){this.parentele=$(".categoryparent"),this.morecategory=$("#more-category"),this.childele=$(".sublist li")},bind:function(){var e=this;e.parentele.on("click",$.proxy(e._redirect,this)),e._setCenterName(),e.childele.on("click",$.proxy(e._redirect,this))},_redirect:function(e){var t=this.getUrl($(e.target).text());a.update(t,{queryReplace:!0,pageStateReplace:!0})},_handleClickEvent:function(e){{var t=this;e.target}t.toggleClickedLiIcon(e)},_setCenterName:function(){var e=a.get(),t=e.pageState||{},n=e.query||{},i=(n.wd||"").split("     ");return"更多"===i[1]?(this.centerName=i[0],this.centerName):t.center_name?decodeURIComponent(t.center_name):r.hasExactPoi()?MY_GEO:r.getCity()},toggleClickedLiIcon:function(e){var t=this,n=$(e.target).parent();childli=n.next(".rl_sub_list"),"none"==childli.css("display")?(n.find("em").removeClass("rl_opt_close"),n.find("em").addClass("rl_opt_open"),$(".rl_sub_list").hide(),childli.show()):(n.find("em").removeClass("rl_opt_open"),n.find("em").addClass("rl_opt_close"),childli.hide()),t.currentLi=t.getCurrentLi(e.target),t._scrollToCurrentCategory()},_scrollToCurrentCategory:function(){var e=this,t=$(e.currentLi).offset();window.scroll(0,t.top)},getCurrentLi:function(e){var t=e;if("LI"!==t.nodeName)for(;null!=e.parentNode;){if("LI"===e.parentNode.nodeName){t=e.parentNode;break}e=e.parentNode}return t},getUrl:function(e){var t={module:"search",action:"search",query:{qt:"s",wd:this.centerName?e+" "+this.centerName:e,searchFlag:"more_cate",c:r.getCityCode()||1},pageState:{}};return t=this.setCenterPoi(t),this.centerName&&(delete t.query.nb_x,delete t.query.nb_y,delete t.query.center_rank,delete t.pageState.center_name),t},setCenterPoi:function(e){var t=e||{};t.query=t.query||{},t.pageState=t.pageState||{};var n=a.get(),i=n.pageState||{},o=n.query||{};return i&&"searchnearby"==i.type||i&&"searchnearby"==i.from?(t.query.center_rank=1,t.query.nb_x=o.nb_x,t.query.nb_y=o.nb_y,t.pageState.center_name=i.center_name,t):(r.hasExactPoi()&&(t.query.center_rank=1,t.query.nb_x=r.getPointX(),t.query.nb_y=r.getPointY(),t.pageState.center_name=r.isUserInput()?r.getAddress():"我的位置"),t)},initSize:function(){i.isAndroid()&&($("#cateinfo-canyin .back-icon").css("margin-top","43px"),$("#cateinfo-hotel .back-icon").css("margin-top","97px"),$("#cateinfo-ent .back-icon").css("margin-top","45px"),$("#cateinfo-trf .back-icon").css("margin-top","44px"),$("#cateinfo-service .back-icon").css("margin-top","45px"))}}});
;define("index:widget/navebox/navebox.js",function(e,t,a){var n=e("common:widget/url/url.js");a.exports={init:function(){this.bind()},bind:function(){$(".index-widget-navebox [jsaction]").on("click",$.proxy(this.go,this))},go:function(e){var t=$(e.currentTarget);switch(t.attr("jsaction")){case"toNearBySearch":n.update({module:"index",action:"index",query:{foo:"bar"},pageState:{vt:""}},{queryReplace:!0,pageStateReplace:!0});break;case"toMapSearch":n.update({module:"index",action:"index",query:{foo:"bar"},pageState:{vt:"map"}},{queryReplace:!0,pageStateReplace:!0})}return!1}}});
;define("index:widget/navethumbnail/navethumbnail.js",function(t,e,i){var n=t("common:static/js/util.js"),a=(t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),o=t("common:static/js/searchdata.js"),s=t("common:widget/stat/stat.js"),r={type:"0,2",level:16,height:101,width:window.innerWidth-22,url:null,host:"http://snap.map.baidu.com/?qt=snap&data="},c=window._CURRENT_CITY,h=c.name;n.showLoading($("#poipic-area")),i.exports={init:function(){this.render(),this.bind()},render:function(){this.thumbImage=$("#mapimg"),this.errorCnt=$(".error-cnt"),this.thumbImageA=$("#right-a"),this.subwayBtn=$("#subwayBtn"),this.cityNameCnt=$("#cityNameCnt"),this.nearbus=$("#nb-bus"),this.nearbusspan=$("#busspan"),this.nearsubway=$("#nb-subway"),this.nearsubwayspan=$("#stationspan"),this.imgcon=$("#route-pic")},bind:function(){var t=this;listener.on("common.geolocation","mylocsuc",function(){t.setLocation()},this),listener.on("common.geolocation","fail",function(){t.thumbImageA.hide(),t.errorCnt.show()},this),listener.on("common","sizechange",function(){t._appReSize()},this),t._trafficsubway()},_trafficsubway:function(){var t=this;if("全国"!=h){t.imgcon.show(),t._setThumbUrl();var e=n.ifSupportSubway(a.getCityCode());if(e){var i=e.split(",");t.subwayBtn.attr("href","/mobile/webapp/subway/show/city="+i[0]+"/ref=index"),t.cityNameCnt.html(i[1]+"市地铁线路图"),t.subwayBtn.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAYBTN_DISPLAY)}else t.subwayBtn.hide()}},_appReSize:function(){var t=this;n.isAndroid()?setTimeout(function(){r.width=window.innerWidth-22},800):r.width=window.innerWidth-22,t._setThumbUrl()},setLocation:function(){var t=this;a.getMyCityCode()==c.code&&t._getNearbyData()},_setThumbUrl:function(){var t=this,e=t._getThumbUrl();t.thumbImage.attr("src",e),n.hideLoading($("#poipic-area"))},_getThumbUrl:function(){r.level=0==r.type?"全国"==a.getCity()?3:a.hasExactPoi()?16:10:10;var t;c?(JSONdata=c.geo,cityPoint=n.geoToPoint(JSONdata),t={x:0,y:0},t.x=cityPoint.lng,t.y=cityPoint.lat):t=a.getCenterPoi();var e={retype:1,src:"webapp",level:r.level,center:t.x+" "+t.y,height:101,width:r.width,coordtype:"M",pictype:r.type};return r.host+JSON.stringify(e)},_getNearbyData:function(){var t=this,e=$.param(t._getQueryByWd("公交站").query),i=$.param(t._getQueryByWd("地铁站").query);o.fetch(e,$.proxy(t._cbGetBusStation,this)),o.fetch(i,$.proxy(t._cbGetSubwayStation,this))},_getQueryByWd:function(t){var e={qt:"s",wd:t,c:a.getMyCityCode()},i={};return e.center_rank=1,e.nb_x=a.getMyPointX(),e.nb_y=a.getMyPointY(),{query:e,pageState:i}},_cbGetBusStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){var i=t.content[0]||"";e.nearbusspan.text(i.name+"-公交站"),e.nearbusspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+i.uid+"&c="+a.getMyCityCode()+"/tab=line"),e.nearbus.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_BUS_DISPLAY)}},_cbGetSubwayStation:function(t){var e=this;if(void 0!=t&&0!=t.content.length){for(var i=void 0,n=0,o=t.content.length;o>n;n++){var r=t.content[n],c=3==r.poiType,h=r.blinfo&&0!=r.blinfo.length;if(c&&h){i=t.content[n];break}}if(void 0!=i){var u=i||"",d=u.name+"-地铁站";e.nearsubwayspan.text(d),e.nearsubwayspan.attr("href","/mobile/webapp/place/detail/qt=inf&uid="+u.uid+"&c="+a.getMyCityCode()+"/tab=line"),e.nearsubway.show(),s.addStat(STAT_CODE.STAT_LINEINDEX_SUBWAY_DISPLAY)}}}}});
;define("index:widget/nbserachbox/nbserachbox.js",function(e,t,r){var n="我的位置",a=e("common:widget/geolocation/location.js"),i=e("common:widget/url/url.js"),s=e("common:widget/stat/stat.js");r.exports={init:function(){this.render(),this.bind()},render:function(){this.searchmorenearby=$("#index-widget-nbserachbox"),this.searchInput=$("#search-input"),this.DEFAULT_VALUE="输入其他分类",this.searchBtn=$("#search-button"),this.searcForm=$("#search-form")},bind:function(){var e=this;e._renderCenterName(),e.searchInput.on("focus",$.proxy(e._clearInput,this)),e.searchInput.on("blur",$.proxy(e._resetInput,this)),e.searcForm.on("submit",$.proxy(e._searchPoint,this)),e.searchBtn.on("click",$.proxy(e._searchPoint,this))},_renderCenterName:function(){var e=this._getCenterName();me=this,me.searchmorenearby.prepend('<p id="search-more-nearby">在 <span class="center-name">'+e+"</span> 附近找</p>")},_getCenterName:function(){var e=i.get(),t=e.pageState||{},r=e.query||{},s=(r.wd||"").split("     ");return"更多"===s[1]?(this.centerName=s[0],this.centerName):t.center_name?t.center_name:a.hasExactPoi()?n:a.getCity()},_clearInput:function(e){var t=this,r=$(e.target);r.val()===t.DEFAULT_VALUE&&(r.val(""),r.removeClass("ipt-default"))},_resetInput:function(e){var t=this,r=$(e.target),n=r.val();""===$.trim(n)&&(r.val(t.DEFAULT_VALUE),r.addClass("ipt-default"))},_searchPoint:function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault();var t=this,r=$("#search-input"),n=r.val();return r.get(0).blur(),t._checkValueValid(n)?(t.search($.trim(n)),!1):void 0},_checkValueValid:function(e){return""!==$.trim(e)&&$.trim(e)!==this.DEFAULT_VALUE?!0:!1},search:function(e){var t=i.get();"more"==t.action&&s.addStat(STAT_CODE.STAT_MORE_CATEGORY_SEARCH_INPUT);var r=this,n=r._getDirParam($.trim(e));i.update({module:"search",action:"search",query:n})},_getDirParam:function(e,t){if(e&&"string"==typeof e){t=t||{};var r={qt:"s",wd:this.centerName?e+" "+this.centerName:e,c:a.getCityCode()||1,searchFlag:t.from||""},n=i.get(),s=n.pageState||{};return s.nb_x&&s.nb_x?(r.nb_x=s.nb_x,r.nb_y=s.nb_y,r.center_rank=1,r.center_name=s.center_name):a.hasExactPoi()&&(r.nb_x=a.getPointX(),r.nb_y=a.getPointY(),r.center_rank=1),r.searchFlag="more_cate",r}}}});
;define("index:widget/nearby/nearby.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),helper=require("index:widget/helper/helper.js"),stat=require("common:widget/stat/stat.js"),locator=require("common:widget/geolocation/location.js");module.exports={init:function(t){this.bind(),this.page=t},bind:function(){var t=this;$(".index-widget-nearby [jsaction]").on("click",function(e){var o=$(e.currentTarget);o.find(".ui3-taxi").length>0?location.href="http://taxi.map.baidu.com":t.search(o)})},search:function(target){if(eval("var hash = "+target.attr("userdata")),stat.addCookieStat(STAT_CODE.STAT_NEARBY_CLICK,{id:hash.id}),"团购"==hash.wd)setTimeout(function(){var t;try{if(locator.hasExactPoi()){var e=locator.getCenterPoi();t="http://mtuan.baidu.com/t/locat?from=map_webapp&x="+e.x+"&y="+e.y+"&to_url="+encodeURIComponent(location.href)}else t="http://mtuan.baidu.com/t/locat?from=map_webapp&to_url="+encodeURIComponent(location.href)}catch(o){t="http://mtuan.baidu.com/t/locat?from=map_webapp&to_url="+encodeURIComponent(location.href)}window.location=t},500);else if("地铁图"==hash.wd){var supportCityInfo=util.ifSupportSubway(locator.getCityCode());if(supportCityInfo){var sarr=supportCityInfo.split(",");target.attr("href","/mobile/webapp/subway/show/city="+sarr[0]+"/ref=index")}else target.attr("href","/mobile/webapp/index/setsubwaycity/force=simple")}else"全景"==hash.wd?target.attr("href","/mobile/webapp/index/sventry/force=simple"):url.update(helper.getHash(hash))}}});
;define("index:widget/nearbytip/nearbytip.js",function(t,e,i){"use strict";i.exports={loadCmsAdConfig:function(t){var e=(new Date).getTime(),i=document.getElementsByTagName("HEAD").item(0),n=document.createElement("script");n.type="text/javascript",n.src="http://map.baidu.com/zt/cms/webapp-movie-tip.js?"+e,n.onload=$.proxy(t,this),i.appendChild(n)},init:function(){this.loadCmsAdConfig(function(){window.movie_tip&&($(".tip-text").text(window.movie_tip),$(".index-widget-nearbytip").show())})}}});
;define("index:widget/nearpush/bank.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),searchData=require("common:static/js/searchdata.js"),locator=require("common:widget/geolocation/location.js"),helper=require("index:widget/helper/helper.js"),id="bank",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <button jsaction="bank-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof wd?"":wd,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">查看全部</button>        <h2>银行</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;l>i;i++)_template_fun_array.push('            <li jsaction="bank-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof data[i].name?"":data[i].name,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <span class="icon ',"undefined"==typeof data[i].key?"":data[i].key,'"></span>                <p>',"undefined"==typeof data[i].name?"":data[i].name,"</p>            </li>        ");_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={init:function(e){this.pagename=e,this.render(),this.bind()},render:function(){$(".index-widget-bank").html(tpl(helper.cates[id]))},bind:function(){$(".index-widget-bank [jsaction]").on("click",this._go)},_go:function(e){helper.go(e,"bank")}}});
;define("index:widget/nearpush/cater.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),stat=require("common:widget/stat/stat.js"),searchData=require("common:static/js/searchdata.js"),locator=require("common:widget/geolocation/location.js"),geolocator=require("common:widget/geolocation/geolocation.js"),helper=require("index:widget/helper/helper.js"),id="cater",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <a href="javascript:void(0);" jsaction="cater-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof word?"":word,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">            查看全部        </a>        <h2>美食</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;3>i;i++)_template_fun_array.push('            <li jsaction="cater-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof data[i].uid?"":data[i].uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <a class="a-img" href="javascript:void(0);">                    <img width="89" height="66" src="',"undefined"==typeof data[i].image?"":data[i].image,'">                    ',"undefined"==typeof data[i].otherflag?"":data[i].otherflag,'                </a>                <dl>                    <dt class="name">',"undefined"==typeof data[i].name?"":data[i].name,'</dt>                    <dd class="rate">',"undefined"==typeof data[i].star?"":data[i].star,'</dd>                    <dd class="cmt">                        <span class="count">',"undefined"==typeof data[i].comment?"":data[i].comment,'</span>                        <span class="tail">条评论</span>                    </dd>                </dl>            </li>        ');if(_template_fun_array.push("    </ul>    "),"hao123"==page){_template_fun_array.push('        <ul class="list">            ');for(var i=3,l=data.length;6>i;i++)_template_fun_array.push('                <li jsaction="cater-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof data[i].uid?"":data[i].uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                    <a class="a-img" href="javascript:void(0);">                        <img width="89" height="66" src="',"undefined"==typeof data[i].image?"":data[i].image,'">                        ',"undefined"==typeof data[i].otherflag?"":data[i].otherflag,'                    </a>                    <dl>                        <dt class="name">',"undefined"==typeof data[i].name?"":data[i].name,'</dt>                        <dd class="rate">',"undefined"==typeof data[i].star?"":data[i].star,'</dd>                        <dd class="cmt">                            <span class="count">',"undefined"==typeof data[i].comment?"":data[i].comment,'</span>                            <span class="tail">条评论</span>                        </dd>                    </dl>                </li>            ');_template_fun_array.push("        </ul>    ")}_template_fun_array.push("")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={hasGetData:!1,firstShow:!1,init:function(a){this.page=a,this.bind()},bind:function(){switch(listener.on("nearpush","dataready",function(){this._render(helper.cates[id].data)},this),this.page){case"business":this._businessAction();break;case"index":this._indexAction();break;default:this._defaultAction()}},_defaultAction:function(){this._bindGeoEvent(),this._fetch()},_businessAction:function(){this._fetch()},_indexAction:function(){helper.visible(".index-widget-cater",function(){this.hasGetData||(this._fetch(),this._bindGeoEvent())},this)},_bindGeoEvent:function(){listener.on("common.geolocation","success",this._fetch,this),listener.on("common.geolocation","fail",function(){},this)},_fetch:function(){{var a=this,e=$(".index-widget-cater");$(".index-page-nearby-hd")}1!=locator.getCityCode()&&(e.css("min-height","160px"),util.showLoading(e)),helper.getData(id,function(){helper.ready()},{page:a.page}),this.hasGetData=!0},_render:function(a){var e=this,t=helper.cates[id].wd,i=$(".index-widget-cater"),d=$(".index-page-nearby-hd");a&&a.length>0?(i.html(tpl({data:a,id:id,word:t,page:e.page})),d.show(),e.firstShow||(stat.addStat(STAT_CODE.STAT_NEARPUSH_SHOW),e.firstShow=!0)):(i.css("min-height","0"),"index"==this.page&&d.hide()),util.hideLoading(i),this._bind()},_bind:function(){$(".index-widget-cater [jsaction]").on("click",this.jump)},jump:function(a){helper.go(a,id)}}});
;define("index:widget/nearpush/hotel.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js"),searchData=require("common:static/js/searchdata.js"),locator=require("common:widget/geolocation/location.js"),geolocator=require("common:widget/geolocation/geolocation.js"),helper=require("index:widget/helper/helper.js"),id="hotel",tpl=[function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(var name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';if(eval(_template_varName),_template_fun_array.push(""),data&&data.length>0){_template_fun_array.push('    <div class="hd">        <a href="javascript:void(0);" jsaction="hotel-all" userdata="{&#39;wd&#39;:&#39;',"undefined"==typeof word?"":word,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">            查看全部        </a>        <h2>酒店</h2>    </div>    <ul class="list">        ');for(var i=0,l=data.length;l>i;i++){_template_fun_array.push("            ");var item=data[i];_template_fun_array.push('            <li jsaction="hotel-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof item.uid?"":item.uid,"&#39;,&#39;id&#39;:&#39;","undefined"==typeof id?"":id,'&#39;}">                <div class="clearfix">                    <a class="a-img" href="javascript:void(0);">                        <img width="89" height="66" src="',"undefined"==typeof item.image?"":item.image,'">                        ',"undefined"==typeof item.otherflag?"":item.otherflag,'                    </a>                    <dl>                        <dt class="name">',"undefined"==typeof item.name?"":item.name,'</dt>                        <dd class="addr">地址：',"undefined"==typeof item.addr?"":item.addr,'</dd>                        <dd class="cmt">                            <span class="rate">',"undefined"==typeof item.star?"":item.star,'</span>                            <span class="price">                                <span class="tail">人均：</span>                                <span class="count">￥',"undefined"==typeof item.price?"":item.price,'</span>                            </span>                        </dd>                    </dl>                </div>                <div class="bar clearfix">                        '),item.tel.num?_template_fun_array.push('                            <div class="btn tel">                                <a class="a-tel" ',"undefined"==typeof item.tel.url?"":item.tel.url,'>                                    <b class="icon tel"></b>',"undefined"==typeof item.tel.num?"":item.tel.num,"                                </a>                            </div>                            "):_template_fun_array.push('                            <div class="btn tel" style="visibility:hidden">                                <a class="a-tel" href="/">                                    <b class="icon tel"></b>000-00000000                                </a>                            </div>                              '),_template_fun_array.push("                    "),item.order&&_template_fun_array.push('                        <div class="btn order"><a href="javascript:void(0);" jsaction="hotel-detail" userdata="{&#39;uid&#39;:&#39;',"undefined"==typeof item.uid?"":item.uid,'&#39;}">预订</a></div>                    '),_template_fun_array.push("                </div>            </li>        ")}_template_fun_array.push("    </ul>")}_template_fun_array.push(""),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")}][0];module.exports={hasGetData:!1,init:function(e){this.page=e,this.bind()},bind:function(){switch(listener.on("nearpush","dataready",function(){this._render(helper.cates[id].data)},this),this.page){case"business":this._businessAction();break;case"index":this._indexAction();break;default:this._defaultAction()}},_defaultAction:function(){this._bindGeoEvent(),this._fetch()},_businessAction:function(){this._fetch()},_indexAction:function(){helper.visible(".index-widget-hotel",function(){this.hasGetData||(this._fetch(),this._bindGeoEvent())},this)},_bindGeoEvent:function(){listener.on("common.geolocation","success",this._fetch,this),listener.on("common.geolocation","fail",function(){},this)},_fetch:function(){var e=this;this.hasGetData=!0,helper.getData(id,function(){helper.ready(id)},{page:e.page})},_render:function(e){var t=this,a=helper.cates[id].wd;e&&e.length>0&&$(".index-widget-hotel").html(tpl({data:e,id:id,word:a,page:t.page})),this._bind()},_bind:function(){$(".index-widget-hotel [jsaction]").on("click",this.jump),$(".index-widget-hotel .a-tel").on("click",function(e){var t=$(e.currentTarget),a=t.attr("data-tel");t&&a&&util.TelBox.showTb(a),e.stopPropagation()})},jump:function(e){helper.go(e,id)}}});
;define("index:widget/searchbox/searchbox.js",function(t,e,o){t("common:static/js/gmu/src/widget/suggestion/suggestion.js"),t("common:static/js/gmu/src/widget/suggestion/renderlist.js"),t("common:static/js/gmu/src/widget/suggestion/quickdelete.js"),t("common:static/js/gmu/src/widget/suggestion/sendrequest.js");var i=(t("common:static/js/util.js"),t("common:widget/url/url.js")),s=(t("common:widget/pagemgr/pagemgr.js"),t("common:widget/geolocation/geolocation.js"),t("common:widget/geolocation/location.js")),n=t("common:widget/search/poisearch.js"),a=t("common:widget/stat/stat.js"),c=t("common:widget/apphistory/apphistory.js");o.exports={init:function(){this.render(),this.bind()},render:function(){window.localStorage&&window.localStorage.input&&(c.isLanding()?localStorage.removeItem("input"):$("#se-input-poi").val(localStorage.input||"")),this._poiSug=new gmu.Suggestion("#se-input-poi",{source:"http://map.baidu.com/su",cbKey:"callback",listCount:6,posAdapt:!1,appendContanier:"#wrapper",historyShare:!0,autoClose:!0,quickdelete:!0,show:function(){this.$wrapper.offset({left:11,top:this.getEl().offset().top+46})}})},bind:function(){$(".se-form").on("submit",$.proxy(this.submit,this)),$(".se-btn").on("click",$.proxy(this.submit,this)),$(".se-input-poi").on("blur",function(){$(".se-city").show()}),$(".se-input-poi").on("focus",function(){$(".se-city").hide()}),listener.on("common.geolocation","success",this.updateMyPos,this),$(".index-widget-searchbox [jsaction]").on("click",$.proxy(this.go,this)),listener.on("common.page","switchstart",function(){$(".ui-suggestion").length&&$(".ui-suggestion").hide()})},go:function(t){var e=$(t.currentTarget);switch(e.attr("jsaction")){case"toNavSearch":var o={qt:"cur",wd:s.getCity()||"全国",from:"maponline",tn:"m01","ie=utf-8":"utf-8"};window.localStorage&&(localStorage.input=$("#se-input-poi").val()),i.update({query:o,pageState:{tab:"line"}},{queryReplace:!0,pageStateReplace:!0});break;case"toNearBySearch":i.update({module:"index",action:"index",query:{foo:"bar"},pageState:{vt:""}},{queryReplace:!0,pageStateReplace:!0});break;case"toMapSearch":i.update({pageState:{vt:"map"}},{pageStateReplace:!0})}return!1},submit:function(t){var e=$(".se-input-poi");if(!this._checkInput(e))return!1;if(t){var o=$(t.currentTarget),i=o.attr("user-data");"se-btn"==i&&this._poiSug&&this._poiSug.history(e.val())}return e.blur(),a.addCookieStat(STAT_CODE.STAT_POI_SEARCH),n.search(e.val()),!1},updateMyPos:function(t){t=t?t:s.getLocation(),t.addr&&t.addr.city&&$(".se-city-wd").text(t.addr.city)},_checkInput:function(t){return t?/\S+/.test(t.val())?!0:(t.focus(),!1):!1}}});
;define("index:widget/surface/surface.js",function(n,i,t){t.exports={init:function(){this.bind()},bind:function(){$(".close").on("click",function(){$(".return-wap").hide(),$(".common-widget-back-top").css("bottom","0")})}}});
;define("index:widget/sventry/sventry.js",function(require,exports,module){var util=require("common:static/js/util.js"),url=require("common:widget/url/url.js");module.exports.init=function(){bind()};var bind=function(){$(".index-widget-sventry .city-item").on("click",function(){_onClickCity($(this))})},_onClickCity=function(elem){var dataStr=elem.attr("data");eval("var dataObj = "+dataStr),window.egg=dataObj,url.update({module:"index",action:"streetview",query:{ss_id:dataObj.sid,ss_heading:dataObj.heading,ss_pitch:dataObj.pitch}},{queryReplace:!0})},_getSvUrl=function(e){var i="/mobile/webapp/index/streetview/ss_id=";return window.egg=e,i+=e.sid+"&ss_heading="+e.heading+"&ss_pitch="+e.pitch}});
;define("index:widget/tabgroup/tabgroup.js",function(e,t,a){var o=(e("common:static/js/util.js"),e("common:widget/url/url.js")),i=(e("common:widget/geolocation/geolocation.js"),e("common:widget/map/preloader/preloader.js")),n=e("common:widget/geolocation/location.js");a.exports={init:function(){this.bind()},bind:function(){$(".index-widget-tabgroup [jsaction]").on("click",$.proxy(this.go,this))},go:function(e){var t=$(e.currentTarget);switch(t.attr("jsaction")){case"toNavSearch":var a={qt:"cur",wd:n.getCity()||"全国",from:"maponline",tn:"m01","ie=utf-8":"utf-8"};window.localStorage&&(localStorage.input=$("#se-input-poi").val()),o.update({query:a,pageState:{tab:"line"}},{queryReplace:!0,pageStateReplace:!0});break;case"toNearBySearch":o.update({module:"index",action:"index",query:{foo:"bar"},pageState:{tab:"place"}},{queryReplace:!0,pageStateReplace:!0});break;case"tomap":i.loadTiles("mapclick"),o.update({pageState:{vt:"map"}},{pageStateReplace:!0})}return!1}}});
;define("index:widget/thumbnail/thumbnail.js",function(t,i,e){var s=t("common:static/js/util.js"),o=(t("common:widget/url/url.js"),t("common:widget/popup/popup.js")),n=t("common:widget/geolocation/location.js"),a=t("common:widget/stat/stat.js"),h=t("index:widget/historycity/historycity.js"),r={type:0,level:16,height:101,width:window.innerWidth-22,url:null,host:"http://snap.map.baidu.com/?qt=snap&data="};e.exports={flag:{appreszie:!1,wait:void 0},TIMEOUT:8e3,state:"start",init:function(){this.prevPoint=void 0,this.render(),this.bind()},render:function(){this.thumbImg=$(".thumb-img"),this.thumbWrap=$(".thumb-wrap"),this.locbarTxt=$(".locbar-txt"),this.centerMarker=$(".center-marker"),this.geoBtn=$(".thumb-left"),this.inBtn=$(".in-btn"),this.errorCnt=$(".error-cnt"),this.thumbLink=$(".thumb-link"),this.setState("start")},bind:function(){var t=this;t.geoBtn.on("click",function(i){a.addStat(STAT_CODE.STAT_THUNB_START_GEO),t.startGeo(),i.stopImmediatePropagation(),i.stopPropagation()}),t.thumbImg.on("load",function(){t.errorCnt.hide(),t.thumbImg.show(),t.geoBtn.show(),t.hideLoading()}),t.thumbImg.on("error",function(){t.errorCnt.show(),t.thumbImg.hide(),t.centerMarker.hide(),t.hideLoading()}),listener.on("common.geolocation","success",function(){this.successCBK()},this),listener.on("common.geolocation","fail",function(){this.failCBK()},this)},successCBK:function(){this.flag.appreszie||(listener.on("common","sizechange",function(){this._appReSize()},this),this.flag.appreszie=!0);var t={cityName:n.getCity(),cityId:n.getCityCode(),cityeng:""};h._localStorage(t),this.setState("success")},failCBK:function(){this.setState("fail")},setState:function(t){switch(this.flag.state=t,this.addStateToLog(t),t){case"start":this.state="start",this.showLoading(),this._startLoc(),this.waitForLoc(8);break;case"success":this.state="success",this.hideLoading(),this.setLocation(),this.flag.wait&&window.clearTimeout(this.flag.wait);break;case"fail":this.state="fail",this.hideLoading(),this.centerMarker.hide(),o.open({text:"无法获取您的精确定位，请开启浏览器定位功能，刷新页面并选择允许定位"}),this.setLocation(),this.flag.wait&&window.clearTimeout(this.flag.wait)}},addStateToLog:function(t){if("success"===t||"fail"===t){var i={code:STAT_CODE.STAT_THUMB_IMG_CLICK,state:t};this.thumbLink.data("log",JSON.stringify(i))}},startGeo:function(){this.setState("start"),n.startGeo()},_startLoc:function(){var t=n.getLocation();t&&"ip"!==t.type?this.successCBK():this.waitForLoc()},waitForLoc:function(){var t=this;t.flag.wait&&window.clearTimeout(t.flag.wait),t.flag.wait=window.setTimeout(function(){"success"!=t.state&&t.failCBK()},this.TIMEOUT)},setLocation:function(){var t=n.getCenterPoi();this._unEqualPoint(t)?(this.prevPoint=t,this._setThumbUrl()):void 0!=this.prevPoint&&this.hideLoading(),this._setLocBarAddress(),this._setGeoBtnStatus(),this._setSearchBoxCity()},showLoading:function(){s.showLoading(this.thumbWrap),this.locbarTxt.html("正在定位您的位置...")},hideLoading:function(){s.hideLoading(this.thumbWrap)},_setLocBarAddress:function(t){var i=t||n.getAddress();this.locbarTxt.html(i)},_setSearchBoxCity:function(t){var t=t||n.getCity();$(".se-city-wd").html(t)},_setGeoBtnStatus:function(){n.hasExactPoi()?this.geoBtn.removeClass("geo-fail"):this.geoBtn.addClass("geo-fail")},_setThumbUrl:function(t){var i=this,e=t||i._getThumbUrl();n.hasExactPoi()?i.centerMarker.show():i.centerMarker.hide(),i.thumbImg.attr("src",e)},_appReSize:function(){var t=this;s.isAndroid()?setTimeout(function(){r.width=window.innerWidth-22},800):r.width=window.innerWidth-22,t._setThumbUrl()},_equalPoint:function(t){return this.prevPoint&&this.prevPoint.x==t.x&&this.prevPoint.y==t.y},_unEqualPoint:function(t){return void 0==this.prevPoint||t.x!=this.prevPoint.x||t.y!=this.prevPoint.y},_getThumbUrl:function(t){r.level=0==r.type?"全国"==n.getCity()?3:n.hasExactPoi()?16:10:10,void 0==t&&(t=n.getCenterPoi());var i={retype:1,src:"webapp",level:r.level,center:t.x+" "+t.y,height:101,width:r.width,coordtype:"M",pictype:r.type};return r.host+JSON.stringify(i)}}});
;define("index:widget/waitforloc/waitforloc.js",function(t,e,n){var i=t("common:widget/geolocation/geolocation.js"),a=t("common:widget/url/url.js"),o=t("common:widget/geolocation/location.js");n.exports={config:{lineQtMap:{bt:"bse"},qtMap:{place:"s|con|nb|bd",transit:"bt|bse",drive:"nav|nse",walk:"walk|wse"}},init:function(){this.initIpGeo(),this.bindEvent(),this.initGeo()},initIpGeo:function(){try{var t=window.localStorage;window._DEFAULT_CITY.index?(t.setItem("_DEFAULT_CITY",JSON.stringify(window._DEFAULT_CITY)),cookie.set("DEFAULT_CITY","1",{expires:3e5,domain:"baidu.com",path:"/"})):window._DEFAULT_CITY=JSON.parse(t.getItem("_DEFAULT_CITY"))||{}}catch(e){}var n,i,a,r,c;n=JSON.parse(_DEFAULT_CITY.index)||{},i=n&&n.content,a=i&&i.geo,c=i.level,r=a.split(";")[1].split("|")[0].split(","),1==i.code&&(i.name="全国"),locationData={addr:{city:i.cname,cityCode:i.code},point:{x:r[0],y:r[1]},level:c,type:"ip",isExactPoi:!1,isGeoEnd:!1},o.setAddress(locationData)},bindEvent:function(){var t=this;listener.on("common.geolocation","success",function(){t.geoSuccess()}),listener.on("common.geolocation","fail",function(){t.geoFail()})},initGeo:function(){var t=this;i.init(),setTimeout(function(){t.geoFail()},8e3)},geoSuccess:function(){var t=a.get();this._initMixLocOptionsPage(t)},geoFail:function(){var t=a.get();this.locErrorCallback(t)},_initMixLocOptionsPage:function(t){{var e=this,n=t.pageState&&t.pageState.needloc;t.query}n&&"1"===n?e._initPlacePage(t):e._initTransitPage(t)},_initTransitPage:function(t){var e="我的位置",n=t.query||{},i=n.sn||"",r=n.en||"",c=n,s="sn",d=""+i.split("$$")[3],g=""+r.split("$$")[3],l="1$$$$"+o.getPointX()+","+o.getPointY()+"$$我的位置$$",h=c.wd?c.wd:d!=e?d:g;d===e||g===e?g===e&&(s="en"):s=""===$.trim(d)?"sn":"en",c[s]=l,c=$.extend(c,{ptx:o.getPointX(),pty:o.getPointY(),bsetp:1,ec:o.getCityCode(),sc:o.getCityCode(),isSingle:"true",name:e,wd:h}),c.qt=this.config.lineQtMap[c.qt]||c.qt,a.update({module:"search",action:"search",query:c,pageState:{has_handle_geo:1,needloc:""}},{trigger:!0,replace:!0})},getSearchTypeConfig:function(){var t=this.config.qtMap,e={};return $.each(t,function(t,n){_qt=n.split("|"),$.each(_qt,function(n,i){e[i]=t})}),e},_initPlacePage:function(t){{var e=this,n={center_rank:1,nb_x:o.getPointX(),nb_y:o.getPointY(),c:o.getCityCode()};e._getOptions(t,n)}a.update({module:"search",action:"search",query:{center_rank:n.center_rank,nb_x:n.nb_x,nb_y:n.nb_y,c:n.c},pageState:{center_name:"我的位置",has_handle_geo:1,needloc:""}},{replace:!0})},_getOptions:function(t,e){for(var n in e)t.query[n]=e[n];return t},_initPage:function(){this._searchData()},locErrorCallback:function(t){var e=this.getSearchType(t);switch(e){case"place":this._initPage(t);break;case"walk":case"transit":case"drive":this.setSearchBoxValue(t);default:this._switchToIndex(t)}},getSearchType:function(t){if(t){var e=t.query||{},n=e.qt,i=this.searchTypeConfig||this.getSearchTypeConfig();return this.searchTypeConfig=i,i[n]}},setSearchBoxValue:function(t){var e=this._getStartAndEndWord(t)||{},n="我的位置";e.start&&e.start!=n&&(this.start="word="+encodeURIComponent(e.start)),e.end&&e.end!=n&&(this.end="word="+encodeURIComponent(e.end))},_getUrl:function(){var t=a.get().query||{};return this.isLanding&&(third_party=location.href.match(/[\?\&]third_party=([^&^#]+)/),third_party&&(t.searchFlag=third_party[1]||"","baidukuangpush"===third_party[1]&&(t.tg="push"))),t.c||(t.c=o.getCityCode()),["nav","nse","walk","wse"].indexOf(t.qt)>=0&&(t.version="3"),("nav"==t.qt||"bt"==t.qt)&&(t.wd1&&!t.sn&&(t.sn="2$$$$$$"+t.wd1+"$$"),t.wd2&&!t.en&&(t.en="2$$$$$$"+t.wd2+"$$")),t},_searchData:function(){var t=this._getUrl();a.update({module:"search",action:"search",query:t,pageState:{needloc:""}},{replace:!0,queryReplace:!0})},_switchToIndex:function(t){var e=this.getSearchType(t),n=t.pagestate||{},i=t.query||{},o="";n.tab=e,("walk"===n.tab||"drive"===n.tab||"transit"===n.tab)&&(o="line");var r={};this.start&&(r.start=this.start),this.end&&(r.end=this.end),r.tab=o,a.update({module:"index",action:"index",query:i,pageState:r},{trigger:!0,replace:!0,queryReplace:!0,pageStateReplace:!0})},_getStartAndEndWord:function(t){if(t&&t.query){var e=t.query,n=e.sn||"",i=e.en||"",a=n.split("$$")[3]||e.name||"",o=i.split("$$")[3]||e.wd||"";return{start:a,end:o}}}}});