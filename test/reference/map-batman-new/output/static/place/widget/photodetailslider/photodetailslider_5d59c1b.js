define("place:widget/photodetailslider/photodetailslider.js",function(e,i,t){t.exports={config:{iService:"",iServiceTpl:"height=$h$&width=$w$&quality=70&src=$src$"},$el:null,photos:[],area:null,frowWhere:null,cIndex:null,imgs:null,init:function(e){"use strict";var i=this,t=Number(e.get.idx);i.$el=$("#photoslider"),i.photos=e.photos,i.area=i.$el.find("#img-area"),i.imgs=i.area.find("img"),i.frowWhere=i.$el.find(".fromwhere"),i.cIndex=i.$el.find(".currentidx"),i.config.iService=e.thumbnailURL+i.config.iServiceTpl,i.resize(),i.bindEvent(),i.displaySlider(t)},displaySlider:function(e){"use strict";var i=this;i._setInfo(e),$("#photos-detail .place-loading").remove(),i.area.slider({index:Number(e)}).on("slideend",$.proxy(i._slide,i))},_slide:function(e,i){"use strict";var t=this;t._setInfo(i)},_setInfo:function(e){"use strict";var i=this,e=Number(e);i.frowWhere.html(i.photos[e].cn_name),i.cIndex.html(e+1)},_setImgs:function(e){"use strict";var i=this,t=i._getDim(),r=[],n=e.photos;for(var s in n)r.push({pic:i._getPic(n[s],t)});return r},_getPic:function(e,i){"use strict";return this.config.iService.replace("$h$",i.sHeight).replace("$w$",i.sWidth).replace("$src$",encodeURIComponent(e.imgUrl))},bindEvent:function(){"use strict";var e=this;e.onImgLoading().onResize().stop},unbindEvent:function(){"use strict";var e=this;e.offImgLoading().offResize()},_getDim:function(){"use strict";var e=this.getClientSize(),i=this.getSliderOffset(),t=(e.width-46)/3,r=.75*t,n=.9*e.width,s=e.height-i.top-40,o=e.height-i.top;return{pHeight:o,tWidth:Math.floor(t),tHeight:Math.floor(r),sWidth:Math.floor(n),sHeight:Math.floor(s),cs:e}},getClientSize:function(){"use strict";var e=window;return{width:e.innerWidth,height:e.innerHeight}},getSliderOffset:function(){"use strict";var e=this;return e.$el.offset()},resize:function(){"use strict";var e=this,i=e._getDim();e.$el.css({height:i.pHeight}),e.area.css({height:i.sHeight})},onResize:function(){"use strict";var e=this;return!e._resizeFun&&$(window).on("resize orientationchange",e._resizeFun=$.proxy(e.resize,e)),e},offResize:function(){"use strict";var e=this;return e._resizeFun&&($(window).off("resize orientationchange",e._resizeFun)||(e._resizeFun=null)),e},onImgLoading:function(){"use strict";return this.imgs.on("load",$.proxy(this._handleImgLoad,this)).on("error",$.proxy(this._handleImgError,this)),this},offImgLoading:function(){"use strict";return this.imgs.off(),this},_handleImgError:function(e){"use strict";$(e.currentTarget).attr("src","/widget/photodetailslider/images/no_img.png")},_handleImgLoad:function(e){"use strict";var i=$(e.target);i.parent().removeClass("loading")}}});